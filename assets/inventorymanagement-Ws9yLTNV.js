import{r as n,j as e,T as p,z as N}from"./main-IxGEKZMA.js";import{C as z}from"./Close-DoqWsXz3.js";import{g as W}from"./engineering-BuN6Pdrr.js";import{g as K}from"./inventory-TCBUaCbN.js";import{p as X,q as Y,r as Z,s as ee}from"./construction-Ca90qLEO.js";import{g as re}from"./procurement-DNGl8bgG.js";import{G as l}from"./Grid-C72N-tAO.js";import{t as _,T as E,h as w,i as h,j as s,k as T,I as u,D as te,f as se,g as le,e as M}from"./TableRow-CRAT5KT_.js";import{A as ae}from"./AddCircle-DWIRGPUh.js";import{T as ne}from"./TableContainer-BaU58JEj.js";import{E as ie}from"./Edit-g2hjeeYC.js";import{D as oe}from"./Delete-cHl_EB0l.js";import{D as ce}from"./DialogActions-D5wP0Mt-.js";import"./Transition-C29ZPDdz.js";const Ne=()=>{const[de,y]=n.useState(null),[f,L]=n.useState(""),[g,P]=n.useState(""),[U,m]=n.useState(!1),[v,I]=n.useState(""),[q,xe]=n.useState([]),[F,R]=n.useState([]),[D,k]=n.useState([]),[A,O]=n.useState([]),[B,C]=n.useState([]),[j,b]=n.useState(null),[i,c]=n.useState({materialID:"",materialName:"",quantityUsed:"",reorderLevel:"",supplierID:"",deliveryDate:""});n.useEffect(()=>{(async()=>{try{const t=await W();R(t)}catch(t){console.error("❌ Error fetching projects:",t)}})()},[]),n.useEffect(()=>{(async()=>{try{const t=await K();k(t)}catch(t){console.error("❌ Error loading inventory items:",t)}})()},[]),n.useEffect(()=>{(async()=>{try{const t=await re();O(t)}catch(t){console.error("❌ Error fetching vendors:",t)}})()},[]);const S=async()=>{try{const r=await X();C(r)}catch(r){console.error("❌ Error loading inventory:",r)}};n.useEffect(()=>{S()},[]);const V=r=>{const t=r.target.value,a=D.find(o=>o.item_id===t);a&&c(o=>({...o,materialID:a.item_id,materialName:a.item_name}))},Q=(r,t=null)=>{I(r),y(t),c(t!==null?q[t]:{}),m(!0)},d=()=>{m(!1),y(null),c({})},x=r=>{const{name:t,value:a}=r.target;c(o=>({...o,[t]:a}))},H=async()=>{var r;try{const t={material:i.materialID,project:v,material_name:i.materialName,quantity_used:i.quantityUsed,reorder_level:i.reorderLevel,supplier:i.supplierID,delivery_date:i.deliveryDate};let a;j?(a=await Z(j,t),alert("✏️ Updated successfully!")):(a=await ee(t),alert("✅ Material inventory created!")),d(),c({materialID:"",materialName:"",quantityUsed:"",reorderLevel:"",supplierID:"",deliveryDate:""}),b(null),S()}catch(t){const a=(r=t.response)!=null&&r.data?JSON.stringify(t.response.data,null,2):t.message;alert(`❌ Failed to save:
${a}`)}},J=async r=>{var t;if(window.confirm("Are you sure you want to delete this record?"))try{await Y(r),alert("🗑️ Record deleted successfully!"),C(a=>a.filter(o=>o.id!==r))}catch(a){const o=(t=a.response)!=null&&t.data?JSON.stringify(a.response.data,null,2):a.message;alert(`❌ Failed to delete:
${o}`)}},G=r=>{I(r.project),c({materialID:r.material,materialName:r.material_name,quantityUsed:r.quantity_used,reorderLevel:r.reorder_level,supplierID:r.supplier,deliveryDate:r.delivery_date}),b(r.id),m(!0)},$=B.filter(r=>Object.values(r).some(t=>t&&t.toString().toLowerCase().includes(g.toLowerCase())));return e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"h5",gutterBottom:!0,sx:{mt:5},children:"Material & InventoryManagement"}),e.jsx(l,{container:!0,spacing:2,direction:"column",sx:{mb:2},children:e.jsx(l,{item:!0,xs:12,children:e.jsxs(_,{sx:{p:2,backgroundColor:"#fff",border:"1px solid #ccc"},children:[e.jsx(p,{variant:"h6",gutterBottom:!0,children:"PROJECT RECORDS"}),e.jsx(N,{sx:{my:2,mx:1},children:e.jsx("input",{type:"text",placeholder:"Search Project ID",value:f,onChange:r=>L(r.target.value),className:"input",style:{width:"100%",padding:"8px",border:"1px solid #ccc",borderRadius:4}})}),e.jsxs(E,{children:[e.jsx(w,{children:e.jsxs(h,{children:[e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project ID"})}),e.jsx(s,{sx:{display:"flex",justifyContent:"flex-end",color:"#660000"},children:e.jsx("strong",{children:"Action"})})]})}),e.jsx(T,{children:F.filter(r=>{var t;return(t=r.project_id)==null?void 0:t.toLowerCase().includes(f.toLowerCase())}).map((r,t)=>e.jsxs(h,{children:[e.jsx(s,{children:r.project_id}),e.jsx(s,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(u,{onClick:()=>Q(r.project_id),color:"primary",children:e.jsx(ae,{sx:{color:"#7267ef"}})})})]},t))})]})]})})}),e.jsx(l,{container:!0,spacing:2,children:e.jsx(l,{item:!0,xs:12,children:e.jsxs(_,{sx:{p:2,backgroundColor:"#fff",border:"1px solid #ccc"},children:[e.jsx(p,{variant:"h6",gutterBottom:!0,children:"SUBMITTED MATERIALS & INVENTORIES"}),e.jsx("input",{type:"text",placeholder:"Search Projects",value:g,onChange:r=>P(r.target.value),className:"input"}),e.jsx(ne,{sx:{maxHeight:400,overflow:"auto",border:"1px solid #ddd"},children:e.jsxs(E,{stickyHeader:!0,children:[e.jsx(w,{children:e.jsxs(h,{children:[e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project ID"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Material ID"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Material Name"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Quantity Used"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Reorder Level"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Supplier ID"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Dalivery Date"})}),e.jsx(s,{sx:{color:"#660000"},children:e.jsx("strong",{children:"Actions"})})]})}),e.jsx(T,{children:$.map((r,t)=>e.jsxs(h,{children:[e.jsx(s,{children:r.project}),e.jsx(s,{children:r.material}),e.jsx(s,{children:r.material_name}),e.jsx(s,{children:r.quantity_used}),e.jsx(s,{children:r.reorder_level}),e.jsx(s,{children:r.supplier}),e.jsx(s,{children:r.delivery_date}),e.jsxs(s,{children:[e.jsx(u,{color:"warning",onClick:()=>G(r),children:e.jsx(ie,{sx:{color:"orange"}})}),e.jsx(u,{color:"error",onClick:()=>J(r.id),children:e.jsx(oe,{sx:{color:"red"}})})]})]},r.id))})]})})]})})}),e.jsxs(te,{open:U,onClose:d,fullWidth:!0,children:[e.jsx(se,{children:"Enter Project Details"}),e.jsxs(le,{sx:{position:"relative"},children:[e.jsx(u,{"aria-label":"close",onClick:d,sx:{position:"absolute",right:8,top:8,color:r=>r.palette.grey[500]},children:e.jsx(z,{})}),e.jsx(N,{component:"form",sx:{mt:2},children:e.jsxs(l,{container:!0,spacing:3,direction:"column",children:[e.jsxs(l,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Project ID "}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsx(l,{container:!0,spacing:2,children:e.jsxs(l,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"projectId",children:"Project ID"}),e.jsx("input",{id:"projectId",className:"input",value:v,disabled:!0})]})})]}),e.jsxs(l,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Material Information"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(l,{container:!0,spacing:2,children:[e.jsxs(l,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"materialID",children:"Material ID"}),e.jsxs("select",{id:"materialID",name:"materialID",className:"input",value:i.materialID||"",onChange:V,children:[e.jsx("option",{value:"",children:"-- Select Material ID --"}),D.map(r=>e.jsx("option",{value:r.item_id,children:r.item_id},r.id))]})]}),e.jsxs(l,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"materialName",children:"Material Name"}),e.jsx("input",{id:"materialName",name:"materialName",className:"input",value:i.materialName||"",onChange:x,disabled:!0})]}),e.jsxs(l,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"quantityUsed",children:"Quantity Used"}),e.jsx("input",{id:"quantityUsed",name:"quantityUsed",className:"input",value:i.quantityUsed||"",onChange:x})]})]})]}),e.jsxs(l,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Order Information"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(l,{container:!0,spacing:2,children:[e.jsxs(l,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"reorderLevel",children:"Reorder Level"}),e.jsx("input",{id:"reorderLevel",name:"reorderLevel",className:"input",value:i.reorderLevel||"",onChange:x})]}),e.jsxs(l,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"supplierID",children:"Supplier"}),e.jsxs("select",{id:"supplierID",name:"supplierID",className:"input",value:i.supplierID||"",onChange:r=>c(t=>({...t,supplierID:r.target.value})),children:[e.jsx("option",{value:"",children:"-- Select Supplier --"}),A.map(r=>e.jsxs("option",{value:r.vendor_id,children:[r.vendor_id," - ",r.vendor_name]},r.id))]})]}),e.jsxs(l,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"deliveryDate",children:"Delivery Date"}),e.jsx("input",{type:"date",id:"deliveryDate",name:"deliveryDate",className:"input",value:i.deliveryDate||"",onChange:x})]})]})]})]})})]}),e.jsxs(ce,{children:[e.jsx(M,{onClick:d,sx:{outline:"2px solid #800000",color:"#800000","&:hover":{outline:"2px solid #b30000",color:"#b30000"}},children:"Cancel"}),e.jsx(M,{variant:"outlined",onClick:H,sx:{borderColor:"#7267ef",color:"#7267ef","&:hover":{borderColor:"#9e8df2",color:"#9e8df2"}},children:j?"Update":"Submit"})]})]})]})};export{Ne as default};
