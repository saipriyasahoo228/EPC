import{r as a,j as e,L as $o,O as Ao,Q as Ro,U as Oo,V as St,W as So,X as Lo,Y as Do,k as $t,i as At,m as jt,o as me,n as it,q as He,t as Rt,v as Ue,w as zo,H as Wt,Z as jo,_ as To,z as ke,x as V,T as m,S as yt,J as Lt}from"./main-BIxdd69i.js";import{g as Eo}from"./engineering-4VzvUWDc.js";import{m as No,j as to,g as Fo,l as qo}from"./construction-TCh-rxln.js";import{g as Bo}from"./inventory-Bcy74QM6.js";import{a as oo,f as Wo}from"./procurement-Dxzq-DH5.js";import{u as Vo}from"./index-BDsS-tJo.js";import{R as Ho}from"./index-E3WhgaTq.js";import{u as Uo,P as Bt,l as Go,b as Dt,s as Ko,c as gt,I as Co,e as Ie,D as zt,f as Tt,g as Et,h as Nt}from"./DialogTitle-D59uELMl.js";import{T as Qo}from"./Toolbar-CZiWvmFk.js";import{C as Ve,D as Pt}from"./Divider-B5eNhVMt.js";import{S as A,C as ro,a as so,F as no}from"./Stack-Dyw0hk3Q.js";import{T as ne}from"./TextField-BZ4knvb7.js";import{M as Yo}from"./MenuItem-BSRQ3XbJ.js";import{L as _o}from"./LinearProgress-BeP33HTl.js";import{u as Vt,A as Jo,f as vt,c as ht,o as io,d as Ht}from"./Select-CcRDAcIa.js";import{C as Xo,A as ao,S as Zo}from"./Snackbar-D6Cxzpo8.js";import{u as er}from"./usePreviousProps-Cxex8iTN.js";import{P as wo,T as tr}from"./Tooltip-3Br47uNT.js";import{G as ie}from"./Grid-BnZNKmae.js";import"./dividerClasses-BHbp2fTT.js";const Io=a.createContext(null);function Xt(){return a.useContext(Io)}const or=typeof Symbol=="function"&&Symbol.for,rr=or?Symbol.for("mui.nested"):"__THEME_NESTED__";function sr(t,r){return typeof r=="function"?r(t):{...t,...r}}function nr(t){const{children:r,theme:l}=t,c=Xt(),b=a.useMemo(()=>{const u=c===null?{...l}:sr(c,l);return u!=null&&(u[rr]=c!==null),u},[l,c]);return e.jsx(Io.Provider,{value:b,children:r})}const lo={};function co(t,r,l,c=!1){return a.useMemo(()=>{const b=t&&r[t]||r;if(typeof l=="function"){const u=l(b),f=t?{...r,[t]:u}:u;return c?()=>f:f}return t?{...r,[t]:l}:{...r,...l}},[t,r,l,c])}function ko(t){const{children:r,theme:l,themeId:c}=t,b=$o(lo),u=Xt()||lo,f=co(c,b,l),y=co(c,u,l,!0),$=(c?f[c]:f).direction==="rtl";return e.jsx(nr,{theme:y,children:e.jsx(Ao.Provider,{value:f,children:e.jsx(Ho,{value:$,children:e.jsx(Ro,{value:c?f[c].components:f.components,children:r})})})})}const Zt="mode",eo="color-scheme",ir="data-color-scheme";function ar(t){const{defaultMode:r="system",defaultLightColorScheme:l="light",defaultDarkColorScheme:c="dark",modeStorageKey:b=Zt,colorSchemeStorageKey:u=eo,attribute:f=ir,colorSchemeNode:y="document.documentElement",nonce:$}=t||{};let I="",C=f;if(f==="class"&&(C=".%s"),f==="data"&&(C="[data-%s]"),C.startsWith(".")){const d=C.substring(1);I+=`${y}.classList.remove('${d}'.replace('%s', light), '${d}'.replace('%s', dark));
      ${y}.classList.add('${d}'.replace('%s', colorScheme));`}const R=C.match(/\[([^\]]+)\]/);if(R){const[d,j]=R[1].split("=");j||(I+=`${y}.removeAttribute('${d}'.replace('%s', light));
      ${y}.removeAttribute('${d}'.replace('%s', dark));`),I+=`
      ${y}.setAttribute('${d}'.replace('%s', colorScheme), ${j?`${j}.replace('%s', colorScheme)`:'""'});`}else I+=`${y}.setAttribute('${C}', colorScheme);`;return e.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?$:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  let colorScheme = '';
  const mode = localStorage.getItem('${b}') || '${r}';
  const dark = localStorage.getItem('${u}-dark') || '${c}';
  const light = localStorage.getItem('${u}-light') || '${l}';
  if (mode === 'system') {
    // handle system mode
    const mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = dark
    } else {
      colorScheme = light
    }
  }
  if (mode === 'light') {
    colorScheme = light;
  }
  if (mode === 'dark') {
    colorScheme = dark;
  }
  if (colorScheme) {
    ${I}
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function lr(){}const cr=({key:t,storageWindow:r})=>(!r&&typeof window<"u"&&(r=window),{get(l){if(typeof window>"u")return;if(!r)return l;let c;try{c=r.localStorage.getItem(t)}catch{}return c||l},set:l=>{if(r)try{r.localStorage.setItem(t,l)}catch{}},subscribe:l=>{if(!r)return lr;const c=b=>{const u=b.newValue;b.key===t&&l(u)};return r.addEventListener("storage",c),()=>{r.removeEventListener("storage",c)}}});function Ut(){}function uo(t){if(typeof window<"u"&&typeof window.matchMedia=="function"&&t==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Mo(t,r){if(t.mode==="light"||t.mode==="system"&&t.systemMode==="light")return r("light");if(t.mode==="dark"||t.mode==="system"&&t.systemMode==="dark")return r("dark")}function dr(t){return Mo(t,r=>{if(r==="light")return t.lightColorScheme;if(r==="dark")return t.darkColorScheme})}function ur(t){const{defaultMode:r="light",defaultLightColorScheme:l,defaultDarkColorScheme:c,supportedColorSchemes:b=[],modeStorageKey:u=Zt,colorSchemeStorageKey:f=eo,storageWindow:y=typeof window>"u"?void 0:window,storageManager:$=cr,noSsr:I=!1}=t,C=b.join(","),R=b.length>1,d=a.useMemo(()=>$==null?void 0:$({key:u,storageWindow:y}),[$,u,y]),j=a.useMemo(()=>$==null?void 0:$({key:`${f}-light`,storageWindow:y}),[$,f,y]),S=a.useMemo(()=>$==null?void 0:$({key:`${f}-dark`,storageWindow:y}),[$,f,y]),[Q,ae]=a.useState(()=>{const z=(d==null?void 0:d.get(r))||r,O=(j==null?void 0:j.get(l))||l,T=(S==null?void 0:S.get(c))||c;return{mode:z,systemMode:uo(z),lightColorScheme:O,darkColorScheme:T}}),[X,pe]=a.useState(I||!R);a.useEffect(()=>{pe(!0)},[]);const ee=dr(Q),ve=a.useCallback(z=>{ae(O=>{if(z===O.mode)return O;const T=z??r;return d==null||d.set(T),{...O,mode:T,systemMode:uo(T)}})},[d,r]),Se=a.useCallback(z=>{z?typeof z=="string"?z&&!C.includes(z)?console.error(`\`${z}\` does not exist in \`theme.colorSchemes\`.`):ae(O=>{const T={...O};return Mo(O,F=>{F==="light"&&(j==null||j.set(z),T.lightColorScheme=z),F==="dark"&&(S==null||S.set(z),T.darkColorScheme=z)}),T}):ae(O=>{const T={...O},F=z.light===null?l:z.light,k=z.dark===null?c:z.dark;return F&&(C.includes(F)?(T.lightColorScheme=F,j==null||j.set(F)):console.error(`\`${F}\` does not exist in \`theme.colorSchemes\`.`)),k&&(C.includes(k)?(T.darkColorScheme=k,S==null||S.set(k)):console.error(`\`${k}\` does not exist in \`theme.colorSchemes\`.`)),T}):ae(O=>(j==null||j.set(l),S==null||S.set(c),{...O,lightColorScheme:l,darkColorScheme:c}))},[C,j,S,l,c]),ce=a.useCallback(z=>{Q.mode==="system"&&ae(O=>{const T=z!=null&&z.matches?"dark":"light";return O.systemMode===T?O:{...O,systemMode:T}})},[Q.mode]),q=a.useRef(ce);return q.current=ce,a.useEffect(()=>{if(typeof window.matchMedia!="function"||!R)return;const z=(...T)=>q.current(...T),O=window.matchMedia("(prefers-color-scheme: dark)");return O.addListener(z),z(O),()=>{O.removeListener(z)}},[R]),a.useEffect(()=>{if(R){const z=(d==null?void 0:d.subscribe(F=>{(!F||["light","dark","system"].includes(F))&&ve(F||r)}))||Ut,O=(j==null?void 0:j.subscribe(F=>{(!F||C.match(F))&&Se({light:F})}))||Ut,T=(S==null?void 0:S.subscribe(F=>{(!F||C.match(F))&&Se({dark:F})}))||Ut;return()=>{z(),O(),T()}}},[Se,ve,C,r,y,R,d,j,S]),{...Q,mode:X?Q.mode:void 0,systemMode:X?Q.systemMode:void 0,colorScheme:X?ee:void 0,setMode:ve,setColorScheme:Se}}const pr="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function mr(t){const{themeId:r,theme:l={},modeStorageKey:c=Zt,colorSchemeStorageKey:b=eo,disableTransitionOnChange:u=!1,defaultColorScheme:f,resolveTheme:y}=t,$={allColorSchemes:[],colorScheme:void 0,darkColorScheme:void 0,lightColorScheme:void 0,mode:void 0,setColorScheme:()=>{},setMode:()=>{},systemMode:void 0},I=a.createContext(void 0),C=()=>a.useContext(I)||$,R={},d={};function j(X){var We,ot,Oe,ze;const{children:pe,theme:ee,modeStorageKey:ve=c,colorSchemeStorageKey:Se=b,disableTransitionOnChange:ce=u,storageManager:q,storageWindow:z=typeof window>"u"?void 0:window,documentNode:O=typeof document>"u"?void 0:document,colorSchemeNode:T=typeof document>"u"?void 0:document.documentElement,disableNestedContext:F=!1,disableStyleSheetGeneration:k=!1,defaultMode:Ge="system",forceThemeRerender:at=!1,noSsr:Ke}=X,Ce=a.useRef(!1),De=Xt(),P=a.useContext(I),Qe=!!P&&!F,lt=a.useMemo(()=>ee||(typeof l=="function"?l():l),[ee]),ge=lt[r],B=ge||lt,{colorSchemes:_e=R,components:Fe=d,cssVarPrefix:te}=B,Z=Object.keys(_e).filter(N=>!!_e[N]).join(","),fe=a.useMemo(()=>Z.split(","),[Z]),qe=typeof f=="string"?f:f.light,Y=typeof f=="string"?f:f.dark,xe=_e[qe]&&_e[Y]?Ge:((ot=(We=_e[B.defaultColorScheme])==null?void 0:We.palette)==null?void 0:ot.mode)||((Oe=B.palette)==null?void 0:Oe.mode),{mode:Be,setMode:de,systemMode:ue,lightColorScheme:oe,darkColorScheme:Re,colorScheme:re,setColorScheme:Ye}=ur({supportedColorSchemes:fe,defaultLightColorScheme:qe,defaultDarkColorScheme:Y,modeStorageKey:ve,colorSchemeStorageKey:Se,defaultMode:xe,storageManager:q,storageWindow:z,noSsr:Ke});let v=Be,se=re;Qe&&(v=P.mode,se=P.colorScheme);let L=se||B.defaultColorScheme;B.vars&&!at&&(L=B.defaultColorScheme);const be=a.useMemo(()=>{var H;const N=((H=B.generateThemeVars)==null?void 0:H.call(B))||B.vars,M={...B,components:Fe,colorSchemes:_e,cssVarPrefix:te,vars:N};if(typeof M.generateSpacing=="function"&&(M.spacing=M.generateSpacing()),L){const U=_e[L];U&&typeof U=="object"&&Object.keys(U).forEach(G=>{U[G]&&typeof U[G]=="object"?M[G]={...M[G],...U[G]}:M[G]=U[G]})}return y?y(M):M},[B,L,Fe,_e,te]),je=B.colorSchemeSelector;Uo(()=>{if(se&&T&&je&&je!=="media"){const N=je;let M=je;if(N==="class"&&(M=".%s"),N==="data"&&(M="[data-%s]"),N!=null&&N.startsWith("data-")&&!N.includes("%s")&&(M=`[${N}="%s"]`),M.startsWith("."))T.classList.remove(...fe.map(H=>M.substring(1).replace("%s",H))),T.classList.add(M.substring(1).replace("%s",se));else{const H=M.replace("%s",se).match(/\[([^\]]+)\]/);if(H){const[U,G]=H[1].split("=");G||fe.forEach(rt=>{T.removeAttribute(U.replace(se,rt))}),T.setAttribute(U,G?G.replace(/"|'/g,""):"")}else T.setAttribute(M,se)}}},[se,je,T,fe]),a.useEffect(()=>{let N;if(ce&&Ce.current&&O){const M=O.createElement("style");M.appendChild(O.createTextNode(pr)),O.head.appendChild(M),window.getComputedStyle(O.body),N=setTimeout(()=>{O.head.removeChild(M)},1)}return()=>{clearTimeout(N)}},[se,ce,O]),a.useEffect(()=>(Ce.current=!0,()=>{Ce.current=!1}),[]);const Je=a.useMemo(()=>({allColorSchemes:fe,colorScheme:se,darkColorScheme:Re,lightColorScheme:oe,mode:v,setColorScheme:Ye,setMode:de,systemMode:ue}),[fe,se,Re,oe,v,Ye,de,ue,be.colorSchemeSelector]);let we=!0;(k||B.cssVariables===!1||Qe&&(De==null?void 0:De.cssVarPrefix)===te)&&(we=!1);const ye=e.jsxs(a.Fragment,{children:[e.jsx(ko,{themeId:ge?r:void 0,theme:be,children:pe}),we&&e.jsx(Oo,{styles:((ze=be.generateStyleSheets)==null?void 0:ze.call(be))||[]})]});return Qe?ye:e.jsx(I.Provider,{value:Je,children:ye})}const S=typeof f=="string"?f:f.light,Q=typeof f=="string"?f:f.dark;return{CssVarsProvider:j,useColorScheme:C,getInitColorSchemeScript:X=>ar({colorSchemeStorageKey:b,defaultLightColorScheme:S,defaultDarkColorScheme:Q,modeStorageKey:c,...X})}}function Gt({theme:t,...r}){const l=St in t?t[St]:void 0;return e.jsx(ko,{...r,themeId:l?St:void 0,theme:l||t})}const Ft={colorSchemeStorageKey:"mui-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"mui-mode"},{CssVarsProvider:hr}=mr({themeId:St,theme:()=>So({cssVariables:!0}),colorSchemeStorageKey:Ft.colorSchemeStorageKey,modeStorageKey:Ft.modeStorageKey,defaultColorScheme:{light:Ft.defaultLightColorScheme,dark:Ft.defaultDarkColorScheme},resolveTheme:t=>{const r={...t,typography:Lo(t.palette,t.typography)};return r.unstable_sx=function(c){return Do({sx:c,theme:this})},r}}),gr=hr;function fr({theme:t,...r}){if(typeof t=="function")return e.jsx(Gt,{theme:t,...r});const l=St in t?t[St]:t;return"colorSchemes"in l?e.jsx(gr,{theme:t,...r}):"vars"in l?e.jsx(Gt,{theme:t,...r}):e.jsx(Gt,{theme:{...t,vars:null},...r})}function xr(t){return $t("MuiAppBar",t)}At("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const br=t=>{const{color:r,position:l,classes:c}=t,b={root:["root",`color${He(r)}`,`position${He(l)}`]};return Rt(b,xr,c)},po=(t,r)=>t?`${t==null?void 0:t.replace(")","")}, ${r})`:r,yr=me(Bt,{name:"MuiAppBar",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:l}=t;return[r.root,r[`position${He(l.position)}`],r[`color${He(l.color)}`]]}})(Ue(({theme:t})=>({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0,variants:[{props:{position:"fixed"},style:{position:"fixed",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}}},{props:{position:"absolute"},style:{position:"absolute",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"sticky"},style:{position:"sticky",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"static"},style:{position:"static"}},{props:{position:"relative"},style:{position:"relative"}},{props:{color:"inherit"},style:{"--AppBar-color":"inherit"}},{props:{color:"default"},style:{"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[100],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[100]),...t.applyStyles("dark",{"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[900],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[900])})}},...Object.entries(t.palette).filter(zo(["contrastText"])).map(([r])=>({props:{color:r},style:{"--AppBar-background":(t.vars??t).palette[r].main,"--AppBar-color":(t.vars??t).palette[r].contrastText}})),{props:r=>r.enableColorOnDark===!0&&!["inherit","transparent"].includes(r.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)"}},{props:r=>r.enableColorOnDark===!1&&!["inherit","transparent"].includes(r.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...t.applyStyles("dark",{backgroundColor:t.vars?po(t.vars.palette.AppBar.darkBg,"var(--AppBar-background)"):null,color:t.vars?po(t.vars.palette.AppBar.darkColor,"var(--AppBar-color)"):null})}},{props:{color:"transparent"},style:{"--AppBar-background":"transparent","--AppBar-color":"inherit",backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...t.applyStyles("dark",{backgroundImage:"none"})}}]}))),vr=a.forwardRef(function(r,l){const c=jt({props:r,name:"MuiAppBar"}),{className:b,color:u="primary",enableColorOnDark:f=!1,position:y="fixed",...$}=c,I={...c,color:u,position:y,enableColorOnDark:f},C=br(I);return e.jsx(yr,{square:!0,component:"header",ownerState:I,elevation:4,className:it(C.root,b,y==="fixed"&&"mui-fixed"),ref:l,...$})});function mo(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function Sr(t={}){const{ignoreAccents:r=!0,ignoreCase:l=!0,limit:c,matchFrom:b="any",stringify:u,trim:f=!1}=t;return(y,{inputValue:$,getOptionLabel:I})=>{let C=f?$.trim():$;l&&(C=C.toLowerCase()),r&&(C=mo(C));const R=C?y.filter(d=>{let j=(u||I)(d);return l&&(j=j.toLowerCase()),r&&(j=mo(j)),b==="start"?j.startsWith(C):j.includes(C)}):y;return typeof c=="number"?R.slice(0,c):R}}const jr=Sr(),Cr=5,_r=t=>{var r;return t.current!==null&&((r=t.current.parentElement)==null?void 0:r.contains(document.activeElement))},wr=[];function ho(t,r,l,c){if(r||t==null||c)return"";const b=l(t);return typeof b=="string"?b:""}function Ir(t){const{unstable_isActiveElementInListbox:r=_r,unstable_classNamePrefix:l="Mui",autoComplete:c=!1,autoHighlight:b=!1,autoSelect:u=!1,blurOnSelect:f=!1,clearOnBlur:y=!t.freeSolo,clearOnEscape:$=!1,componentName:I="useAutocomplete",defaultValue:C=t.multiple?wr:null,disableClearable:R=!1,disableCloseOnSelect:d=!1,disabled:j,disabledItemsFocusable:S=!1,disableListWrap:Q=!1,filterOptions:ae=jr,filterSelectedOptions:X=!1,freeSolo:pe=!1,getOptionDisabled:ee,getOptionKey:ve,getOptionLabel:Se=i=>i.label??i,groupBy:ce,handleHomeEndKeys:q=!t.freeSolo,id:z,includeInputInList:O=!1,inputValue:T,isOptionEqualToValue:F=(i,n)=>i===n,multiple:k=!1,onChange:Ge,onClose:at,onHighlightChange:Ke,onInputChange:Ce,onOpen:De,open:P,openOnFocus:Qe=!1,options:lt,readOnly:ge=!1,renderValue:B,selectOnFocus:_e=!t.freeSolo,value:Fe}=t,te=Go(z);let Z=Se;Z=i=>{const n=Se(i);return typeof n!="string"?String(n):n};const fe=a.useRef(!1),qe=a.useRef(!0),Y=a.useRef(null),xe=a.useRef(null),[Be,de]=a.useState(null),[ue,oe]=a.useState(-1),Re=b?0:-1,re=a.useRef(Re),Ye=a.useRef(ho(C??Fe,k,Z)).current,[v,se]=Vt({controlled:Fe,default:C,name:I}),[L,be]=Vt({controlled:T,default:Ye,name:I,state:"inputValue"}),[je,Je]=a.useState(!1),we=a.useCallback((i,n,g)=>{if(!(k?v.length<n.length:n!==null)&&!y)return;const x=ho(n,k,Z,B);L!==x&&(be(x),Ce&&Ce(i,x,g))},[Z,L,k,Ce,be,y,v,B]),[ye,We]=Vt({controlled:P,default:!1,name:I,state:"open"}),[ot,Oe]=a.useState(!0),ze=!k&&v!=null&&L===Z(v),N=ye&&!ge,M=N?ae(lt.filter(i=>!(X&&(k?v:[v]).some(n=>n!==null&&F(i,n)))),{inputValue:ze&&ot?"":L,getOptionLabel:Z}):[],H=er({filteredOptions:M,value:v,inputValue:L});a.useEffect(()=>{const i=v!==H.value;je&&!i||pe&&!i||we(null,v,"reset")},[v,we,je,H.value,pe]);const U=ye&&M.length>0&&!ge,G=Dt(i=>{if(i===-1)Y.current.focus();else{const n=B?"data-item-index":"data-tag-index";Be.querySelector(`[${n}="${i}"]`).focus()}});a.useEffect(()=>{k&&ue>v.length-1&&(oe(-1),G(-1))},[v,k,ue,G]);function rt(i,n){if(!xe.current||i<0||i>=M.length)return-1;let g=i;for(;;){const w=xe.current.querySelector(`[data-option-index="${g}"]`),x=S?!1:!w||w.disabled||w.getAttribute("aria-disabled")==="true";if(w&&w.hasAttribute("tabindex")&&!x)return g;if(n==="next"?g=(g+1)%M.length:g=(g-1+M.length)%M.length,g===i)return-1}}const Te=Dt(({event:i,index:n,reason:g})=>{if(re.current=n,n===-1?Y.current.removeAttribute("aria-activedescendant"):Y.current.setAttribute("aria-activedescendant",`${te}-option-${n}`),Ke&&["mouse","keyboard","touch"].includes(g)&&Ke(i,n===-1?null:M[n],g),!xe.current)return;const w=xe.current.querySelector(`[role="option"].${l}-focused`);w&&(w.classList.remove(`${l}-focused`),w.classList.remove(`${l}-focusVisible`));let x=xe.current;if(xe.current.getAttribute("role")!=="listbox"&&(x=xe.current.parentElement.querySelector('[role="listbox"]')),!x)return;if(n===-1){x.scrollTop=0;return}const K=xe.current.querySelector(`[data-option-index="${n}"]`);if(K&&(K.classList.add(`${l}-focused`),g==="keyboard"&&K.classList.add(`${l}-focusVisible`),x.scrollHeight>x.clientHeight&&g!=="mouse"&&g!=="touch")){const J=K,$e=x.clientHeight+x.scrollTop,bt=J.offsetTop+J.offsetHeight;bt>$e?x.scrollTop=bt-x.clientHeight:J.offsetTop-J.offsetHeight*(ce?1.3:0)<x.scrollTop&&(x.scrollTop=J.offsetTop-J.offsetHeight*(ce?1.3:0))}}),Me=Dt(({event:i,diff:n,direction:g="next",reason:w})=>{if(!N)return;const K=rt((()=>{const J=M.length-1;if(n==="reset")return Re;if(n==="start")return 0;if(n==="end")return J;const $e=re.current+n;return $e<0?$e===-1&&O?-1:Q&&re.current!==-1||Math.abs(n)>1?0:J:$e>J?$e===J+1&&O?-1:Q||Math.abs(n)>1?J:0:$e})(),g);if(Te({index:K,reason:w,event:i}),c&&n!=="reset")if(K===-1)Y.current.value=L;else{const J=Z(M[K]);Y.current.value=J,J.toLowerCase().indexOf(L.toLowerCase())===0&&L.length>0&&Y.current.setSelectionRange(L.length,J.length)}}),Ct=()=>{const i=(n,g)=>{const w=n?Z(n):"",x=g?Z(g):"";return w===x};if(re.current!==-1&&H.filteredOptions&&H.filteredOptions.length!==M.length&&H.inputValue===L&&(k?v.length===H.value.length&&H.value.every((n,g)=>Z(v[g])===Z(n)):i(H.value,v))){const n=H.filteredOptions[re.current];if(n)return M.findIndex(g=>Z(g)===Z(n))}return-1},ct=a.useCallback(()=>{if(!N)return;const i=Ct();if(i!==-1){re.current=i;return}const n=k?v[0]:v;if(M.length===0||n==null){Me({diff:"reset"});return}if(xe.current){if(n!=null){const g=M[re.current];if(k&&g&&v.findIndex(x=>F(g,x))!==-1)return;const w=M.findIndex(x=>F(x,n));w===-1?Me({diff:"reset"}):Te({index:w});return}if(re.current>=M.length-1){Te({index:M.length-1});return}Te({index:re.current})}},[M.length,k?!1:v,X,Me,Te,N,L,k]),_t=Dt(i=>{Ko(xe,i),i&&ct()});a.useEffect(()=>{ct()},[ct]);const he=i=>{ye||(We(!0),Oe(!0),De&&De(i))},Xe=(i,n)=>{ye&&(We(!1),at&&at(i,n))},Ee=(i,n,g,w)=>{if(k){if(v.length===n.length&&v.every((x,K)=>x===n[K]))return}else if(v===n)return;Ge&&Ge(i,n,g,w),se(n)},Ze=a.useRef(!1),Le=(i,n,g="selectOption",w="options")=>{let x=g,K=n;if(k){K=Array.isArray(v)?v.slice():[];const J=K.findIndex($e=>F(n,$e));J===-1?K.push(n):w!=="freeSolo"&&(K.splice(J,1),x="removeOption")}we(i,K,x),Ee(i,K,x,{option:n}),!d&&(!i||!i.ctrlKey&&!i.metaKey)&&Xe(i,x),(f===!0||f==="touch"&&Ze.current||f==="mouse"&&!Ze.current)&&Y.current.blur()};function dt(i,n){if(i===-1)return-1;let g=i;for(;;){if(n==="next"&&g===v.length||n==="previous"&&g===-1)return-1;const w=B?"data-item-index":"data-tag-index",x=Be.querySelector(`[${w}="${g}"]`);if(!x||!x.hasAttribute("tabindex")||x.disabled||x.getAttribute("aria-disabled")==="true")g+=n==="next"?1:-1;else return g}}const ft=(i,n)=>{if(!k)return;L===""&&Xe(i,"toggleInput");let g=ue;ue===-1?L===""&&n==="previous"&&(g=v.length-1):(g+=n==="next"?1:-1,g<0&&(g=0),g===v.length&&(g=-1)),g=dt(g,n),oe(g),G(g)},Ne=i=>{fe.current=!0,be(""),Ce&&Ce(i,"","clear"),Ee(i,k?[]:null,"clear")},wt=i=>n=>{if(i.onKeyDown&&i.onKeyDown(n),!n.defaultMuiPrevented&&(ue!==-1&&!["ArrowLeft","ArrowRight"].includes(n.key)&&(oe(-1),G(-1)),n.which!==229))switch(n.key){case"Home":N&&q&&(n.preventDefault(),Me({diff:"start",direction:"next",reason:"keyboard",event:n}));break;case"End":N&&q&&(n.preventDefault(),Me({diff:"end",direction:"previous",reason:"keyboard",event:n}));break;case"PageUp":n.preventDefault(),Me({diff:-5,direction:"previous",reason:"keyboard",event:n}),he(n);break;case"PageDown":n.preventDefault(),Me({diff:Cr,direction:"next",reason:"keyboard",event:n}),he(n);break;case"ArrowDown":n.preventDefault(),Me({diff:1,direction:"next",reason:"keyboard",event:n}),he(n);break;case"ArrowUp":n.preventDefault(),Me({diff:-1,direction:"previous",reason:"keyboard",event:n}),he(n);break;case"ArrowLeft":!k&&B?G(0):ft(n,"previous");break;case"ArrowRight":!k&&B?G(-1):ft(n,"next");break;case"Enter":if(re.current!==-1&&N){const g=M[re.current],w=ee?ee(g):!1;if(n.preventDefault(),w)return;Le(n,g,"selectOption"),c&&Y.current.setSelectionRange(Y.current.value.length,Y.current.value.length)}else pe&&L!==""&&ze===!1&&(k&&n.preventDefault(),Le(n,L,"createOption","freeSolo"));break;case"Escape":N?(n.preventDefault(),n.stopPropagation(),Xe(n,"escape")):$&&(L!==""||k&&v.length>0||B)&&(n.preventDefault(),n.stopPropagation(),Ne(n));break;case"Backspace":if(k&&!ge&&L===""&&v.length>0){const g=ue===-1?v.length-1:ue,w=v.slice();w.splice(g,1),Ee(n,w,"removeOption",{option:v[g]})}!k&&B&&!ge&&(se(null),G(-1));break;case"Delete":if(k&&!ge&&L===""&&v.length>0&&ue!==-1){const g=ue,w=v.slice();w.splice(g,1),Ee(n,w,"removeOption",{option:v[g]})}!k&&B&&!ge&&(se(null),G(-1));break}},It=i=>{Je(!0),Qe&&!fe.current&&he(i)},et=i=>{if(r(xe)){Y.current.focus();return}Je(!1),qe.current=!0,fe.current=!1,u&&re.current!==-1&&N?Le(i,M[re.current],"blur"):u&&pe&&L!==""?Le(i,L,"blur","freeSolo"):y&&we(i,v,"blur"),Xe(i,"blur")},ut=i=>{const n=i.target.value;L!==n&&(be(n),Oe(!1),Ce&&Ce(i,n,"input")),n===""?!R&&!k&&Ee(i,null,"clear"):he(i)},pt=i=>{const n=Number(i.currentTarget.getAttribute("data-option-index"));re.current!==n&&Te({event:i,index:n,reason:"mouse"})},tt=i=>{Te({event:i,index:Number(i.currentTarget.getAttribute("data-option-index")),reason:"touch"}),Ze.current=!0},xt=i=>{const n=Number(i.currentTarget.getAttribute("data-option-index"));Le(i,M[n],"selectOption"),Ze.current=!1},o=i=>n=>{const g=v.slice();g.splice(i,1),Ee(n,g,"removeOption",{option:v[i]})},s=i=>{Ee(i,null,"removeOption",{option:v})},h=i=>{ye?Xe(i,"toggleInput"):he(i)},p=i=>{i.currentTarget.contains(i.target)&&i.target.getAttribute("id")!==te&&i.preventDefault()},_=i=>{i.currentTarget.contains(i.target)&&(Y.current.focus(),_e&&qe.current&&Y.current.selectionEnd-Y.current.selectionStart===0&&Y.current.select(),qe.current=!1)},le=i=>{!j&&(L===""||!ye)&&h(i)};let W=pe&&L.length>0;W=W||(k?v.length>0:v!==null);let Pe=M;return ce&&(Pe=M.reduce((i,n,g)=>{const w=ce(n);return i.length>0&&i[i.length-1].group===w?i[i.length-1].options.push(n):i.push({key:g,index:g,group:w,options:[n]}),i},[])),j&&je&&et(),{getRootProps:(i={})=>({...i,onKeyDown:wt(i),onMouseDown:p,onClick:_}),getInputLabelProps:()=>({id:`${te}-label`,htmlFor:te}),getInputProps:()=>({id:te,value:L,onBlur:et,onFocus:It,onChange:ut,onMouseDown:le,"aria-activedescendant":N?"":null,"aria-autocomplete":c?"both":"list","aria-controls":U?`${te}-listbox`:void 0,"aria-expanded":U,autoComplete:"off",ref:Y,autoCapitalize:"none",spellCheck:"false",role:"combobox",disabled:j}),getClearProps:()=>({tabIndex:-1,type:"button",onClick:Ne}),getItemProps:({index:i=0}={})=>({...k&&{key:i},...B?{"data-item-index":i}:{"data-tag-index":i},tabIndex:-1,...!ge&&{onDelete:k?o(i):s}}),getPopupIndicatorProps:()=>({tabIndex:-1,type:"button",onClick:h}),getTagProps:({index:i})=>({key:i,"data-tag-index":i,tabIndex:-1,...!ge&&{onDelete:o(i)}}),getListboxProps:()=>({role:"listbox",id:`${te}-listbox`,"aria-labelledby":`${te}-label`,ref:_t,onMouseDown:i=>{i.preventDefault()}}),getOptionProps:({index:i,option:n})=>{const g=(k?v:[v]).some(x=>x!=null&&F(n,x)),w=ee?ee(n):!1;return{key:(ve==null?void 0:ve(n))??Z(n),tabIndex:-1,role:"option",id:`${te}-option-${i}`,onMouseMove:pt,onClick:xt,onTouchStart:tt,"data-option-index":i,"aria-disabled":w,"aria-selected":g}},id:te,inputValue:L,value:v,dirty:W,expanded:N&&Be,popupOpen:N,focused:je||ue!==-1,anchorEl:Be,setAnchorEl:de,focusedItem:ue,focusedTag:ue,groupedOptions:Pe}}function kr(t){return $t("MuiListSubheader",t)}At("MuiListSubheader",["root","colorPrimary","colorInherit","gutters","inset","sticky"]);const Mr=t=>{const{classes:r,color:l,disableGutters:c,inset:b,disableSticky:u}=t,f={root:["root",l!=="default"&&`color${He(l)}`,!c&&"gutters",b&&"inset",!u&&"sticky"]};return Rt(f,kr,r)},Pr=me("li",{name:"MuiListSubheader",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:l}=t;return[r.root,l.color!=="default"&&r[`color${He(l.color)}`],!l.disableGutters&&r.gutters,l.inset&&r.inset,!l.disableSticky&&r.sticky]}})(Ue(({theme:t})=>({boxSizing:"border-box",lineHeight:"48px",listStyle:"none",color:(t.vars||t).palette.text.secondary,fontFamily:t.typography.fontFamily,fontWeight:t.typography.fontWeightMedium,fontSize:t.typography.pxToRem(14),variants:[{props:{color:"primary"},style:{color:(t.vars||t).palette.primary.main}},{props:{color:"inherit"},style:{color:"inherit"}},{props:({ownerState:r})=>!r.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:r})=>r.inset,style:{paddingLeft:72}},{props:({ownerState:r})=>!r.disableSticky,style:{position:"sticky",top:0,zIndex:1,backgroundColor:(t.vars||t).palette.background.paper}}]}))),Yt=a.forwardRef(function(r,l){const c=jt({props:r,name:"MuiListSubheader"}),{className:b,color:u="default",component:f="li",disableGutters:y=!1,disableSticky:$=!1,inset:I=!1,...C}=c,R={...c,color:u,component:f,disableGutters:y,disableSticky:$,inset:I},d=Mr(R);return e.jsx(Pr,{as:f,className:it(d.root,b),ref:l,ownerState:R,...C})});Yt&&(Yt.muiSkipListHighlight=!0);function $r(t){return $t("MuiAutocomplete",t)}const D=At("MuiAutocomplete",["root","expanded","fullWidth","focused","focusVisible","tag","tagSizeSmall","tagSizeMedium","hasPopupIcon","hasClearIcon","inputRoot","input","inputFocused","endAdornment","clearIndicator","popupIndicator","popupIndicatorOpen","popper","popperDisablePortal","paper","listbox","loading","noOptions","option","groupLabel","groupUl"]);var go,fo;const Ar=t=>{const{classes:r,disablePortal:l,expanded:c,focused:b,fullWidth:u,hasClearIcon:f,hasPopupIcon:y,inputFocused:$,popupOpen:I,size:C}=t,R={root:["root",c&&"expanded",b&&"focused",u&&"fullWidth",f&&"hasClearIcon",y&&"hasPopupIcon"],inputRoot:["inputRoot"],input:["input",$&&"inputFocused"],tag:["tag",`tagSize${He(C)}`],endAdornment:["endAdornment"],clearIndicator:["clearIndicator"],popupIndicator:["popupIndicator",I&&"popupIndicatorOpen"],popper:["popper",l&&"popperDisablePortal"],paper:["paper"],listbox:["listbox"],loading:["loading"],noOptions:["noOptions"],option:["option"],groupLabel:["groupLabel"],groupUl:["groupUl"]};return Rt(R,$r,r)},Rr=me("div",{name:"MuiAutocomplete",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:l}=t,{fullWidth:c,hasClearIcon:b,hasPopupIcon:u,inputFocused:f,size:y}=l;return[{[`& .${D.tag}`]:r.tag},{[`& .${D.tag}`]:r[`tagSize${He(y)}`]},{[`& .${D.inputRoot}`]:r.inputRoot},{[`& .${D.input}`]:r.input},{[`& .${D.input}`]:f&&r.inputFocused},r.root,c&&r.fullWidth,u&&r.hasPopupIcon,b&&r.hasClearIcon]}})({[`&.${D.focused} .${D.clearIndicator}`]:{visibility:"visible"},"@media (pointer: fine)":{[`&:hover .${D.clearIndicator}`]:{visibility:"visible"}},[`& .${D.tag}`]:{margin:3,maxWidth:"calc(100% - 6px)"},[`& .${D.inputRoot}`]:{[`.${D.hasPopupIcon}&, .${D.hasClearIcon}&`]:{paddingRight:30},[`.${D.hasPopupIcon}.${D.hasClearIcon}&`]:{paddingRight:56},[`& .${D.input}`]:{width:0,minWidth:30}},[`& .${Ht.root}`]:{paddingBottom:1,"& .MuiInput-input":{padding:"4px 4px 4px 0px"}},[`& .${Ht.root}.${ht.sizeSmall}`]:{[`& .${Ht.input}`]:{padding:"2px 4px 3px 0"}},[`& .${io.root}`]:{padding:9,[`.${D.hasPopupIcon}&, .${D.hasClearIcon}&`]:{paddingRight:39},[`.${D.hasPopupIcon}.${D.hasClearIcon}&`]:{paddingRight:65},[`& .${D.input}`]:{padding:"7.5px 4px 7.5px 5px"},[`& .${D.endAdornment}`]:{right:9}},[`& .${io.root}.${ht.sizeSmall}`]:{paddingTop:6,paddingBottom:6,paddingLeft:6,[`& .${D.input}`]:{padding:"2.5px 4px 2.5px 8px"}},[`& .${vt.root}`]:{paddingTop:19,paddingLeft:8,[`.${D.hasPopupIcon}&, .${D.hasClearIcon}&`]:{paddingRight:39},[`.${D.hasPopupIcon}.${D.hasClearIcon}&`]:{paddingRight:65},[`& .${vt.input}`]:{padding:"7px 4px"},[`& .${D.endAdornment}`]:{right:9}},[`& .${vt.root}.${ht.sizeSmall}`]:{paddingBottom:1,[`& .${vt.input}`]:{padding:"2.5px 4px"}},[`& .${ht.hiddenLabel}`]:{paddingTop:8},[`& .${vt.root}.${ht.hiddenLabel}`]:{paddingTop:0,paddingBottom:0,[`& .${D.input}`]:{paddingTop:16,paddingBottom:17}},[`& .${vt.root}.${ht.hiddenLabel}.${ht.sizeSmall}`]:{[`& .${D.input}`]:{paddingTop:8,paddingBottom:9}},[`& .${D.input}`]:{flexGrow:1,textOverflow:"ellipsis",opacity:0},variants:[{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{[`& .${D.tag}`]:{margin:2,maxWidth:"calc(100% - 4px)"}}},{props:{inputFocused:!0},style:{[`& .${D.input}`]:{opacity:1}}},{props:{multiple:!0},style:{[`& .${D.inputRoot}`]:{flexWrap:"wrap"}}}]}),Or=me("div",{name:"MuiAutocomplete",slot:"EndAdornment",overridesResolver:(t,r)=>r.endAdornment})({position:"absolute",right:0,top:"50%",transform:"translate(0, -50%)"}),Lr=me(Co,{name:"MuiAutocomplete",slot:"ClearIndicator",overridesResolver:(t,r)=>r.clearIndicator})({marginRight:-2,padding:4,visibility:"hidden"}),Dr=me(Co,{name:"MuiAutocomplete",slot:"PopupIndicator",overridesResolver:(t,r)=>{const{ownerState:l}=t;return[r.popupIndicator,l.popupOpen&&r.popupIndicatorOpen]}})({padding:2,marginRight:-2,variants:[{props:{popupOpen:!0},style:{transform:"rotate(180deg)"}}]}),zr=me(wo,{name:"MuiAutocomplete",slot:"Popper",overridesResolver:(t,r)=>{const{ownerState:l}=t;return[{[`& .${D.option}`]:r.option},r.popper,l.disablePortal&&r.popperDisablePortal]}})(Ue(({theme:t})=>({zIndex:(t.vars||t).zIndex.modal,variants:[{props:{disablePortal:!0},style:{position:"absolute"}}]}))),Tr=me(Bt,{name:"MuiAutocomplete",slot:"Paper",overridesResolver:(t,r)=>r.paper})(Ue(({theme:t})=>({...t.typography.body1,overflow:"auto"}))),Er=me("div",{name:"MuiAutocomplete",slot:"Loading",overridesResolver:(t,r)=>r.loading})(Ue(({theme:t})=>({color:(t.vars||t).palette.text.secondary,padding:"14px 16px"}))),Nr=me("div",{name:"MuiAutocomplete",slot:"NoOptions",overridesResolver:(t,r)=>r.noOptions})(Ue(({theme:t})=>({color:(t.vars||t).palette.text.secondary,padding:"14px 16px"}))),Fr=me("ul",{name:"MuiAutocomplete",slot:"Listbox",overridesResolver:(t,r)=>r.listbox})(Ue(({theme:t})=>({listStyle:"none",margin:0,padding:"8px 0",maxHeight:"40vh",overflow:"auto",position:"relative",[`& .${D.option}`]:{minHeight:48,display:"flex",overflow:"hidden",justifyContent:"flex-start",alignItems:"center",cursor:"pointer",paddingTop:6,boxSizing:"border-box",outline:"0",WebkitTapHighlightColor:"transparent",paddingBottom:6,paddingLeft:16,paddingRight:16,[t.breakpoints.up("sm")]:{minHeight:"auto"},[`&.${D.focused}`]:{backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},'&[aria-disabled="true"]':{opacity:(t.vars||t).palette.action.disabledOpacity,pointerEvents:"none"},[`&.${D.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},'&[aria-selected="true"]':{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:Wt(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${D.focused}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:Wt(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(t.vars||t).palette.action.selected}},[`&.${D.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:Wt(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}}}}))),qr=me(Yt,{name:"MuiAutocomplete",slot:"GroupLabel",overridesResolver:(t,r)=>r.groupLabel})(Ue(({theme:t})=>({backgroundColor:(t.vars||t).palette.background.paper,top:-8}))),Br=me("ul",{name:"MuiAutocomplete",slot:"GroupUl",overridesResolver:(t,r)=>r.groupUl})({padding:0,[`& .${D.option}`]:{paddingLeft:24}}),Kt=a.forwardRef(function(r,l){const c=jt({props:r,name:"MuiAutocomplete"}),{autoComplete:b=!1,autoHighlight:u=!1,autoSelect:f=!1,blurOnSelect:y=!1,ChipProps:$,className:I,clearIcon:C=go||(go=e.jsx(Xo,{fontSize:"small"})),clearOnBlur:R=!c.freeSolo,clearOnEscape:d=!1,clearText:j="Clear",closeText:S="Close",componentsProps:Q,defaultValue:ae=c.multiple?[]:null,disableClearable:X=!1,disableCloseOnSelect:pe=!1,disabled:ee=!1,disabledItemsFocusable:ve=!1,disableListWrap:Se=!1,disablePortal:ce=!1,filterOptions:q,filterSelectedOptions:z=!1,forcePopupIcon:O="auto",freeSolo:T=!1,fullWidth:F=!1,getLimitTagsText:k=E=>`+${E}`,getOptionDisabled:Ge,getOptionKey:at,getOptionLabel:Ke,isOptionEqualToValue:Ce,groupBy:De,handleHomeEndKeys:P=!c.freeSolo,id:Qe,includeInputInList:lt=!1,inputValue:ge,limitTags:B=-1,ListboxComponent:_e,ListboxProps:Fe,loading:te=!1,loadingText:Z="Loading…",multiple:fe=!1,noOptionsText:qe="No options",onChange:Y,onClose:xe,onHighlightChange:Be,onInputChange:de,onOpen:ue,open:oe,openOnFocus:Re=!1,openText:re="Open",options:Ye,PaperComponent:v,PopperComponent:se,popupIcon:L=fo||(fo=e.jsx(Jo,{})),readOnly:be=!1,renderGroup:je,renderInput:Je,renderOption:we,renderTags:ye,renderValue:We,selectOnFocus:ot=!c.freeSolo,size:Oe="medium",slots:ze={},slotProps:N={},value:M,...H}=c,{getRootProps:U,getInputProps:G,getInputLabelProps:rt,getPopupIndicatorProps:Te,getClearProps:Me,getItemProps:Ct,getListboxProps:ct,getOptionProps:_t,value:he,dirty:Xe,expanded:Ee,id:Ze,popupOpen:Le,focused:dt,focusedItem:ft,anchorEl:Ne,setAnchorEl:wt,inputValue:It,groupedOptions:et}=Ir({...c,componentName:"Autocomplete"}),ut=!X&&!ee&&Xe&&!be,pt=(!T||O===!0)&&O!==!1,{onMouseDown:tt}=G(),{ref:xt,...o}=ct(),h=Ke||(E=>E.label??E),p={...c,disablePortal:ce,expanded:Ee,focused:dt,fullWidth:F,getOptionLabel:h,hasClearIcon:ut,hasPopupIcon:pt,inputFocused:ft===-1,popupOpen:Le,size:Oe},_=Ar(p),le={slots:{paper:v,popper:se,...ze},slotProps:{chip:$,listbox:Fe,...Q,...N}},[W,Pe]=gt("listbox",{elementType:Fr,externalForwardedProps:le,ownerState:p,className:_.listbox,additionalProps:o,ref:xt}),[i,n]=gt("paper",{elementType:Bt,externalForwardedProps:le,ownerState:p,className:_.paper}),[g,w]=gt("popper",{elementType:wo,externalForwardedProps:le,ownerState:p,className:_.popper,additionalProps:{disablePortal:ce,style:{width:Ne?Ne.clientWidth:null},role:"presentation",anchorEl:Ne,open:Le}});let x;const K=E=>({className:_.tag,disabled:ee,...Ct(E)});if(ye&&fe&&he.length>0?x=ye(he,K,p):We&&he?x=We(he,K,p):fe&&he.length>0&&(x=he.map((E,st)=>{const{key:nt,...Mt}=K({index:st});return e.jsx(Ve,{label:h(E),size:Oe,...Mt,...le.slotProps.chip},nt)})),B>-1&&Array.isArray(x)){const E=x.length-B;!dt&&E>0&&(x=x.splice(0,B),x.push(e.jsx("span",{className:_.tag,children:k(E)},x.length)))}const $e=je||(E=>e.jsxs("li",{children:[e.jsx(qr,{className:_.groupLabel,ownerState:p,component:"div",children:E.group}),e.jsx(Br,{className:_.groupUl,ownerState:p,children:E.children})]},E.key)),Ot=we||((E,st)=>{const{key:nt,...Mt}=E;return e.jsx("li",{...Mt,children:h(st)},nt)}),kt=(E,st)=>{const nt=_t({option:E,index:st});return Ot({...nt,className:_.option},E,{selected:nt["aria-selected"],index:st,inputValue:It},p)},mt=le.slotProps.clearIndicator,Ae=le.slotProps.popupIndicator;return e.jsxs(a.Fragment,{children:[e.jsx(Rr,{ref:l,className:it(_.root,I),ownerState:p,...U(H),children:Je({id:Ze,disabled:ee,fullWidth:!0,size:Oe==="small"?"small":void 0,InputLabelProps:rt(),InputProps:{ref:wt,className:_.inputRoot,startAdornment:x,onMouseDown:E=>{E.target===E.currentTarget&&tt(E)},...(ut||pt)&&{endAdornment:e.jsxs(Or,{className:_.endAdornment,ownerState:p,children:[ut?e.jsx(Lr,{...Me(),"aria-label":j,title:j,ownerState:p,...mt,className:it(_.clearIndicator,mt==null?void 0:mt.className),children:C}):null,pt?e.jsx(Dr,{...Te(),disabled:ee,"aria-label":Le?S:re,title:Le?S:re,ownerState:p,...Ae,className:it(_.popupIndicator,Ae==null?void 0:Ae.className),children:L}):null]})}},inputProps:{className:_.input,disabled:ee,readOnly:be,...G()}})}),Ne?e.jsx(zr,{as:g,...w,children:e.jsxs(Tr,{as:i,...n,children:[te&&et.length===0?e.jsx(Er,{className:_.loading,ownerState:p,children:Z}):null,et.length===0&&!T&&!te?e.jsx(Nr,{className:_.noOptions,ownerState:p,role:"presentation",onMouseDown:E=>{E.preventDefault()},children:qe}):null,et.length>0?e.jsx(W,{as:_e,...Pe,children:et.map((E,st)=>De?$e({key:E.key,group:E.group,children:E.options.map((nt,Mt)=>kt(nt,E.index+Mt))}):kt(E,st))}):null]})}):null]})});function Wr(t){return $t("MuiCardMedia",t)}At("MuiCardMedia",["root","media","img"]);const Vr=t=>{const{classes:r,isMediaComponent:l,isImageComponent:c}=t;return Rt({root:["root",l&&"media",c&&"img"]},Wr,r)},Hr=me("div",{name:"MuiCardMedia",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:l}=t,{isMediaComponent:c,isImageComponent:b}=l;return[r.root,c&&r.media,b&&r.img]}})({display:"block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center",variants:[{props:{isMediaComponent:!0},style:{width:"100%"}},{props:{isImageComponent:!0},style:{objectFit:"cover"}}]}),Ur=["video","audio","picture","iframe","img"],Gr=["picture","img"],xo=a.forwardRef(function(r,l){const c=jt({props:r,name:"MuiCardMedia"}),{children:b,className:u,component:f="div",image:y,src:$,style:I,...C}=c,R=Ur.includes(f),d=!R&&y?{backgroundImage:`url("${y}")`,...I}:I,j={...c,component:f,isMediaComponent:R,isImageComponent:Gr.includes(f)},S=Vr(j);return e.jsx(Hr,{className:it(S.root,u),as:f,role:!R&&y?"img":void 0,ref:l,style:d,ownerState:j,src:R?y||$:void 0,...C,children:b})}),Jt=typeof jo({})=="function",Kr=(t,r)=>({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%",...r&&!t.vars&&{colorScheme:t.palette.mode}}),Qr=t=>({color:(t.vars||t).palette.text.primary,...t.typography.body1,backgroundColor:(t.vars||t).palette.background.default,"@media print":{backgroundColor:(t.vars||t).palette.common.white}}),Po=(t,r=!1)=>{var u,f;const l={};r&&t.colorSchemes&&typeof t.getColorSchemeSelector=="function"&&Object.entries(t.colorSchemes).forEach(([y,$])=>{var C,R;const I=t.getColorSchemeSelector(y);I.startsWith("@")?l[I]={":root":{colorScheme:(C=$.palette)==null?void 0:C.mode}}:l[I.replace(/\s*&/,"")]={colorScheme:(R=$.palette)==null?void 0:R.mode}});let c={html:Kr(t,r),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:t.typography.fontWeightBold},body:{margin:0,...Qr(t),"&::backdrop":{backgroundColor:(t.vars||t).palette.background.default}},...l};const b=(f=(u=t.components)==null?void 0:u.MuiCssBaseline)==null?void 0:f.styleOverrides;return b&&(c=[c,b]),c},qt="mui-ecs",Yr=t=>{const r=Po(t,!1),l=Array.isArray(r)?r[0]:r;return!t.vars&&l&&(l.html[`:root:has(${qt})`]={colorScheme:t.palette.mode}),t.colorSchemes&&Object.entries(t.colorSchemes).forEach(([c,b])=>{var f,y;const u=t.getColorSchemeSelector(c);u.startsWith("@")?l[u]={[`:root:not(:has(.${qt}))`]:{colorScheme:(f=b.palette)==null?void 0:f.mode}}:l[u.replace(/\s*&/,"")]={[`&:not(:has(.${qt}))`]:{colorScheme:(y=b.palette)==null?void 0:y.mode}}}),r},Jr=jo(Jt?({theme:t,enableColorScheme:r})=>Po(t,r):({theme:t})=>Yr(t));function Xr(t){const r=jt({props:t,name:"MuiCssBaseline"}),{children:l,enableColorScheme:c=!1}=r;return e.jsxs(a.Fragment,{children:[Jt&&e.jsx(Jr,{enableColorScheme:c}),!Jt&&!c&&e.jsx("span",{className:qt,style:{display:"none"}}),l]})}function Zr(t){return $t("MuiMobileStepper",t)}At("MuiMobileStepper",["root","positionBottom","positionTop","positionStatic","dots","dot","dotActive","progress"]);const es=t=>{const{classes:r,position:l}=t,c={root:["root",`position${He(l)}`],dots:["dots"],dot:["dot"],dotActive:["dotActive"],progress:["progress"]};return Rt(c,Zr,r)},ts=me(Bt,{name:"MuiMobileStepper",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:l}=t;return[r.root,r[`position${He(l.position)}`]]}})(Ue(({theme:t})=>({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",background:(t.vars||t).palette.background.default,padding:8,variants:[{props:({position:r})=>r==="top"||r==="bottom",style:{position:"fixed",left:0,right:0,zIndex:(t.vars||t).zIndex.mobileStepper}},{props:{position:"top"},style:{top:0}},{props:{position:"bottom"},style:{bottom:0}}]}))),os=me("div",{name:"MuiMobileStepper",slot:"Dots",overridesResolver:(t,r)=>r.dots})({variants:[{props:{variant:"dots"},style:{display:"flex",flexDirection:"row"}}]}),rs=me("div",{name:"MuiMobileStepper",slot:"Dot",shouldForwardProp:t=>To(t)&&t!=="dotActive",overridesResolver:(t,r)=>{const{dotActive:l}=t;return[r.dot,l&&r.dotActive]}})(Ue(({theme:t})=>({variants:[{props:{variant:"dots"},style:{transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),backgroundColor:(t.vars||t).palette.action.disabled,borderRadius:"50%",width:8,height:8,margin:"0 2px"}},{props:{variant:"dots",dotActive:!0},style:{backgroundColor:(t.vars||t).palette.primary.main}}]}))),ss=me(_o,{name:"MuiMobileStepper",slot:"Progress",overridesResolver:(t,r)=>r.progress})({variants:[{props:{variant:"progress"},style:{width:"50%"}}]}),ns=a.forwardRef(function(r,l){const c=jt({props:r,name:"MuiMobileStepper"}),{activeStep:b=0,backButton:u,className:f,LinearProgressProps:y,nextButton:$,position:I="bottom",steps:C,variant:R="dots",slots:d={},slotProps:j={},...S}=c,Q={...c,activeStep:b,position:I,variant:R};let ae;R==="progress"&&(C===1?ae=100:ae=Math.ceil(b/(C-1)*100));const X=es(Q),pe={slots:d,slotProps:{progress:y,...j}},[ee,ve]=gt("root",{ref:l,elementType:ts,shouldForwardComponentProp:!0,className:it(X.root,f),externalForwardedProps:{...pe,...S},ownerState:Q,additionalProps:{square:!0,elevation:0}}),[Se,ce]=gt("dots",{className:X.dots,elementType:os,externalForwardedProps:pe,ownerState:Q}),[q,z]=gt("dot",{elementType:rs,externalForwardedProps:pe,ownerState:Q}),[O,T]=gt("progress",{className:X.progress,elementType:ss,shouldForwardComponentProp:!0,externalForwardedProps:pe,ownerState:Q,additionalProps:{value:ae,variant:"determinate"}});return e.jsxs(ee,{...ve,children:[u,R==="text"&&e.jsxs(a.Fragment,{children:[b+1," / ",C]}),R==="dots"&&e.jsx(Se,{...ce,children:[...new Array(C)].map((F,k)=>e.jsx(q,{...z,className:it(X.dot,z.className,k===b&&X.dotActive),dotActive:k===b},k))}),R==="progress"&&e.jsx(O,{...T}),$]})}),bo=ke([e.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),e.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")]),is=ke(e.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"})),as=ke(e.jsx("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m2 14H7v-2h7zm3-4H7v-2h10zm0-4H7V7h10z"})),yo=ke(e.jsx("path",{d:"m22.7 19-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4"})),ls=ke([e.jsx("circle",{cx:"12",cy:"12",r:"3.2"},"0"),e.jsx("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")]),cs=ke(e.jsx("path",{d:"m13.7826 15.1719 2.1213-2.1213 5.9963 5.9962-2.1213 2.1213zM17.5 10c1.93 0 3.5-1.57 3.5-3.5 0-.58-.16-1.12-.41-1.6l-2.7 2.7-1.49-1.49 2.7-2.7c-.48-.25-1.02-.41-1.6-.41C15.57 3 14 4.57 14 6.5c0 .41.08.8.21 1.16l-1.85 1.85-1.78-1.78.71-.71-1.41-1.41L12 3.49c-1.17-1.17-3.07-1.17-4.24 0L4.22 7.03l1.41 1.41H2.81l-.71.71 3.54 3.54.71-.71V9.15l1.41 1.41.71-.71 1.78 1.78-7.41 7.41 2.12 2.12L16.34 9.79c.36.13.75.21 1.16.21"})),ds=ke(e.jsx("path",{d:"M4 6h18V4H4c-1.1 0-2 .9-2 2v11H0v3h14v-3H4zm19 2h-6c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1m-1 9h-4v-7h4z"})),us=ke(e.jsx("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3m-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3m0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5m8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5"})),ps=ke(e.jsx("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"})),ms=ke(e.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"})),hs=ke(e.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"})),gs=ke(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39"})),fs=ke([e.jsx("path",{d:"M12 5.99 19.53 19H4.47zM12 2 1 21h22z"},"0"),e.jsx("path",{d:"M13 16h-2v2h2zm0-6h-2v5h2z"},"1")]),xs=ke(e.jsx("path",{d:"m6.76 4.84-1.8-1.79-1.41 1.41 1.79 1.79zM4 10.5H1v2h3zm9-9.95h-2V3.5h2zm7.45 3.91-1.41-1.41-1.79 1.79 1.41 1.41zm-3.21 13.7 1.79 1.8 1.41-1.41-1.8-1.79zM20 10.5v2h3v-2zm-8-5c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6m-1 16.95h2V19.5h-2zm-7.45-3.91 1.41 1.41 1.79-1.8-1.41-1.41z"})),Qt="construction",bs="dpr_draft_",vo=[{key:"on track",label:"On Track",color:"success"},{key:"delayed",label:"Delayed",color:"warning"},{key:"halted",label:"Halted",color:"error"}],Ns=()=>{var xt;const t=Vo("(max-width:600px)"),r=a.useRef(null),l=a.useRef(null),[c,b]=a.useState([]),[u,f]=a.useState(""),[y,$]=a.useState("list"),[I,C]=a.useState(0),R=["Details","Compliance","Location","Photo","Review"],[d,j]=a.useState({site_supervisor_id:"",work_completed:"",manpower_utilized:"",equipment_used:"",weather_conditions:"",safety_compliance_report:"",material_consumption:"",site_issues:"",site_execution_status:"on track",progress_percent:"",milestone:""}),[S,Q]=a.useState({latitude:null,longitude:null,accuracy:null,timestamp:null,error:"",loading:!1,permission:"prompt"}),[ae,X]=a.useState(""),[pe,ee]=a.useState(null),[ve,Se]=a.useState(!1),[ce,q]=a.useState({open:!1,severity:"success",message:""}),[z,O]=a.useState(!1),[T,F]=a.useState(!1),[k,Ge]=a.useState([]),[at,Ke]=a.useState(!1),[Ce,De]=a.useState(!1),[P,Qe]=a.useState(null),[lt,ge]=a.useState(!1),[B,_e]=a.useState([]),[Fe,te]=a.useState([]),[Z,fe]=a.useState(!1),[qe,Y]=a.useState(!1),[xe,Be]=a.useState(!1),[de,ue]=a.useState(null),[oe,Re]=a.useState({item:null,quantity:"",unit_price:"",requested_by:""}),[re,Ye]=a.useState(!1),[v,se]=a.useState([]),[L,be]=a.useState(""),[je,Je]=a.useState(!1),[we,ye]=a.useState([]),[We,ot]=a.useState(!1),Oe=a.useMemo(()=>navigator.userAgent||"unknown",[]),ze=a.useCallback(o=>{if(!o)return"-";const s=new Date(o);if(isNaN(s))return"-";const h=String(s.getDate()).padStart(2,"0"),p=String(s.getMonth()+1).padStart(2,"0"),_=s.getFullYear();return`${h}/${p}/${_}`},[]),N=a.useCallback(o=>{if(o==null||o==="")return"-";const s=Number(o);if(isNaN(s))return`₹ ${o}`;try{return`₹ ${new Intl.NumberFormat("en-IN",{maximumFractionDigits:2}).format(s)}`}catch{return`₹ ${s}`}},[]),M=a.useMemo(()=>So({shape:{borderRadius:14},typography:{fontFamily:'Quicksand, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif',fontSize:15,body1:{fontSize:"0.98rem"},body2:{fontSize:"0.92rem"},button:{fontSize:"0.96rem"},h6:{fontWeight:700}},palette:{primary:{main:"#57B79D"},secondary:{main:"#FFB672"},info:{main:"#FEB4A9"},text:{primary:"#021A2D"}},components:{MuiChip:{defaultProps:{size:"medium"},styleOverrides:{root:{borderRadius:999},outlinedPrimary:{backgroundColor:"rgba(87,183,157,0.08)"},outlinedInfo:{backgroundColor:"rgba(254,180,169,0.10)"},outlinedSecondary:{backgroundColor:"rgba(255,182,114,0.10)"}}},MuiButton:{defaultProps:{size:"medium"},styleOverrides:{root:{textTransform:"none",borderRadius:10,padding:"8px 16px"}}},MuiPaper:{styleOverrides:{root:{borderRadius:16}}},MuiCard:{styleOverrides:{root:{borderRadius:16}}},MuiOutlinedInput:{styleOverrides:{root:{borderRadius:12,"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#57B79D"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#57B79D",borderWidth:2}},notchedOutline:{borderRadius:12},input:{paddingTop:10,paddingBottom:10}}},MuiDialog:{styleOverrides:{paper:{borderRadius:18}}}}}),[]);a.useEffect(()=>{const o="quicksand-font-link";if(!document.getElementById(o)){const s=document.createElement("link");s.id=o,s.rel="stylesheet",s.href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap",document.head.appendChild(s)}},[]);const H=a.useMemo(()=>`${bs}${u||"no_project"}`,[u]),U=(o,s)=>j(h=>({...h,[o]:s}));a.useEffect(()=>{let o=!0;return(async()=>{try{const s=await Eo();o&&b(Array.isArray(s)?s:[])}catch(s){console.error("Failed to load projects",s)}})(),()=>{o=!1}},[]),a.useEffect(()=>{try{const o=localStorage.getItem(H);if(o){const s=JSON.parse(o);j(s.form||{}),X(s.photoPreview||""),O(!0),q({open:!0,severity:"success",message:"Draft restored"})}else j(s=>({...s}))}catch{}},[H]),a.useEffect(()=>{(async()=>{if(!u){Ge([]);return}Ke(!0);try{const s=await to(),h=Array.isArray(s)?s.filter(p=>String(p.project)===String(u)):[];h.sort((p,_)=>new Date(_.created_at||_.updated_at||0)-new Date(p.created_at||p.updated_at||0)),Ge(h)}catch(s){console.error("Failed to load reports",s)}finally{Ke(!1)}})()},[u]),a.useEffect(()=>{(async()=>{if(!u){ye([]);return}try{ot(!0);const s=await Fo(u);ye(Array.isArray(s)?s:[])}catch(s){console.error("Failed to load milestones",s),ye([])}finally{ot(!1)}})()},[u]);const G=a.useCallback(()=>{if(!u){q({open:!0,severity:"info",message:"Select a project first"});return}Ye(!0)},[u]),rt=a.useCallback(()=>{Ye(!1)},[]),Te=a.useCallback(o=>{o&&se(s=>s.some(p=>{var _;return((_=p.item)==null?void 0:_.item_id)===o.item_id})?s:[...s,{item:o,quantity:""}])},[]),Me=a.useCallback((o,s)=>{se(h=>h.map(p=>{var _;return((_=p.item)==null?void 0:_.item_id)===o?{...p,quantity:s}:p}))},[]),Ct=a.useCallback(o=>{se(s=>s.filter(h=>{var p;return((p=h.item)==null?void 0:p.item_id)!==o}))},[]),ct=a.useCallback(async()=>{var s;if(!u){q({open:!0,severity:"warning",message:"Project is required"});return}const o=v.filter(h=>h.item&&h.quantity&&Number(h.quantity)>0).map(h=>({material:h.item.item_id,project:u,material_name:h.item.item_name,quantity_used:h.quantity}));if(o.length===0){q({open:!0,severity:"warning",message:"Add at least one item with quantity"});return}try{Je(!0);for(const _ of o)await No(_);const h=o.map(_=>`${_.material} - ${_.material_name}: ${_.quantity_used}`).join(", "),p=L!=null&&L.trim()?`${h}. Notes: ${L.trim()}`:h;j(_=>({..._,material_consumption:p})),q({open:!0,severity:"success",message:"Material consumption recorded"}),Ye(!1)}catch(h){const p=(s=h==null?void 0:h.response)!=null&&s.data?JSON.stringify(h.response.data):h.message;q({open:!0,severity:"error",message:p||"Failed to save material consumption"})}finally{Je(!1)}},[v,L,u]);a.useEffect(()=>{let o=!0;return(async()=>{try{fe(!0);const s=await Bo();o&&_e(Array.isArray(s)?s:[])}catch(s){console.error("Failed to load inventory",s)}finally{fe(!1)}})(),()=>{o=!1}},[]),a.useEffect(()=>{let o=!0;return(async()=>{if(!u){te([]);return}try{Y(!0);const s=await oo(),h=(Array.isArray(s)?s:[]).filter(p=>String(p.project)===String(u));o&&te(h)}catch(s){console.error("Failed to load procurements",s)}finally{Y(!1)}})(),()=>{o=!1}},[u]);const _t=a.useCallback(()=>{if(!u){q({open:!0,severity:"info",message:"Select a project to request materials"});return}Re({item:null,quantity:"",unit_price:"",requested_by:""}),ge(!0)},[u]),he=a.useCallback(()=>ge(!1),[]),Xe=a.useCallback(async()=>{var o;if(!u){q({open:!0,severity:"warning",message:"Project is required"});return}if(!oe.item){q({open:!0,severity:"warning",message:"Select an item"});return}if(!oe.quantity){q({open:!0,severity:"warning",message:"Enter quantity"});return}try{const s=new FormData;s.append("project",u),s.append("material_name",oe.item.item_name||""),s.append("material_code",oe.item.item_id||""),s.append("quantity_requested",String(oe.quantity)),oe.unit_price&&s.append("unit_price",String(oe.unit_price)),s.append("requested_by",oe.requested_by||""),s.append("request_date",new Date().toISOString().slice(0,10)),s.append("approval_status","Pending"),s.append("payment_status","Pending"),await Wo(s),q({open:!0,severity:"success",message:"Material request submitted"}),ge(!1);try{const h=await oo(),p=(Array.isArray(h)?h:[]).filter(_=>String(_.project)===String(u));te(p)}catch{}}catch(s){const h=(o=s==null?void 0:s.response)!=null&&o.data?JSON.stringify(s.response.data):s.message;q({open:!0,severity:"error",message:h||"Failed to submit"})}},[u,oe]),Ee=a.useCallback(o=>{ue(o),Be(!0)},[]),Ze=a.useCallback(()=>{Be(!1),ue(null)},[]),Le=a.useCallback(o=>{Qe(o),De(!0)},[]),dt=a.useCallback(()=>{De(!1),Qe(null)},[]);a.useEffect(()=>{const o=setTimeout(()=>{try{const s={form:d,photoPreview:ae};localStorage.setItem(H,JSON.stringify(s))}catch{}},400);return()=>clearTimeout(o)},[d,ae,H]);const ft=a.useCallback(()=>{try{localStorage.removeItem(H),q({open:!0,severity:"success",message:"Draft cleared"})}catch{}},[H]),Ne=a.useCallback(()=>{if(!("geolocation"in navigator)){Q(o=>({...o,error:"Geolocation not supported",permission:"denied"}));return}Q(o=>({...o,loading:!0,error:""})),navigator.geolocation.getCurrentPosition(o=>{Q({latitude:o.coords.latitude,longitude:o.coords.longitude,accuracy:o.coords.accuracy,timestamp:o.timestamp?new Date(o.timestamp).toISOString():new Date().toISOString(),error:"",loading:!1,permission:"granted"})},o=>{Q(s=>({...s,error:o.message||"Location permission denied",loading:!1,permission:"denied"}))},{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})},[]);a.useEffect(()=>{T||(F(!0),Ne())},[T,Ne]);const wt=()=>{r.current&&r.current.click()},It=async(o,s)=>{const h=new Image,p=URL.createObjectURL(o);return new Promise((_,le)=>{h.onload=async()=>{try{const W=l.current;if(!W)return le(new Error("Canvas not found"));const Pe=1280,i=h.width>Pe?Pe/h.width:1,n=Math.round(h.width*i),g=Math.round(h.height*i);W.width=n,W.height=g;const w=W.getContext("2d");w.drawImage(h,0,0,n,g);const x=[];if(s.latitude&&s.longitude&&x.push(`Lat: ${Number(s.latitude).toFixed(6)}, Lng: ${Number(s.longitude).toFixed(6)}`),s.timestamp){const Ae=new Date(s.timestamp);x.push(`Time: ${Ae.toLocaleString()}`)}w.font=`${Math.max(14,Math.round(n*.018))}px sans-serif`,w.fillStyle="rgba(0,0,0,0.55)",w.textBaseline="bottom";const K=8,J=Math.max(18,Math.round(n*.024)),bt=x.reduce((Ae,E)=>Math.max(Ae,w.measureText(E).width),0)+K*2,Ot=J*x.length+K*2,kt=n-bt-10,mt=g-10;w.fillRect(kt,mt-Ot,bt,Ot),w.fillStyle="white",x.forEach((Ae,E)=>{w.fillText(Ae,kt+K,mt-K-(x.length-1-E)*J)}),W.toBlob(Ae=>{if(!Ae)return le(new Error("Failed to export image"));const E=W.toDataURL("image/jpeg",.9);_({blob:Ae,preview:E})},"image/jpeg",.9)}catch(W){le(W)}finally{URL.revokeObjectURL(p)}},h.onerror=()=>{URL.revokeObjectURL(p),le(new Error("Failed to load image"))},h.src=p})},et=async o=>{var h;const s=(h=o.target.files)==null?void 0:h[0];if(s)try{const{blob:p,preview:_}=await It(s,{latitude:S.latitude,longitude:S.longitude,timestamp:S.timestamp||new Date().toISOString()});ee(p),X(_),q({open:!0,severity:"success",message:"Photo captured"})}catch(p){console.error(p),q({open:!0,severity:"error",message:"Failed to process photo"})}finally{o.target.value=""}},ut=()=>{var h,p;const o=[];u||o.push("Project is required"),(h=d.site_supervisor_id)!=null&&h.trim()||o.push("Supervisor ID is required"),(p=d.work_completed)!=null&&p.trim()||o.push("Work completed is required"),(!d.manpower_utilized||isNaN(Number(d.manpower_utilized)))&&o.push("Valid manpower utilized is required"),d.site_execution_status||o.push("Status is required"),d.milestone||o.push("Milestone is required");const s=Number(d.progress_percent);return(d.progress_percent===""||isNaN(s)||s<0||s>100)&&o.push("Valid progress percent (0-100) is required"),o.length?(q({open:!0,severity:"error",message:o[0]}),!1):!0},pt=async()=>{var o;if(ut()){Se(!0);try{const s=new FormData;s.append("project",u),s.append("site_supervisor_id",d.site_supervisor_id),s.append("work_completed",d.work_completed),s.append("manpower_utilized",String(d.manpower_utilized||"0")),s.append("equipment_used",d.equipment_used||""),s.append("weather_conditions",d.weather_conditions||""),s.append("safety_compliance_report",d.safety_compliance_report||""),s.append("material_consumption",d.material_consumption||""),d.site_issues&&s.append("site_issues",d.site_issues),s.append("site_execution_status",d.site_execution_status||"on track"),s.append("progress_percent",String(d.progress_percent||"0")),s.append("milestone",String(d.milestone)),S.latitude!=null&&s.append("latitude",String(S.latitude)),S.longitude!=null&&s.append("longitude",String(S.longitude)),S.accuracy!=null&&s.append("location_accuracy",String(S.accuracy)),S.timestamp&&s.append("location_timestamp",S.timestamp),Oe&&s.append("device_id",Oe),pe&&s.append("photo_evidence",pe,"evidence.jpg");const h=await qo(s);q({open:!0,severity:"success",message:`Saved! Site ID: ${(h==null?void 0:h.site_id)||"generated"}`}),j({site_supervisor_id:"",work_completed:"",manpower_utilized:"",equipment_used:"",weather_conditions:"",safety_compliance_report:"",material_consumption:"",site_issues:"",site_execution_status:"on track",progress_percent:"",milestone:""}),ee(null),X(""),ft(),$("list"),C(0);try{const p=await to(),_=Array.isArray(p)?p.filter(le=>String(le.project)===String(u)):[];_.sort((le,W)=>new Date(W.created_at||W.updated_at||0)-new Date(le.created_at||le.updated_at||0)),Ge(_)}catch{}}catch(s){console.error("Submit failed",s);const h=(o=s==null?void 0:s.response)!=null&&o.data?JSON.stringify(s.response.data):(s==null?void 0:s.message)||"Submit failed";q({open:!0,severity:"error",message:h})}finally{Se(!1)}}},tt=a.useCallback(()=>{var o;try{let s="";const h=localStorage.getItem("userInfo");if(h){const p=JSON.parse(h);s=(p==null?void 0:p.user_id)||(p==null?void 0:p.userid)||(p==null?void 0:p.userId)||(p==null?void 0:p.id)||((o=p==null?void 0:p.profile)==null?void 0:o.user_id)||""}if(!s){const p=getLoggedInUserInfo==null?void 0:getLoggedInUserInfo();s=(p==null?void 0:p.user_id)||""}return s}catch{return""}},[]);return a.useEffect(()=>{const o=()=>{const s=tt();s&&!d.site_supervisor_id&&j(h=>({...h,site_supervisor_id:s}))};return o(),window.addEventListener("userInfoUpdated",o),()=>window.removeEventListener("userInfoUpdated",o)},[d.site_supervisor_id,tt]),a.useEffect(()=>{if(!d.site_supervisor_id){const o=tt();o&&j(s=>({...s,site_supervisor_id:o}))}},[z]),a.useEffect(()=>{if(y==="form"&&!d.site_supervisor_id){const o=tt();o&&j(s=>({...s,site_supervisor_id:o}))}},[y,d.site_supervisor_id,tt]),e.jsxs(fr,{theme:M,children:[e.jsx(Xr,{}),e.jsxs(V,{sx:{pb:10},children:[e.jsx("canvas",{ref:l,style:{display:"none"}}),e.jsx(vr,{position:"sticky",elevation:0,sx:{backgroundColor:"background.paper",boxShadow:"none",borderBottom:o=>`1px solid ${o.palette.divider}`},children:e.jsxs(Qo,{sx:{minHeight:56,alignItems:"center",gap:1},children:[e.jsx(m,{variant:"h6",sx:{flex:1,color:"text.primary",fontWeight:600},children:"Site Execution Supervisor"}),e.jsx(Ve,{label:((xt=vo.find(o=>o.key===d.site_execution_status))==null?void 0:xt.label)||"Status",color:"primary",size:"small",variant:"outlined"})]})}),e.jsxs(V,{sx:{p:0},children:[y==="list"&&e.jsxs(V,{sx:{position:"relative",overflow:"hidden",px:2,pt:2,pb:6,background:"linear-gradient(135deg, rgba(87,183,157,0.12) 0%, rgba(255,182,114,0.12) 100%)",color:"text.primary",borderBottomLeftRadius:28,borderBottom:o=>`1px solid ${o.palette.divider}`},children:[e.jsx(V,{sx:{position:"absolute",right:-30,top:-30,width:140,height:140,bgcolor:"primary.main",opacity:.12,borderRadius:"50%"}}),e.jsx(V,{sx:{position:"absolute",right:40,top:-10,width:60,height:60,bgcolor:"secondary.main",opacity:.14,borderRadius:"50%"}}),e.jsxs(A,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(m,{variant:"h6",sx:{flex:1},children:"Today"}),e.jsx(Ve,{size:"small",color:"primary",variant:"outlined",label:new Date().toLocaleDateString()})]}),e.jsx(m,{variant:"body2",sx:{opacity:.8,mt:.5},children:"Log your daily progress, capture a photo and location."}),e.jsx(V,{component:"svg",viewBox:"0 0 1440 80",preserveAspectRatio:"none",sx:{position:"absolute",left:0,right:0,bottom:-1,height:40,width:"100%"},children:e.jsx("path",{fill:"currentColor",fillOpacity:"0.06",d:"M0,64L60,53.3C120,43,240,21,360,21.3C480,21,600,43,720,58.7C840,75,960,85,1080,69.3C1200,53,1320,11,1380,-5.3L1440,-21L1440,81L1380,81C1320,81,1200,81,1080,81C960,81,840,81,720,81C600,81,480,81,360,81C240,81,120,81,60,81L0,81Z"})})]}),e.jsx(ro,{elevation:0,sx:{border:"none",borderRadius:2,mt:0,mx:2,mb:2,backgroundColor:"background.paper",boxShadow:"0 6px 20px rgba(0,0,0,0.06)",p:1},children:e.jsx(so,{children:e.jsxs(A,{spacing:2,children:[e.jsx(ne,{select:!0,label:"Project",fullWidth:!0,size:"small",required:!0,value:u,onChange:o=>f(o.target.value),children:c.map((o,s)=>e.jsx(Yo,{value:o.project_id,children:o.project_id},s))}),!u&&e.jsx(m,{variant:"caption",color:"text.secondary",sx:{pl:.5},children:"Select a project to add today's report."}),e.jsxs(A,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(m,{variant:"subtitle1",sx:{color:"text.secondary",flex:1},children:"Previous Reports"}),e.jsx(yt,{slug:"construction",action:"can_create",children:e.jsx(Ie,{size:"small",variant:"outlined",onClick:_t,disabled:!u,children:"Request Materials"})})]}),y==="list"&&e.jsxs(e.Fragment,{children:[at?e.jsxs(A,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(Lt,{size:18}),e.jsx(m,{variant:"body2",children:"Loading…"})]}):k.length===0?e.jsx(m,{variant:"body2",color:"text.secondary",children:"No reports yet for this project."}):e.jsx(A,{spacing:1.5,children:k.slice(0,6).map((o,s)=>e.jsxs(A,{direction:"row",alignItems:"center",spacing:2,onClick:()=>Le(o),sx:{p:1.6,borderRadius:1.5,backgroundColor:"background.paper",border:"1px solid",borderColor:"divider",cursor:"pointer",position:"relative","&:before":{content:'""',position:"absolute",left:-10,top:0,bottom:0,width:2,background:"linear-gradient(180deg, #57B79D, transparent)"},"&:hover":{boxShadow:"0 6px 16px rgba(0,0,0,0.06)",transform:"translateY(-1px)",transition:"all .15s ease"}},children:[e.jsx(V,{sx:{width:10,height:10,borderRadius:"50%",bgcolor:"primary.main"}}),e.jsxs(V,{sx:{flex:1},children:[e.jsx(m,{variant:"subtitle2",sx:{lineHeight:1.1},children:o.daily_progress_report_id||o.site_id}),e.jsx(m,{variant:"caption",color:"text.secondary",children:new Date(o.updated_at||o.created_at).toLocaleString()}),e.jsx(m,{variant:"body2",sx:{mt:.5},children:o.work_completed?String(o.work_completed).slice(0,64)+(String(o.work_completed).length>64?"…":""):"-"})]}),e.jsx(Ve,{label:(o.site_execution_status||"").replace(/\b\w/g,h=>h.toUpperCase()),size:"small",variant:"outlined"})]},`${o.site_id}-${s}`))}),e.jsx(Pt,{sx:{my:1.5}}),e.jsx(m,{variant:"subtitle1",sx:{color:"text.secondary"},children:"Requested Materials"}),qe?e.jsxs(A,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(Lt,{size:18}),e.jsx(m,{variant:"body2",children:"Loading…"})]}):Fe.length===0?e.jsx(m,{variant:"body2",color:"text.secondary",children:"No material requests for this project."}):e.jsxs(A,{spacing:1.5,children:[e.jsxs(A,{direction:"row",spacing:2.5,alignItems:"center",sx:{color:"text.secondary",fontSize:12},children:[e.jsx(V,{sx:{width:14,height:6,bgcolor:"warning.light",borderRadius:1}})," ",e.jsx("span",{children:"Approval"}),e.jsx(V,{sx:{width:14,height:6,bgcolor:"info.light",borderRadius:1}})," ",e.jsx("span",{children:"Delivery"}),e.jsx(V,{sx:{width:14,height:6,bgcolor:"success.light",borderRadius:1}})," ",e.jsx("span",{children:"Payment"})]}),Fe.map((o,s)=>{const h=o.approval_status==="Approved"?50:o.approval_status==="Rejected"?0:20;let p=0;if(o.expected_delivery_date&&o.request_date){const W=new Date(o.request_date),Pe=new Date(o.expected_delivery_date),i=new Date;if(!isNaN(W)&&!isNaN(Pe)&&Pe>W){const n=Pe-W,w=Math.min(Math.max(i-W,0),n)/n;p=Math.round(30*w)}else!isNaN(Pe)&&Pe<=i&&(p=30)}else if(o.expected_delivery_date){const W=new Date(o.expected_delivery_date);p=new Date>=W?30:0}const _=o.payment_status==="Completed"?20:o.payment_status==="Partially Paid"?10:0,le=Math.min(100,h+p+_);return e.jsxs(V,{onClick:()=>Ee(o),sx:{p:1.6,borderRadius:1.5,border:"1px solid",borderColor:"divider",cursor:"pointer","&:hover":{boxShadow:"0 8px 18px rgba(0,0,0,0.08)"}},children:[e.jsxs(A,{direction:"row",alignItems:"center",spacing:1.5,sx:{flexWrap:"wrap",p:1},children:[e.jsx(Ve,{size:"small",label:o.approval_status,variant:"outlined",color:o.approval_status==="Approved"?"success":o.approval_status==="Rejected"?"error":"warning"}),e.jsx(Ve,{size:"small",label:"Payment "+o.payment_status,variant:"outlined"})]}),e.jsx(A,{direction:"row",alignItems:"center",spacing:1.5,sx:{flexWrap:"wrap"},children:e.jsxs(m,{variant:"subtitle1",sx:{flex:1},children:[o.material_name," (",o.material_code,")"]})}),e.jsxs(A,{direction:"row",spacing:2,sx:{mt:1,flexWrap:"wrap",alignItems:"center"},children:[e.jsxs(m,{color:"text.secondary",variant:"caption",sx:{fontWeight:700},children:["Qty: ",o.quantity_requested]}),e.jsxs(m,{variant:"caption",children:["Unit Cost: ",N(o.unit_price)]}),e.jsxs(m,{variant:"caption",children:["Total Cost: ",N(o.total_cost)]}),e.jsxs(m,{variant:"caption",sx:{ml:.5,fontWeight:700},children:["Expected: ",o.expected_delivery_date?ze(o.expected_delivery_date):"-"]})]}),e.jsxs(V,{sx:{mt:1.2,height:12,borderRadius:999,overflow:"hidden",display:"flex",border:W=>`1px solid ${W.palette.divider}`,backgroundColor:W=>W.palette.action.hover},children:[e.jsx(V,{sx:{width:`${h}%`,height:"100%",bgcolor:"warning.main"}}),e.jsx(V,{sx:{width:`${p}%`,height:"100%",bgcolor:"info.main"}}),e.jsx(V,{sx:{width:`${_}%`,height:"100%",bgcolor:"success.main"}}),e.jsx(V,{sx:{width:`${Math.max(0,100-le)}%`,height:"100%",bgcolor:"transparent"}})]})]},s)})]})]})]})})}),y==="form"&&e.jsx(ro,{elevation:0,sx:{border:"none",borderRadius:0,backgroundColor:"transparent",boxShadow:"none"},children:e.jsxs(so,{children:[e.jsxs(A,{direction:"row",alignItems:"center",sx:{mb:1},children:[e.jsxs(m,{variant:"subtitle2",color:"text.secondary",children:["Step ",I+1," of ",R.length,": ",R[I]]}),e.jsx(V,{sx:{ml:"auto"},children:e.jsx(Ie,{size:"small",onClick:()=>$("list"),children:"Cancel"})})]}),e.jsx(ns,{variant:"dots",steps:R.length,position:"static",activeStep:I,sx:{background:"transparent",mb:1,p:0},nextButton:e.jsx("span",{}),backButton:e.jsx("span",{})}),e.jsxs(A,{spacing:2,children:[I===0&&e.jsxs(e.Fragment,{children:[e.jsx(m,{variant:"caption",color:"text.secondary",children:"Status*"}),e.jsx(A,{direction:"row",spacing:1,sx:{flexWrap:"wrap",gap:1},children:vo.map(o=>e.jsx(Ve,{label:o.label,color:d.site_execution_status===o.key?"primary":"default",variant:"outlined",size:"small",onClick:()=>U("site_execution_status",o.key),sx:{borderRadius:999}},o.key))}),e.jsx(ne,{label:"Site Supervisor ID",required:!0,fullWidth:!0,size:"small",placeholder:"Auto-filled from your account",helperText:"Prefilled with your user ID. You can change it if needed.",value:d.site_supervisor_id,onChange:o=>U("site_supervisor_id",o.target.value)}),e.jsx(ne,{label:"Work Completed",required:!0,fullWidth:!0,size:"small",multiline:!0,minRows:3,value:d.work_completed,onChange:o=>U("work_completed",o.target.value)}),e.jsx(ne,{label:"Manpower Utilized",required:!0,type:"number",fullWidth:!0,size:"small",value:d.manpower_utilized,onChange:o=>U("manpower_utilized",o.target.value)}),e.jsx(ne,{label:"Equipment Used",required:!0,fullWidth:!0,size:"small",multiline:!0,minRows:2,value:d.equipment_used,onChange:o=>U("equipment_used",o.target.value)}),e.jsx(ne,{label:"Weather Conditions",required:!0,fullWidth:!0,size:"small",value:d.weather_conditions,onChange:o=>U("weather_conditions",o.target.value)}),e.jsx(Kt,{options:we,getOptionLabel:o=>o!=null&&o.name?`${o.name}`:"",loading:We,value:we.find(o=>String(o.id)===String(d.milestone))||null,onChange:(o,s)=>U("milestone",(s==null?void 0:s.id)||""),isOptionEqualToValue:(o,s)=>String(o.id)===String(s.id),disabled:!u,renderInput:o=>e.jsx(ne,{...o,label:"Milestone",required:!0,size:"small",helperText:u?"":"Select a project to load milestones"})}),e.jsx(ne,{label:"Progress (%)",required:!0,type:"number",inputProps:{min:0,max:100},fullWidth:!0,size:"small",value:d.progress_percent,onChange:o=>U("progress_percent",o.target.value)})]}),I===1&&e.jsxs(e.Fragment,{children:[e.jsx(ne,{label:"Safety Compliance Report",required:!0,fullWidth:!0,size:"small",multiline:!0,minRows:3,value:d.safety_compliance_report,onChange:o=>U("safety_compliance_report",o.target.value)}),e.jsxs(A,{spacing:1,children:[e.jsxs(A,{direction:{xs:"column",sm:"row"},spacing:1,alignItems:{xs:"stretch",sm:"center"},children:[e.jsx(ne,{label:"Material Consumption (summary)",fullWidth:!0,size:"small",value:d.material_consumption,placeholder:"Click to select materials used",multiline:!0,minRows:2,InputProps:{readOnly:!0},onClick:G}),e.jsx(Ie,{variant:"outlined",onClick:G,children:"Select Materials"})]}),e.jsx(ne,{label:"Material Consumption Notes (optional)",fullWidth:!0,size:"small",value:L,onChange:o=>be(o.target.value),placeholder:"Add any extra notes regarding material consumption",multiline:!0,minRows:2})]}),e.jsx(ne,{label:"Site Issues (optional)",fullWidth:!0,size:"small",multiline:!0,minRows:2,value:d.site_issues,onChange:o=>U("site_issues",o.target.value)})]}),I===2&&e.jsxs(e.Fragment,{children:[e.jsxs(A,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Ie,{variant:"outlined",size:"small",startIcon:e.jsx(ps,{}),onClick:Ne,disabled:S.loading,children:S.loading?"Fetching Location…":"Enable Location"}),S.latitude&&S.longitude?e.jsx(m,{variant:"body2",color:"text.secondary",children:`Lat: ${Number(S.latitude).toFixed(6)}, Lng: ${Number(S.longitude).toFixed(6)}${S.accuracy?` (±${Math.round(S.accuracy)}m)`:""}`}):e.jsx(m,{variant:"body2",color:"text.secondary",children:"Location not available"})]}),S.error&&e.jsx(ao,{severity:"warning",variant:"outlined",children:S.error})]}),I===3&&e.jsxs(e.Fragment,{children:[ae&&e.jsxs(V,{sx:{borderRadius:2,overflow:"hidden"},children:[e.jsx(xo,{component:"img",image:ae,alt:"Photo evidence",sx:{maxHeight:420,objectFit:"contain",borderRadius:2,boxShadow:"none"}}),e.jsx(m,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:.5},children:"Location stamped on image when available."})]}),!ae&&e.jsx(m,{variant:"body2",color:"text.secondary",children:"Tap the camera button to capture a photo."})]}),I===4&&e.jsxs(e.Fragment,{children:[e.jsx(m,{variant:"subtitle2",children:"Review"}),e.jsxs(A,{spacing:.5,children:[e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Project:"})," ",u||"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Status:"})," ",d.site_execution_status]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Supervisor:"})," ",d.site_supervisor_id||"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Work:"})," ",d.work_completed||"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Manpower:"})," ",d.manpower_utilized||"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Equipment:"})," ",d.equipment_used||"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Weather:"})," ",d.weather_conditions||"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Safety:"})," ",d.safety_compliance_report||"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Materials:"})," ",d.material_consumption||"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Issues:"})," ",d.site_issues||"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Location:"})," ",S.latitude&&S.longitude?`${S.latitude}, ${S.longitude}`:"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Photo:"})," ",ae?"Attached":"Not attached"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Milestone:"})," ",(()=>{const o=we.find(s=>String(s.id)===String(d.milestone));return o?`${o.name} (#${o.id})`:"-"})()]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Progress:"})," ",d.progress_percent!==""?`${d.progress_percent}%`:"-"]})]})]}),e.jsxs(A,{direction:"row",spacing:1,sx:{pt:1},children:[e.jsx(Ie,{size:"small",disabled:I===0,onClick:()=>C(o=>Math.max(0,o-1)),children:"Back"}),I<R.length-1?e.jsx(Ie,{variant:"contained",size:"small",onClick:()=>C(o=>Math.min(R.length-1,o+1)),children:"Next"}):e.jsx(yt,{slug:Qt,action:"can_create",children:e.jsx(Ie,{variant:"contained",size:"small",onClick:pt,disabled:ve,children:ve?e.jsx(Lt,{size:18,sx:{color:"white"}}):"Submit"})})]})]})]})})]}),e.jsx("input",{ref:r,type:"file",accept:"image/*",capture:"user",onChange:et,style:{display:"none"}}),y==="list"?e.jsx(yt,{slug:Qt,action:"can_create",children:e.jsx(tr,{title:u?"Add today's report":"Select a project to add a report",placement:"left",children:e.jsx("span",{onClick:()=>{u||q({open:!0,severity:"info",message:"Select a project to add today's report"})},children:e.jsx(no,{color:"primary",onClick:()=>{u&&($("form"),C(0))},"aria-label":"add",disabled:!u,sx:{position:"fixed",right:16,bottom:16,boxShadow:1,backgroundColor:"primary.main",color:"primary.contrastText","&:hover":{backgroundColor:"primary.dark",boxShadow:2},"&.Mui-disabled":{backgroundColor:o=>o.palette.action.disabledBackground,color:o=>o.palette.action.disabled,boxShadow:"none"}},children:e.jsx(is,{})})})})}):I===3?e.jsx(yt,{slug:Qt,action:"can_create",children:e.jsx(no,{color:"primary",onClick:wt,"aria-label":"capture",sx:{position:"fixed",right:16,bottom:16,boxShadow:4,background:"linear-gradient(135deg, #7267ef 0%, #9a94ff 100%)"},children:e.jsx(ls,{})})}):null,e.jsx(Zo,{open:ce.open,autoHideDuration:3500,onClose:()=>q(o=>({...o,open:!1})),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(ao,{onClose:()=>q(o=>({...o,open:!1})),severity:ce.severity,variant:"filled",sx:{width:"100%"},children:ce.message})}),e.jsxs(zt,{open:Ce,onClose:dt,fullWidth:!0,maxWidth:"sm",children:[e.jsx(Tt,{sx:{p:0},children:P&&e.jsxs(V,{sx:{px:2,py:2,background:"linear-gradient(135deg, rgba(87,183,157,0.08) 0%, rgba(255,182,114,0.08) 100%)",borderBottom:o=>`1px solid ${o.palette.divider}`},children:[e.jsxs(A,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(as,{sx:{fontSize:16}}),e.jsx(m,{variant:"subtitle1",sx:{fontWeight:700},children:P.daily_progress_report_id||P.site_id}),e.jsx(V,{sx:{flex:1}}),e.jsx(Ve,{size:"small",label:(P.site_execution_status||"").replace(/\b\w/g,o=>o.toUpperCase()),color:"primary",variant:"outlined"})]}),e.jsx(A,{direction:"row",spacing:2,sx:{mt:.5},children:e.jsxs(A,{direction:"row",alignItems:"center",spacing:.5,children:[e.jsx(bo,{sx:{fontSize:16}}),e.jsxs(m,{variant:"caption",children:["Updated ",new Date(P.updated_at||P.created_at).toLocaleString()]})]})})]})}),e.jsx(Et,{dividers:!0,sx:{p:0},children:P?e.jsx(V,{sx:{p:2},children:e.jsxs(A,{spacing:2,children:[e.jsxs(V,{sx:{p:2,border:"1px solid",borderColor:"divider",borderRadius:2},children:[e.jsx(m,{variant:"overline",color:"text.secondary",children:"Overview"}),e.jsxs(ie,{container:!0,spacing:1.5,sx:{mt:.5},children:[e.jsx(ie,{item:!0,xs:12,sm:6,children:e.jsxs(A,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(ms,{sx:{fontSize:16}}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Supervisor:"})," ",P.site_supervisor_id]})]})}),e.jsx(ie,{item:!0,xs:12,sm:6,children:e.jsxs(A,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(cs,{sx:{fontSize:16}}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Project:"})," ",P.project]})]})}),e.jsx(ie,{item:!0,xs:12,sm:6,children:e.jsxs(A,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(yo,{sx:{fontSize:16}}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Milestone:"})," ",(()=>{const o=we.find(s=>String(s.id)===String(P.milestone));return o?`${o.name} (#${o.id})`:P.milestone?`#${P.milestone}`:"—"})()]})]})}),e.jsx(ie,{item:!0,xs:12,sm:6,children:e.jsxs(A,{spacing:.5,children:[e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Progress:"})," ",P.progress_percent!=null?`${P.progress_percent}%`:"—"]}),P.progress_percent!=null&&e.jsx(_o,{variant:"determinate",value:Number(P.progress_percent)||0})]})})]})]}),e.jsxs(V,{sx:{p:2,border:"1px solid",borderColor:"divider",borderRadius:2},children:[e.jsx(m,{variant:"overline",color:"text.secondary",children:"Work & Resources"}),e.jsx(Pt,{sx:{my:1}}),e.jsxs(ie,{container:!0,spacing:1.5,children:[e.jsx(ie,{item:!0,xs:12,children:e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Work Completed:"})," ",P.work_completed||"-"]})}),e.jsx(ie,{item:!0,xs:12,sm:6,children:e.jsxs(A,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(yo,{sx:{fontSize:16}}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Equipment:"})," ",P.equipment_used||"-"]})]})}),e.jsx(ie,{item:!0,xs:12,sm:6,children:e.jsxs(A,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(us,{sx:{fontSize:16}}),e.jsx(m,{variant:"body2",children:e.jsx("strong",{children:"Manpower:"})}),e.jsx(Ve,{size:"small",color:"secondary",variant:"outlined",label:`${P.manpower_utilized??"-"} people`})]})}),e.jsx(ie,{item:!0,xs:12,sm:6,children:e.jsxs(A,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(xs,{sx:{fontSize:16}}),e.jsx(m,{variant:"body2",children:e.jsx("strong",{children:"Weather:"})}),e.jsx(Ve,{size:"small",color:"info",variant:"outlined",label:P.weather_conditions||"-"})]})})]})]}),e.jsxs(V,{sx:{p:2,border:"1px solid",borderColor:"divider",borderRadius:2},children:[e.jsx(m,{variant:"overline",color:"text.secondary",children:"Safety & Materials"}),e.jsx(Pt,{sx:{my:1}}),e.jsxs(ie,{container:!0,spacing:1.5,children:[e.jsx(ie,{item:!0,xs:12,children:e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Safety:"})," ",P.safety_compliance_report||"-"]})}),e.jsx(ie,{item:!0,xs:12,children:e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Materials:"})," ",P.material_consumption||"-"]})}),!!P.site_issues&&e.jsx(ie,{item:!0,xs:12,children:e.jsxs(A,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(fs,{color:"warning",sx:{fontSize:16}}),e.jsxs(m,{variant:"body2",color:"error",children:[e.jsx("strong",{children:"Issues:"})," ",P.site_issues]})]})})]})]}),e.jsxs(V,{sx:{p:2,border:"1px solid",borderColor:"divider",borderRadius:2},children:[e.jsx(m,{variant:"overline",color:"text.secondary",children:"Location & System"}),e.jsx(Pt,{sx:{my:1}}),e.jsxs(ie,{container:!0,spacing:1.5,children:[e.jsx(ie,{item:!0,xs:12,sm:6,children:e.jsxs(A,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(hs,{sx:{fontSize:16}}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Location:"})," ",P.latitude&&P.longitude?`${P.latitude}, ${P.longitude}`:"—"]})]})}),e.jsx(ie,{item:!0,xs:12,sm:6,children:e.jsxs(A,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(bo,{sx:{fontSize:16}}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Location Time:"})," ",P.location_timestamp?new Date(P.location_timestamp).toLocaleString():"—"]})]})}),e.jsx(ie,{item:!0,xs:12,sm:6,children:e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Check-in:"})," ",P.checkin_time?new Date(P.checkin_time).toLocaleString():"—"]})}),e.jsx(ie,{item:!0,xs:12,sm:6,children:e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Check-out:"})," ",P.checkout_time?new Date(P.checkout_time).toLocaleString():"—"]})}),e.jsx(ie,{item:!0,xs:12,sm:6,children:e.jsxs(A,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(ds,{sx:{fontSize:16}}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Device:"})," ",P.device_id||"—"]})]})}),e.jsx(ie,{item:!0,xs:12,sm:6,children:e.jsxs(A,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(gs,{sx:{fontSize:16}}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"IP:"})," ",P.ip_address||"—"]})]})})]})]}),!!P.photo_evidence&&e.jsxs(V,{sx:{p:2,border:"1px solid",borderColor:"divider",borderRadius:2},children:[e.jsx(m,{variant:"overline",color:"text.secondary",children:"Photo Evidence"}),e.jsx(Pt,{sx:{my:1}}),e.jsx(xo,{component:"img",src:P.photo_evidence,alt:"Photo",sx:{borderRadius:1,maxHeight:360,objectFit:"contain"}})]})]})}):null}),e.jsx(Nt,{children:e.jsx(Ie,{onClick:dt,children:"Close"})})]}),e.jsxs(zt,{open:re,onClose:rt,fullWidth:!0,maxWidth:"sm",fullScreen:t,children:[e.jsx(Tt,{children:"Select Materials Used"}),e.jsx(Et,{dividers:!0,children:e.jsxs(A,{spacing:2,children:[e.jsx(m,{variant:"caption",color:"text.secondary",children:"Project"}),e.jsx(ne,{value:u||"",fullWidth:!0,size:"small",disabled:!0}),e.jsx(m,{variant:"caption",color:"text.secondary",children:"Add Item"}),e.jsx(Kt,{options:B,loading:Z,getOptionLabel:o=>o!=null&&o.item_name?`${o.item_id} - ${o.item_name}`:"",onChange:(o,s)=>Te(s),disablePortal:!0,renderInput:o=>e.jsx(ne,{...o,placeholder:"Search items",size:"small",fullWidth:!0})}),v.length>0&&e.jsx(A,{spacing:1,children:v.map(o=>e.jsxs(A,{direction:{xs:"column",sm:"row"},spacing:1,alignItems:{xs:"stretch",sm:"center"},sx:{p:1.25,border:"1px solid",borderColor:"divider",borderRadius:1},children:[e.jsxs(m,{sx:{flex:1},children:[o.item.item_id," - ",o.item.item_name]}),e.jsx(ne,{label:"Quantity Used",type:"number",size:"small",value:o.quantity,onChange:s=>Me(o.item.item_id,s.target.value),sx:{width:"100%"}}),e.jsx(Ie,{color:"error",onClick:()=>Ct(o.item.item_id),children:"Remove"})]},o.item.item_id))}),e.jsx(ne,{label:"Notes (optional)",size:"small",fullWidth:!0,value:L,onChange:o=>be(o.target.value),multiline:!0,minRows:2})]})}),e.jsxs(Nt,{children:[e.jsx(Ie,{onClick:rt,children:"Cancel"}),e.jsx(yt,{slug:"construction",action:"can_create",children:e.jsx(Ie,{variant:"contained",onClick:ct,disabled:je,children:je?e.jsx(Lt,{size:18,sx:{color:"white"}}):"Save Consumption"})})]})]}),e.jsxs(zt,{open:xe,onClose:Ze,fullWidth:!0,maxWidth:"sm",children:[e.jsx(Tt,{children:"Material Request Details"}),e.jsx(Et,{dividers:!0,children:de&&e.jsxs(A,{spacing:1.2,children:[e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Item:"})," ",de.material_name," (",de.material_code,")"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Quantity:"})," ",de.quantity_requested]}),e.jsxs(m,{variant:"body2",sx:{fontWeight:700},children:["Unit Cost: ",N(de.unit_price)]}),e.jsxs(m,{variant:"body2",sx:{fontWeight:700},children:["Total Cost: ",N(de.total_cost)]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Approval Status:"})," ",de.approval_status]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Payment Status:"})," ",de.payment_status]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Expected Delivery:"})," ",de.expected_delivery_date?ze(de.expected_delivery_date):"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Requested By:"})," ",de.requested_by||"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Request Date:"})," ",de.request_date?ze(de.request_date):"-"]})]})}),e.jsx(Nt,{children:e.jsx(Ie,{onClick:Ze,children:"Close"})})]}),e.jsxs(zt,{open:lt,onClose:he,fullWidth:!0,maxWidth:"sm",children:[e.jsx(Tt,{children:"Request Materials"}),e.jsx(Et,{dividers:!0,children:e.jsxs(A,{spacing:2,children:[e.jsx(m,{variant:"caption",color:"text.secondary",children:"Project"}),e.jsx(ne,{value:u||"",fullWidth:!0,size:"small",disabled:!0}),e.jsx(m,{variant:"caption",color:"text.secondary",children:"Item"}),e.jsx(Kt,{options:B,loading:Z,getOptionLabel:o=>o!=null&&o.item_name?`${o.item_name} (${o.item_id})`:"",value:oe.item,onChange:(o,s)=>Re(h=>({...h,item:s})),renderInput:o=>e.jsx(ne,{...o,placeholder:"Search items",size:"small"})}),e.jsxs(A,{direction:{xs:"column",sm:"row"},spacing:1,children:[e.jsx(ne,{label:"Quantity",type:"number",size:"small",fullWidth:!0,value:oe.quantity,onChange:o=>Re(s=>({...s,quantity:o.target.value}))}),e.jsx(ne,{label:"Unit Price (optional)",type:"number",size:"small",fullWidth:!0,value:oe.unit_price,onChange:o=>Re(s=>({...s,unit_price:o.target.value}))})]}),e.jsx(ne,{label:"Requested By",size:"small",fullWidth:!0,value:oe.requested_by,onChange:o=>Re(s=>({...s,requested_by:o.target.value}))})]})}),e.jsxs(Nt,{children:[e.jsx(Ie,{onClick:he,children:"Cancel"}),e.jsx(yt,{slug:"procurement",action:"can_create",children:e.jsx(Ie,{variant:"contained",onClick:Xe,children:"Submit Request"})})]})]})]})]})};export{Ns as default};
