import{r as a,j as e,T as p,z as w}from"./main-IxGEKZMA.js";import{C as z}from"./Close-DoqWsXz3.js";import{g as J}from"./engineering-BuN6Pdrr.js";import{g as W,d as K,u as V,c as X}from"./commision-C73dLlpE.js";import{G as r}from"./Grid-C72N-tAO.js";import{t as E,T as N,h as P,i as m,j as s,k as F,I as j,D as Z,f as ee,g as te,e as R}from"./TableRow-CRAT5KT_.js";import{A as se}from"./AddCircle-DWIRGPUh.js";import{T as re}from"./TableContainer-BaU58JEj.js";import{E as ne}from"./Edit-g2hjeeYC.js";import{D as ie}from"./Delete-cHl_EB0l.js";import{D as oe}from"./DialogActions-D5wP0Mt-.js";import"./Transition-C29ZPDdz.js";const De=()=>{const[f,B]=a.useState(""),[y,M]=a.useState(""),[k,u]=a.useState(!1),[D,T]=a.useState(""),[i,x]=a.useState({}),[b,C]=a.useState([]),[$,_]=a.useState(!1),[ae,S]=a.useState(null),[A,G]=a.useState([]),[h,v]=a.useState(null);a.useEffect(()=>{(async()=>{try{const n=await J();G(n)}catch(n){console.error("❌ Error fetching projects:",n)}})()},[]),a.useEffect(()=>{I()},[]);const I=async()=>{try{const t=await W();C(t)}catch(t){console.error("❌ Error fetching testing records:",t)}},q=t=>{T(t);const n=new Date().getFullYear(),o=(b.length+1).toString().padStart(3,"0");x({testingmanagementID:`TST-${n}-${o}`,projectId:t}),_(!1),S(null),u(!0)},L=t=>{x({testingmanagementID:t.testing_id,systemName:t.system_equipment_name,testingDate:t.testing_date,testingBy:t.test_conducted_by,testProcedure:t.test_procedure,performance:t.performance_parameters,defect:t.defects_identified,correction:t.correction_measures,retestDate:t.retest_date,testingStatus:t.testing_status}),v(t.testing_id),T(t.project_id),u(!0)},O=async t=>{var d,o;if(window.confirm(`Are you sure you want to delete the testing record with ID: ${t}?`))try{const l=await K(t);l.MSG?alert(`✅ ${l.MSG}
Deleted Testing ID: ${t}`):alert(`✅ Record deleted successfully!
Deleted Testing ID: ${t}`),C(Q=>Q.filter(Y=>Y.testing_id!==t))}catch(l){console.error("❌ Delete failed:",l),alert(`❌ Failed to delete Testing ID: ${t}
${((o=(d=l.response)==null?void 0:d.data)==null?void 0:o.MSG)||l.message||"Unknown error"}`)}},g=()=>{u(!1),x({}),_(!1),S(null)},c=t=>{const{name:n,value:d}=t.target;x(o=>({...o,[n]:d}))},H=async t=>{var n,d;t.preventDefault();try{const o={project_id:D,system_equipment_name:i.systemName,testing_date:i.testingDate,test_conducted_by:i.testingBy,test_procedure:i.testProcedure,performance_parameters:i.performance,defects_identified:i.defect||null,correction_measures:i.correction||null,retest_date:i.retestDate||null,testing_status:i.testingStatus};if(h){const l=await V(h,o);alert(`✅ Record updated successfully!
Updated Testing ID: ${h}`)}else{const l=await X(o);alert(`✅ Record created successfully!
Generated Testing ID: ${l.Data.testing_id}`)}I(),x({}),v(null),u(!1)}catch(o){console.error("❌ Error saving testing record:",o),alert(`❌ Error: ${((d=(n=o.response)==null?void 0:n.data)==null?void 0:d.MSG)||o.message||"Something went wrong"}`)}},U=b.filter(t=>Object.values(t).some(n=>n&&n.toString().toLowerCase().includes(y.toLowerCase())));return e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"h5",gutterBottom:!0,sx:{mt:5},children:"Testing & Inspection"}),e.jsx(r,{container:!0,spacing:2,direction:"column",sx:{mb:2},children:e.jsx(r,{item:!0,xs:12,children:e.jsxs(E,{sx:{p:2,backgroundColor:"#fff",border:"1px solid #ccc"},children:[e.jsx(p,{variant:"h6",gutterBottom:!0,children:"PROJECT RECORDS"}),e.jsx(w,{sx:{my:2,mx:1},children:e.jsx("input",{type:"text",placeholder:"Search Project ID",value:f,onChange:t=>B(t.target.value),className:"input",style:{width:"100%",padding:"8px",border:"1px solid #ccc",borderRadius:4}})}),e.jsxs(N,{children:[e.jsx(P,{children:e.jsxs(m,{children:[e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project ID"})}),e.jsx(s,{sx:{display:"flex",justifyContent:"flex-end",color:"#660000"},children:e.jsx("strong",{children:"Action"})})]})}),e.jsx(F,{children:A.filter(t=>{var n;return(n=t.id)==null?void 0:n.toString().toLowerCase().includes(f.toLowerCase())}).map((t,n)=>e.jsxs(m,{children:[e.jsx(s,{children:t.project_id}),e.jsx(s,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(j,{onClick:()=>q(t.project_id),color:"primary",children:e.jsx(se,{sx:{color:"#7267ef"}})})})]},n))})]})]})})}),e.jsx(r,{container:!0,spacing:2,children:e.jsx(r,{item:!0,xs:12,children:e.jsxs(E,{sx:{p:2,backgroundColor:"#fff",border:"1px solid #ccc"},children:[e.jsx(p,{variant:"h6",gutterBottom:!0,children:"TESTING MANAGEMENT DETAILS"}),e.jsx("input",{type:"text",placeholder:"Search Testing Management",value:y,onChange:t=>M(t.target.value),className:"input",style:{width:"100%",padding:"8px",border:"1px solid #ccc",borderRadius:4,marginBottom:"16px"}}),e.jsx(re,{sx:{maxHeight:400,overflow:"auto",border:"1px solid #ddd"},children:e.jsxs(N,{stickyHeader:!0,children:[e.jsx(P,{children:e.jsxs(m,{children:[e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project ID"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Testing ID"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Equipment Name"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Testing Date"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Testing ConductedBy"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Test Procedure"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Performane Parameters"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Defects Identified"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Corrective Measures"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Retest Date"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Testing Date"})}),e.jsx(s,{sx:{color:"#660000"},children:e.jsx("strong",{children:"Actions"})})]})}),e.jsx(F,{children:U.map((t,n)=>e.jsxs(m,{children:[e.jsx(s,{children:t.project_id}),e.jsx(s,{children:t.testing_id}),e.jsx(s,{children:t.system_equipment_name}),e.jsx(s,{children:t.testing_date}),e.jsx(s,{children:t.test_conducted_by}),e.jsx(s,{children:t.test_procedure}),e.jsx(s,{children:t.performance_parameters}),e.jsx(s,{children:t.defects_identified}),e.jsx(s,{children:t.correction_measures}),e.jsx(s,{children:t.retest_date||"-"}),e.jsx(s,{children:t.testing_status}),e.jsxs(s,{children:[e.jsx(j,{onClick:()=>L(t),color:"warning",children:e.jsx(ne,{sx:{color:"orange"}})}),e.jsx(j,{onClick:()=>O(t.testing_id),color:"error",children:e.jsx(ie,{sx:{color:"red"}})})]})]},n))})]})})]})})}),e.jsxs(Z,{open:k,onClose:g,fullWidth:!0,children:[e.jsx(ee,{children:$?"Edit Testing Management Details":"Enter Testing Management Details"}),e.jsxs(te,{sx:{position:"relative"},children:[e.jsx(j,{"aria-label":"close",onClick:g,sx:{position:"absolute",right:8,top:8,color:t=>t.palette.grey[500]},children:e.jsx(z,{})}),e.jsx(w,{component:"form",sx:{mt:2},children:e.jsxs(r,{container:!0,spacing:3,direction:"column",children:[e.jsxs(r,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Project Information"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(r,{container:!0,spacing:2,children:[e.jsxs(r,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"projectId",children:"Project ID"}),e.jsx("input",{id:"projectId",className:"input",value:D,disabled:!0})]}),e.jsxs(r,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"testingmanagementID",children:"Testing ID"}),e.jsx("input",{id:"testingmanagementID",className:"input",value:i.testingmanagementID||"",disabled:!0})]})]})]}),e.jsxs(r,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Testing & Equipment Information"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(r,{container:!0,spacing:2,children:[e.jsxs(r,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"systemName",children:"System/Equipment Name"}),e.jsx("input",{id:"systemName",name:"systemName",className:"input",value:i.systemName||"",onChange:c})]}),e.jsxs(r,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"testingDate",children:"Testing Date"}),e.jsx("input",{type:"date",id:"testingDate",name:"testingDate",className:"input",value:i.testingDate||"",onChange:c})]}),e.jsxs(r,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"testingBy",children:"Testing CoductedBy"}),e.jsx("input",{id:"testingBy",name:"testingBy",className:"input",value:i.testingBy||"",onChange:c})]}),e.jsxs(r,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"testProcedure",children:"Test Procedure"}),e.jsx("input",{id:"testProcedure",name:"testProcedure",className:"input",value:i.testProcedure||"",onChange:c})]}),e.jsxs(r,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"performance",children:"Performance Parameters"}),e.jsx("input",{id:"performance",name:"performance",className:"input",value:i.performance||"",onChange:c})]}),e.jsxs(r,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"defect",children:"Defects Identified"}),e.jsx("input",{id:"defect",name:"defect",className:"input",value:i.defect||"",onChange:c})]})]}),e.jsxs(r,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Correction Measure & Testing Status"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(r,{container:!0,spacing:2,children:[e.jsxs(r,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"correction",children:"Correction Measure"}),e.jsx("input",{id:"correction",name:"correction",className:"input",value:i.correction||"",onChange:c})]}),e.jsxs(r,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"retestDate",children:"Retest Date"}),e.jsx("input",{type:"date",id:"retestDate",name:"retestDate",className:"input",value:i.retestDate||"",onChange:c})]}),e.jsxs(r,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"testingStatus",children:"Testing Status"}),e.jsxs("select",{id:"testingStatus",name:"testingStatus",className:"input",value:i.testingStatus||"",onChange:c,children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"Passed",children:"Passed"}),e.jsx("option",{value:"Failed",children:"Failed"}),e.jsx("option",{value:"Retest Required",children:"Retest Required"})]})]})]})]})]})]})})]}),e.jsxs(oe,{children:[e.jsx(R,{onClick:g,sx:{outline:"2px solid #800000",color:"#800000","&:hover":{outline:"2px solid #b30000",color:"#b30000"}},children:"Cancel"}),e.jsx(R,{variant:"outlined",onClick:H,sx:{borderColor:"#7267ef",color:"#7267ef","&:hover":{borderColor:"#9e8df2",color:"#9e8df2"}},children:h?"Update":"Submit"})]})]})]})};export{De as default};
