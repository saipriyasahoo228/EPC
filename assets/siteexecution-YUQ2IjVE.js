import{r as n,k as Pe,i as De,m as ye,j as e,o as ae,n as J,t as ve,y as dt,V as St,L as ut,W as $t,X as et,Y as It,A as $e,q as K,w as Ce,J as Be,Z as pt,x as Rt,v as xt,_ as q,$ as Tt,a0 as Bt,O as ht,E as ge,T as D,S as Fe,I as Ie,G as Pt,K as se}from"./main-Skim5IJC.js";import{C as Dt}from"./Close-BKZ7QrSY.js";import{g as Et}from"./engineering-BJ3wTiKO.js";import{i as zt,j as Re,k as Lt,l as Wt,m as Ot}from"./construction-CMO2W9OH.js";import{u as Mt}from"./index-CV0T-gUl.js";import{G as d}from"./Grid-fY_ATwTx.js";import{C as ie}from"./Chip-DTcaVcsg.js";import{T as E}from"./TextField-D43kg6c3.js";import{I as tt}from"./InputAdornment-DEk4gwZf.js";import{T as rt,a as st,b as je,c as f,d as ot}from"./TableRow-B6k_bSOs.js";import{T as oe}from"./Tooltip-YrZkw7B4.js";import{A as at}from"./AddCircle-CJp4DZj3.js";import{S as be,C as At,a as Ft,F as Nt}from"./Stack-BGApbFiI.js";import{T as Ut}from"./TableContainer-gCCy6yK7.js";import{E as Ne}from"./Edit-6vcT2Cu4.js";import{D as Ue}from"./Delete-Be1vvbhC.js";import{o as ft,M as Gt,B as F,D as Ge,a as He,b as qe,c as Ve}from"./DialogTitle-CvDFHAwp.js";import{u as Ht}from"./index-Pp9EW3wT.js";import{m as qt}from"./useFormControl-C6hS7-Rn.js";import{d as Vt}from"./useSlotProps-CCL6Y0ZK.js";import{L as Ye,g as Yt,a as Qt}from"./Select-BThNtn2k.js";import{g as Xt,l as _e,L as ne}from"./ListItemText-DGUSFsAP.js";import{D as it}from"./Divider-mutym74u.js";import"./useControlled-CHkDrNg3.js";function Zt(t){return n.Children.toArray(t).filter(s=>n.isValidElement(s))}function Jt(t){return Pe("MuiCardActions",t)}De("MuiCardActions",["root","spacing"]);const Kt=t=>{const{classes:s,disableSpacing:a}=t;return ve({root:["root",!a&&"spacing"]},Jt,s)},er=ae("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.root,!a.disableSpacing&&s.spacing]}})({display:"flex",alignItems:"center",padding:8,variants:[{props:{disableSpacing:!1},style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),tr=n.forwardRef(function(s,a){const l=ye({props:s,name:"MuiCardActions"}),{disableSpacing:p=!1,className:b,...g}=l,m={...l,disableSpacing:p},y=Kt(m);return e.jsx(er,{className:J(y.root,b),ownerState:m,ref:a,...g})});function rr(t,s,a){const l=s.getBoundingClientRect(),p=a&&a.getBoundingClientRect(),b=ft(s);let g;if(s.fakeTransform)g=s.fakeTransform;else{const j=b.getComputedStyle(s);g=j.getPropertyValue("-webkit-transform")||j.getPropertyValue("transform")}let m=0,y=0;if(g&&g!=="none"&&typeof g=="string"){const j=g.split("(")[1].split(")")[0].split(",");m=parseInt(j[4],10),y=parseInt(j[5],10)}return t==="left"?p?`translateX(${p.right+m-l.left}px)`:`translateX(${b.innerWidth+m-l.left}px)`:t==="right"?p?`translateX(-${l.right-p.left-m}px)`:`translateX(-${l.left+l.width-m}px)`:t==="up"?p?`translateY(${p.bottom+y-l.top}px)`:`translateY(${b.innerHeight+y-l.top}px)`:p?`translateY(-${l.top-p.top+l.height-y}px)`:`translateY(-${l.top+l.height-y}px)`}function sr(t){return typeof t=="function"?t():t}function Te(t,s,a){const l=sr(a),p=rr(t,s,l);p&&(s.style.webkitTransform=p,s.style.transform=p)}const or=n.forwardRef(function(s,a){const l=dt(),p={enter:l.transitions.easing.easeOut,exit:l.transitions.easing.sharp},b={enter:l.transitions.duration.enteringScreen,exit:l.transitions.duration.leavingScreen},{addEndListener:g,appear:m=!0,children:y,container:j,direction:_="down",easing:h=p,in:I,onEnter:R,onEntered:O,onEntering:M,onExit:B,onExited:S,onExiting:T,style:z,timeout:A=b,TransitionComponent:N=St,...Y}=s,v=n.useRef(null),k=ut($t(y),v,a),W=x=>P=>{x&&(P===void 0?x(v.current):x(v.current,P))},U=W((x,P)=>{Te(_,x,j),It(x),R&&R(x,P)}),ue=W((x,P)=>{const G=et({timeout:A,style:z,easing:h},{mode:"enter"});x.style.webkitTransition=l.transitions.create("-webkit-transform",{...G}),x.style.transition=l.transitions.create("transform",{...G}),x.style.webkitTransform="none",x.style.transform="none",M&&M(x,P)}),L=W(O),Q=W(T),V=W(x=>{const P=et({timeout:A,style:z,easing:h},{mode:"exit"});x.style.webkitTransition=l.transitions.create("-webkit-transform",P),x.style.transition=l.transitions.create("transform",P),Te(_,x,j),B&&B(x)}),C=W(x=>{x.style.webkitTransition="",x.style.transition="",S&&S(x)}),ee=x=>{g&&g(v.current,x)},pe=n.useCallback(()=>{v.current&&Te(_,v.current,j)},[_,j]);return n.useEffect(()=>{if(I||_==="down"||_==="right")return;const x=Vt(()=>{v.current&&Te(_,v.current,j)}),P=ft(v.current);return P.addEventListener("resize",x),()=>{x.clear(),P.removeEventListener("resize",x)}},[_,I,j]),n.useEffect(()=>{I||pe()},[I,pe]),e.jsx(N,{nodeRef:v,onEnter:U,onEntered:L,onEntering:ue,onExit:V,onExited:C,onExiting:Q,addEndListener:ee,appear:m,in:I,timeout:A,...Y,children:(x,{ownerState:P,...G})=>n.cloneElement(y,{ref:k,style:{visibility:x==="exited"&&!I?"hidden":void 0,...z,...y.props.style},...G})})});function ar(t){return Pe("MuiDrawer",t)}De("MuiDrawer",["root","docked","paper","anchorLeft","anchorRight","anchorTop","anchorBottom","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const mt=(t,s)=>{const{ownerState:a}=t;return[s.root,(a.variant==="permanent"||a.variant==="persistent")&&s.docked,s.modal]},ir=t=>{const{classes:s,anchor:a,variant:l}=t,p={root:["root",`anchor${K(a)}`],docked:[(l==="permanent"||l==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${K(a)}`,l!=="temporary"&&`paperAnchorDocked${K(a)}`]};return ve(p,ar,s)},nr=ae(Gt,{name:"MuiDrawer",slot:"Root",overridesResolver:mt})(Ce(({theme:t})=>({zIndex:(t.vars||t).zIndex.drawer}))),lr=ae("div",{shouldForwardProp:pt,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:mt})({flex:"0 0 auto"}),cr=ae(Be,{name:"MuiDrawer",slot:"Paper",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.paper,s[`paperAnchor${K(a.anchor)}`],a.variant!=="temporary"&&s[`paperAnchorDocked${K(a.anchor)}`]]}})(Ce(({theme:t})=>({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(t.vars||t).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0,variants:[{props:{anchor:"left"},style:{left:0}},{props:{anchor:"top"},style:{top:0,left:0,right:0,height:"auto",maxHeight:"100%"}},{props:{anchor:"right"},style:{right:0}},{props:{anchor:"bottom"},style:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"}},{props:({ownerState:s})=>s.anchor==="left"&&s.variant!=="temporary",style:{borderRight:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:s})=>s.anchor==="top"&&s.variant!=="temporary",style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:s})=>s.anchor==="right"&&s.variant!=="temporary",style:{borderLeft:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:s})=>s.anchor==="bottom"&&s.variant!=="temporary",style:{borderTop:`1px solid ${(t.vars||t).palette.divider}`}}]}))),gt={left:"right",right:"left",top:"down",bottom:"up"};function dr(t){return["left","right"].includes(t)}function ur({direction:t},s){return t==="rtl"&&dr(s)?gt[s]:s}const pr=n.forwardRef(function(s,a){const l=ye({props:s,name:"MuiDrawer"}),p=dt(),b=Ht(),g={enter:p.transitions.duration.enteringScreen,exit:p.transitions.duration.leavingScreen},{anchor:m="left",BackdropProps:y,children:j,className:_,elevation:h=16,hideBackdrop:I=!1,ModalProps:{BackdropProps:R,...O}={},onClose:M,open:B=!1,PaperProps:S={},SlideProps:T,TransitionComponent:z,transitionDuration:A=g,variant:N="temporary",slots:Y={},slotProps:v={},...k}=l,W=n.useRef(!1);n.useEffect(()=>{W.current=!0},[]);const U=ur({direction:b?"rtl":"ltr"},m),L={...l,anchor:m,elevation:h,open:B,variant:N,...k},Q=ir(L),V={slots:{transition:z,...Y},slotProps:{paper:S,transition:T,...v,backdrop:qt(v.backdrop||{...y,...R},{transitionDuration:A})}},[C,ee]=$e("root",{ref:a,elementType:nr,className:J(Q.root,Q.modal,_),shouldForwardComponentProp:!0,ownerState:L,externalForwardedProps:{...V,...k,...O},additionalProps:{open:B,onClose:M,hideBackdrop:I,slots:{backdrop:V.slots.backdrop},slotProps:{backdrop:V.slotProps.backdrop}}}),[pe,x]=$e("paper",{elementType:cr,shouldForwardComponentProp:!0,className:J(Q.paper,S.className),ownerState:L,externalForwardedProps:V,additionalProps:{elevation:N==="temporary"?h:0,square:!0}}),[P,G]=$e("docked",{elementType:lr,ref:a,className:J(Q.root,Q.docked,_),ownerState:L,externalForwardedProps:V,additionalProps:k}),[Ee,te]=$e("transition",{elementType:or,ownerState:L,externalForwardedProps:V,additionalProps:{in:B,direction:gt[U],timeout:A,appear:W.current}}),xe=e.jsx(pe,{...x,children:j});if(N==="permanent")return e.jsx(P,{...G,children:xe});const he=e.jsx(Ee,{...te,children:xe});return N==="persistent"?e.jsx(P,{...G,children:he}):e.jsx(C,{...ee,children:he})}),xr=(t,s)=>{const{ownerState:a}=t;return[s.root,a.dense&&s.dense,a.alignItems==="flex-start"&&s.alignItemsFlexStart,a.divider&&s.divider,!a.disableGutters&&s.gutters]},hr=t=>{const{alignItems:s,classes:a,dense:l,disabled:p,disableGutters:b,divider:g,selected:m}=t,j=ve({root:["root",l&&"dense",!b&&"gutters",g&&"divider",p&&"disabled",s==="flex-start"&&"alignItemsFlexStart",m&&"selected"]},Xt,a);return{...a,...j}},fr=ae(xt,{shouldForwardProp:t=>pt(t)||t==="classes",name:"MuiListItemButton",slot:"Root",overridesResolver:xr})(Ce(({theme:t})=>({display:"flex",flexGrow:1,justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minWidth:0,boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${_e.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:q(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${_e.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:q(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`&.${_e.selected}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:q(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:q(t.palette.primary.main,t.palette.action.selectedOpacity)}},[`&.${_e.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${_e.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},variants:[{props:({ownerState:s})=>s.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:s})=>!s.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:s})=>s.dense,style:{paddingTop:4,paddingBottom:4}}]}))),le=n.forwardRef(function(s,a){const l=ye({props:s,name:"MuiListItemButton"}),{alignItems:p="center",autoFocus:b=!1,component:g="div",children:m,dense:y=!1,disableGutters:j=!1,divider:_=!1,focusVisibleClassName:h,selected:I=!1,className:R,...O}=l,M=n.useContext(Ye),B=n.useMemo(()=>({dense:y||M.dense||!1,alignItems:p,disableGutters:j}),[p,M.dense,y,j]),S=n.useRef(null);Rt(()=>{b&&S.current&&S.current.focus()},[b]);const T={...l,alignItems:p,dense:B.dense,disableGutters:j,divider:_,selected:I},z=hr(T),A=ut(S,a);return e.jsx(Ye.Provider,{value:B,children:e.jsx(fr,{ref:A,href:O.href||O.to,component:(O.href||O.to)&&g==="div"?"button":g,focusVisibleClassName:J(z.focusVisible,h),ownerState:T,className:J(z.root,R),...O,classes:z,children:m})})}),mr=t=>{const{alignItems:s,classes:a}=t;return ve({root:["root",s==="flex-start"&&"alignItemsFlexStart"]},Yt,a)},gr=ae("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.root,a.alignItems==="flex-start"&&s.alignItemsFlexStart]}})(Ce(({theme:t})=>({minWidth:56,color:(t.vars||t).palette.action.active,flexShrink:0,display:"inline-flex",variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}))),ce=n.forwardRef(function(s,a){const l=ye({props:s,name:"MuiListItemIcon"}),{className:p,...b}=l,g=n.useContext(Ye),m={...l,alignItems:g.alignItems},y=mr(m);return e.jsx(gr,{className:J(y.root,p),ownerState:m,ref:a,...b})});function jr(t){return Pe("MuiToggleButton",t)}const de=De("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge","fullWidth"]),jt=n.createContext({}),bt=n.createContext(void 0);function br(t,s){return s===void 0||t===void 0?!1:Array.isArray(s)?s.includes(t):t===s}const yr=t=>{const{classes:s,fullWidth:a,selected:l,disabled:p,size:b,color:g}=t,m={root:["root",l&&"selected",p&&"disabled",a&&"fullWidth",`size${K(b)}`,g]};return ve(m,jr,s)},vr=ae(xt,{name:"MuiToggleButton",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[s.root,s[`size${K(a.size)}`]]}})(Ce(({theme:t})=>({...t.typography.button,borderRadius:(t.vars||t).shape.borderRadius,padding:11,border:`1px solid ${(t.vars||t).palette.divider}`,color:(t.vars||t).palette.action.active,[`&.${de.disabled}`]:{color:(t.vars||t).palette.action.disabled,border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:q(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[{props:{color:"standard"},style:{[`&.${de.selected}`]:{color:(t.vars||t).palette.text.primary,backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.selectedOpacity})`:q(t.palette.text.primary,t.palette.action.selectedOpacity),"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:q(t.palette.text.primary,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.selectedOpacity})`:q(t.palette.text.primary,t.palette.action.selectedOpacity)}}}}},...Object.entries(t.palette).filter(Bt()).map(([s])=>({props:{color:s},style:{[`&.${de.selected}`]:{color:(t.vars||t).palette[s].main,backgroundColor:t.vars?`rgba(${t.vars.palette[s].mainChannel} / ${t.vars.palette.action.selectedOpacity})`:q(t.palette[s].main,t.palette.action.selectedOpacity),"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette[s].mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:q(t.palette[s].main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette[s].mainChannel} / ${t.vars.palette.action.selectedOpacity})`:q(t.palette[s].main,t.palette.action.selectedOpacity)}}}}})),{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{padding:7,fontSize:t.typography.pxToRem(13)}},{props:{size:"large"},style:{padding:15,fontSize:t.typography.pxToRem(15)}}]}))),nt=n.forwardRef(function(s,a){const{value:l,...p}=n.useContext(jt),b=n.useContext(bt),g=Tt({...p,selected:br(s.value,l)},s),m=ye({props:g,name:"MuiToggleButton"}),{children:y,className:j,color:_="standard",disabled:h=!1,disableFocusRipple:I=!1,fullWidth:R=!1,onChange:O,onClick:M,selected:B,size:S="medium",value:T,...z}=m,A={...m,color:_,disabled:h,disableFocusRipple:I,fullWidth:R,size:S},N=yr(A),Y=k=>{M&&(M(k,T),k.defaultPrevented)||O&&O(k,T)},v=b||"";return e.jsx(vr,{className:J(p.className,N.root,j,v),disabled:h,focusRipple:!I,ref:a,onClick:Y,onChange:O,value:T,ownerState:A,"aria-pressed":B,...z,children:y})});function Cr(t){return Pe("MuiToggleButtonGroup",t)}const w=De("MuiToggleButtonGroup",["root","selected","horizontal","vertical","disabled","grouped","groupedHorizontal","groupedVertical","fullWidth","firstButton","lastButton","middleButton"]),_r=t=>{const{classes:s,orientation:a,fullWidth:l,disabled:p}=t,b={root:["root",a,l&&"fullWidth"],grouped:["grouped",`grouped${K(a)}`,p&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return ve(b,Cr,s)},kr=ae("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:a}=t;return[{[`& .${w.grouped}`]:s.grouped},{[`& .${w.grouped}`]:s[`grouped${K(a.orientation)}`]},{[`& .${w.firstButton}`]:s.firstButton},{[`& .${w.lastButton}`]:s.lastButton},{[`& .${w.middleButton}`]:s.middleButton},s.root,a.orientation==="vertical"&&s.vertical,a.fullWidth&&s.fullWidth]}})(Ce(({theme:t})=>({display:"inline-flex",borderRadius:(t.vars||t).shape.borderRadius,variants:[{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${w.grouped}`]:{[`&.${w.selected} + .${w.grouped}.${w.selected}`]:{borderTop:0,marginTop:0}},[`& .${w.firstButton},& .${w.middleButton}`]:{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`& .${w.lastButton},& .${w.middleButton}`]:{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},[`& .${w.lastButton}.${de.disabled},& .${w.middleButton}.${de.disabled}`]:{borderTop:"1px solid transparent"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"horizontal"},style:{[`& .${w.grouped}`]:{[`&.${w.selected} + .${w.grouped}.${w.selected}`]:{borderLeft:0,marginLeft:0}},[`& .${w.firstButton},& .${w.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${w.lastButton},& .${w.middleButton}`]:{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},[`& .${w.lastButton}.${de.disabled},& .${w.middleButton}.${de.disabled}`]:{borderLeft:"1px solid transparent"}}}]}))),wr=n.forwardRef(function(s,a){const l=ye({props:s,name:"MuiToggleButtonGroup"}),{children:p,className:b,color:g="standard",disabled:m=!1,exclusive:y=!1,fullWidth:j=!1,onChange:_,orientation:h="horizontal",size:I="medium",value:R,...O}=l,M={...l,disabled:m,fullWidth:j,orientation:h,size:I},B=_r(M),S=n.useCallback((v,k)=>{if(!_)return;const W=R&&R.indexOf(k);let U;R&&W>=0?(U=R.slice(),U.splice(W,1)):U=R?R.concat(k):[k],_(v,U)},[_,R]),T=n.useCallback((v,k)=>{_&&_(v,R===k?null:k)},[_,R]),z=n.useMemo(()=>({className:B.grouped,onChange:y?T:S,value:R,size:I,fullWidth:j,color:g,disabled:m}),[B.grouped,y,T,S,R,I,j,g,m]),A=Zt(p),N=A.length,Y=v=>{const k=v===0,W=v===N-1;return k&&W?"":k?B.firstButton:W?B.lastButton:B.middleButton};return e.jsx(kr,{role:"group",className:J(B.root,b),ref:a,ownerState:M,...O,children:e.jsx(jt.Provider,{value:z,children:A.map((v,k)=>e.jsx(bt.Provider,{value:Y(k),children:v},k))})})}),lt=ht(e.jsx("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"})),ct=ht(e.jsx("path",{d:"M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2M1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2"})),Xr=()=>{const t="construction",[s,a]=n.useState(1),[l,p]=n.useState(""),[b,g]=n.useState(""),[m,y]=n.useState(!1),[j,_]=n.useState(""),[h,I]=n.useState({}),[R,O]=n.useState([]),[M,B]=n.useState([]),[S,T]=n.useState([]),[z,A]=n.useState("all"),[N,Y]=n.useState("cards"),[v,k]=n.useState(!1),[W,U]=n.useState(null),[ue,L]=n.useState([{labour_resource:"",number_of_workers:"",work_hours:"",date:""}]),[Q,V]=n.useState([]),[C,ee]=n.useState(null),[pe,x]=n.useState(!1),[P,G]=n.useState(""),[Ee,te]=n.useState(!1),[xe,he]=n.useState(""),[ze,Le]=n.useState(""),Qe=Mt("(max-width:600px)"),[yt,X]=n.useState(!1),[$,vt]=n.useState(null),Ct=r=>{vt(r),X(!0)};n.useEffect(()=>{(async()=>{try{const o=await Et();B(o??[])}catch(o){console.error("Error fetching projects:",o)}})()},[]);const We=async()=>{try{k(!0);const r=await Lt();T(Array.isArray(r)?r:[])}catch(r){console.error("❌ Failed to fetch site executions:",r)}finally{k(!1)}};n.useEffect(()=>{We()},[]),n.useEffect(()=>{(async()=>{try{const r=await zt();V(Array.isArray(r)?r:[]),console.log("DEBUG labour resources sample:",Array.isArray(r)&&r[0]||r)}catch(r){console.error("Failed to load labour resources",r)}})()},[]);const Xe=r=>{_(r);const o=new Date().getFullYear(),c=S.filter(Ae=>{var me;return(me=Ae.site_id)==null?void 0:me.startsWith(`SIT-${o}-`)});let u=0;c.length>0&&c.forEach(Ae=>{var Je;const me=(Je=Ae.site_id)==null?void 0:Je.split("-");if(me&&me.length===3){const Ke=parseInt(me[2]);Ke>u&&(u=Ke)}});const i=u+1,H=String(i).padStart(4,"0");I({siteId:`SIT-${o}-${H}`,project:r}),L([{labour_resource:"",number_of_workers:"",work_hours:"",date:""}]),y(!0)},ke=()=>{y(!1),L([{labour_resource:"",number_of_workers:"",work_hours:"",date:""}])},Z=r=>{const{name:o,value:c}=r.target;I(u=>({...u,[o]:c}))},_t=async()=>{try{const r={project:j,site_supervisor_id:h.siteSupervisorID,daily_progress_report_id:h.dailyProgressReportID,work_completed:h.workCompleted,equipment_used:h.equipmentUsed,weather_conditions:h.wetherCondition,safety_compliance_report:h.safetyCompliance,material_consumption:h.materialConsumption,site_issues:h.siteIssues,site_execution_status:h.siteStatus||"on track",labour_usage_input:(ue||[]).filter(o=>o&&o.labour_resource&&o.number_of_workers&&o.work_hours&&o.date).map(o=>{const c=String(o.date);let u=c;return c.endsWith("Z")||(u=c.length===16?`${c}:00Z`:`${c}Z`),{labour_resource:Number(o.labour_resource),number_of_workers:Number(o.number_of_workers),work_hours:Number(o.work_hours),date:u}})};if(console.log("DEBUG SiteExecution payload:",r),W)await Re(W,r),alert("✅ Site Execution updated successfully!");else{const o=await Ot(r);alert(`✅ Site Execution saved!
Site ID: ${o.site_id}`)}I({}),L([{labour_resource:"",number_of_workers:"",work_hours:"",date:""}]),U(null),ke(),We()}catch(r){if(console.error("❌ Failed to save site execution:",r),r.response&&r.response.data){const o=r.response.data.detail||JSON.stringify(r.response.data);alert(`❌ Error: ${o}`)}else alert("❌ An unexpected error occurred. Please try again.")}},Oe=async r=>{if(window.confirm(`Are you sure you want to delete this site execution with siteId: ${r}?`))try{await Wt(r),alert(`✅ Site execution with siteID: ${r} deleted successfully!`),We()}catch(o){console.error("❌ Failed to delete site execution:",o),alert("❌ Failed to delete site execution. Please try again.")}},Me=r=>{I({siteId:r.site_id,siteSupervisorID:r.site_supervisor_id,dailyProgressReportID:r.daily_progress_report_id,workCompleted:r.work_completed,equipmentUsed:r.equipment_used,wetherCondition:r.weather_conditions,safetyCompliance:r.safety_compliance_report,materialConsumption:r.material_consumption,siteIssues:r.site_issues,siteStatus:r.site_execution_status});try{const o=Array.isArray(r.labour_usage)?r.labour_usage.map(c=>{const u=c.date||"";let i=u;return typeof u=="string"&&u&&(i=u.replace("Z","").slice(0,16)),{labour_resource:c.labour_resource||"",number_of_workers:c.number_of_workers||"",work_hours:c.work_hours||"",date:i}}):[];L(o.length?o:[{labour_resource:"",number_of_workers:"",work_hours:"",date:""}])}catch{L([{labour_resource:"",number_of_workers:"",work_hours:"",date:""}])}_(r.project),U(r.site_id),y(!0)},fe=async(r,o)=>{const c=[...S];T(u=>u.map(i=>i.site_id===r.site_id?{...i,site_execution_status:o}:i));try{await Re(r.site_id,{site_execution_status:o})}catch(u){console.error("Failed to update status",u),T(c),alert("Failed to update status. Please try again.")}},we=n.useMemo(()=>(M||[]).filter(r=>Object.values(r).some(o=>o&&o.toString().toLowerCase().includes(l.toLowerCase()))),[M,l]),re=n.useMemo(()=>{const r=S.length,o=S.reduce((c,u)=>{const i=(u.site_execution_status||"").toLowerCase();return c[i]=(c[i]||0)+1,c},{});return{total:r,onTrack:o["on track"]||0,delayed:o.delayed||0,halted:o.halted||0}},[S]),Ze=r=>typeof r=="string"?r.replace(/\w\S*/g,o=>o.charAt(0).toUpperCase()+o.slice(1).toLowerCase()):r,kt=r=>{if(!r)return"-";const o=typeof r=="object"&&r!==null?r:{category:String(r)},c=Ze(o.category||""),u=o.subcategory?` — ${Ze(o.subcategory)}`:"";return`${c}${u}`},wt=r=>{if(!r)return"-";const o=r.category?kt(r.category):"(No Category)",c=r.vendor?` — ${r.vendor}`:"";return`${o}${c}`},Se=n.useMemo(()=>{const r=b.trim().toLowerCase();return(S||[]).filter(o=>z==="all"?!0:(o.site_execution_status||"").toLowerCase()===z).filter(o=>r?[o.project,o.site_id,o.site_supervisor_id,o.daily_progress_report_id,o.work_completed,o.manpower_utilized,o.equipment_used,o.weather_conditions,o.safety_compliance_report,o.material_consumption,o.site_issues,o.site_execution_status].filter(Boolean).join(" ").toLowerCase().includes(r):!0)},[S,z,b]);return e.jsxs(e.Fragment,{children:[e.jsxs(ge,{sx:{mt:2,mb:2,px:2,py:2,borderRadius:2,background:"linear-gradient(135deg, rgba(114,103,239,0.12) 0%, rgba(114,103,239,0.04) 100%)",border:"1px solid",borderColor:"divider"},children:[e.jsx(D,{variant:"h5",sx:{color:"#2f2a8d",fontWeight:700},children:"Site Execution"}),e.jsx(D,{variant:"body2",color:"text.secondary",children:"Track progress, log issues, and request materials in one tap."})]}),e.jsx(d,{container:!0,spacing:2,sx:{mb:2},children:[{label:"Total",value:re.total,color:"#7267ef"},{label:"On Track",value:re.onTrack,color:"#2e7d32"},{label:"Delayed",value:re.delayed,color:"#ed6c02"},{label:"Halted",value:re.halted,color:"#d32f2f"}].map(r=>e.jsx(d,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(Be,{elevation:0,sx:{p:2,borderRadius:2,border:"1px solid",borderColor:"divider",backgroundColor:"background.paper"},children:[e.jsx(D,{variant:"overline",sx:{color:"text.secondary"},children:r.label}),e.jsx(D,{variant:"h5",sx:{color:r.color,fontWeight:700},children:r.value})]})},r.label))}),e.jsx(d,{container:!0,spacing:2,direction:"column",sx:{mb:2},children:e.jsx(d,{item:!0,xs:12,children:e.jsxs(Be,{elevation:0,sx:{p:2,borderRadius:2,border:"1px solid",borderColor:"divider",backgroundColor:"background.paper"},children:[e.jsxs(d,{container:!0,alignItems:"center",justifyContent:"space-between",sx:{mb:1},children:[e.jsx(d,{item:!0,children:e.jsx(D,{variant:"h6",sx:{color:"#7267ef"},children:"Project Records"})}),e.jsx(d,{item:!0,children:e.jsx(ie,{label:`${we.length} projects`,size:"small"})})]}),e.jsx(E,{fullWidth:!0,size:"small",placeholder:"Search project by any field (e.g., ID)",value:l,onChange:r=>p(r.target.value),InputProps:{startAdornment:e.jsx(tt,{position:"start",children:"🔎"})},sx:{mb:2}}),e.jsxs(rt,{size:"small",children:[e.jsx(st,{children:e.jsxs(je,{children:[e.jsx(f,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project ID"})}),e.jsx(f,{align:"right",sx:{color:"#660000"},children:e.jsx("strong",{children:"Action"})})]})}),e.jsxs(ot,{children:[we.map((r,o)=>e.jsxs(je,{hover:!0,children:[e.jsx(f,{children:r.project_id}),e.jsx(f,{align:"right",children:e.jsx(Fe,{slug:t,action:"can_create",children:e.jsx(oe,{title:"Create site execution for this project",children:e.jsx(Ie,{onClick:()=>Xe(r.project_id),color:"primary",children:e.jsx(at,{sx:{color:"#7267ef"}})})})})})]},o)),we.length===0&&e.jsx(je,{children:e.jsx(f,{colSpan:2,children:e.jsx(D,{variant:"body2",color:"text.secondary",children:"No projects found"})})})]})]})]})})}),e.jsx(d,{container:!0,spacing:2,children:e.jsx(d,{item:!0,xs:12,children:e.jsxs(Be,{sx:{p:2,backgroundColor:"#fff",border:"1px solid #eee"},children:[e.jsxs(d,{container:!0,spacing:2,alignItems:"center",sx:{mb:1},children:[e.jsx(d,{item:!0,xs:12,md:6,children:e.jsx(D,{variant:"h6",sx:{color:"#7267ef"},children:"Site Executions"})}),e.jsx(d,{item:!0,xs:12,md:6,children:e.jsxs(d,{container:!0,spacing:1,justifyContent:{xs:"flex-start",md:"flex-end"},children:[e.jsx(d,{item:!0,xs:12,md:6,children:e.jsx(E,{fullWidth:!0,size:"small",placeholder:"Search sites",value:b,onChange:r=>g(r.target.value),InputProps:{startAdornment:e.jsx(tt,{position:"start",children:"🔎"})}})}),e.jsx(d,{item:!0,xs:12,md:6,children:e.jsx(be,{direction:"row",spacing:1,justifyContent:{xs:"flex-start",md:"flex-end"},sx:{flexWrap:"wrap",rowGap:1,columnGap:1},children:[{key:"all",label:`All (${re.total})`},{key:"on track",label:`On Track (${re.onTrack})`},{key:"delayed",label:`Delayed (${re.delayed})`},{key:"halted",label:`Halted (${re.halted})`}].map(r=>e.jsx(ie,{label:r.label,color:z===r.key?"primary":"default",variant:z===r.key?"filled":"outlined",onClick:()=>A(r.key),size:"small",sx:{borderRadius:999,px:1,mr:0,mb:0}},r.key))})}),e.jsx(d,{item:!0,xs:12,md:"auto",children:e.jsxs(wr,{size:"small",value:N,exclusive:!0,onChange:(r,o)=>o&&Y(o),"aria-label":"view mode",children:[e.jsx(nt,{value:"cards","aria-label":"cards view",children:"Cards"}),e.jsx(nt,{value:"table","aria-label":"table view",children:"Table"})]})})]})})]}),v?e.jsx(ge,{display:"flex",alignItems:"center",justifyContent:"center",sx:{minHeight:200},children:e.jsx(Pt,{})}):N==="table"?e.jsx(Ut,{sx:{maxHeight:420,overflow:"auto",border:"1px solid",borderColor:"divider",borderRadius:2},children:e.jsxs(rt,{stickyHeader:!0,size:"small",children:[e.jsx(st,{children:e.jsxs(je,{children:[e.jsx(f,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project"})}),e.jsx(f,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Site ID"})}),e.jsx(f,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Supervisor"})}),e.jsx(f,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"DPR ID"})}),e.jsx(f,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Work Completed"})}),e.jsx(f,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Labour Usage"})}),e.jsx(f,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Equipment"})}),e.jsx(f,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Weather"})}),e.jsx(f,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Safety"})}),e.jsx(f,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Materials"})}),e.jsx(f,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Issues"})}),e.jsx(f,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Status"})}),e.jsx(f,{sx:{color:"#660000"},align:"right",children:e.jsx("strong",{children:"Actions"})})]})}),e.jsxs(ot,{children:[Se.map((r,o)=>e.jsxs(je,{hover:!0,children:[e.jsx(f,{children:r.project}),e.jsx(f,{children:r.site_id}),e.jsx(f,{children:r.site_supervisor_id}),e.jsx(f,{children:r.daily_progress_report_id}),e.jsx(f,{children:e.jsx(oe,{title:r.work_completed||"",children:e.jsxs("span",{children:[(r.work_completed||"").slice(0,24),(r.work_completed||"").length>24?"…":""]})})}),e.jsx(f,{children:(()=>{const c=Array.isArray(r.labour_usage)?r.labour_usage:[],u=c.reduce((i,H)=>i+(Number(H.number_of_workers)||0),0);return`${c.length} entries${u?` • ${u} workers`:""}`})()}),e.jsx(f,{children:e.jsx(oe,{title:r.equipment_used||"",children:e.jsxs("span",{children:[(r.equipment_used||"").slice(0,16),(r.equipment_used||"").length>16?"…":""]})})}),e.jsx(f,{children:r.weather_conditions}),e.jsx(f,{children:e.jsx(oe,{title:r.safety_compliance_report||"",children:e.jsxs("span",{children:[(r.safety_compliance_report||"").slice(0,16),(r.safety_compliance_report||"").length>16?"…":""]})})}),e.jsx(f,{children:e.jsx(oe,{title:r.material_consumption||"",children:e.jsxs("span",{children:[(r.material_consumption||"").slice(0,16),(r.material_consumption||"").length>16?"…":""]})})}),e.jsx(f,{children:e.jsx(oe,{title:r.site_issues||"",children:e.jsxs("span",{children:[(r.site_issues||"").slice(0,20),(r.site_issues||"").length>20?"…":""]})})}),e.jsx(f,{children:(()=>{const c=(r.site_execution_status||"").toLowerCase(),i={"on track":{color:"success",label:"On Track"},delayed:{color:"warning",label:"Delayed"},halted:{color:"error",label:"Halted"}}[c]||{color:"default",label:r.site_execution_status||"-"};return e.jsx(ie,{label:i.label,color:i.color,size:"small",variant:i.color==="default"?"outlined":"filled"})})()}),e.jsxs(f,{align:"right",children:[e.jsx(se,{slug:t,action:"can_update",children:e.jsx(oe,{title:"Edit",children:e.jsx(Ie,{color:"warning",onClick:()=>Me(r),children:e.jsx(Ne,{sx:{color:"orange"}})})})}),e.jsx(Fe,{slug:t,action:"can_delete",children:e.jsx(oe,{title:"Delete",children:e.jsx(Ie,{color:"error",onClick:()=>Oe(r.site_id),children:e.jsx(Ue,{sx:{color:"red"}})})})})]})]},`${r.site_id}-${o}`)),Se.length===0&&e.jsx(je,{children:e.jsx(f,{colSpan:13,children:e.jsx(D,{variant:"body2",color:"text.secondary",children:"No site executions found"})})})]})]})}):e.jsx(e.Fragment,{children:Se.length===0?e.jsx(ge,{sx:{p:3},children:e.jsx(D,{variant:"body2",color:"text.secondary",children:"No site executions found"})}):e.jsx(d,{container:!0,spacing:2,children:Se.map((r,o)=>{const c=(r.site_execution_status||"").toLowerCase(),u={"on track":{color:"success",label:"On Track"},delayed:{color:"warning",label:"Delayed"},halted:{color:"error",label:"Halted"}}[c]||{color:"default",label:r.site_execution_status||"-"};return e.jsx(d,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsxs(At,{onClick:()=>{Qe&&Ct(r)},sx:{height:"100%",display:"flex",flexDirection:"column",border:"1px solid",borderColor:"divider",borderRadius:2,transition:"box-shadow 0.2s ease","&:hover":{boxShadow:3},cursor:Qe?"pointer":"default"},children:[e.jsxs(Ft,{sx:{pb:1},children:[e.jsxs(be,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:1},children:[e.jsx(D,{variant:"subtitle2",color:"text.secondary",children:r.project}),e.jsx(ie,{label:u.label,color:u.color,size:"small",variant:u.color==="default"?"outlined":"filled"})]}),e.jsx(D,{variant:"h6",sx:{color:"#2f2a8d",mb:.5},children:r.site_id}),e.jsxs(D,{variant:"body2",color:"text.secondary",children:["Supervisor: ",r.site_supervisor_id||"-"]}),e.jsxs(D,{variant:"body2",color:"text.secondary",children:["DPR: ",r.daily_progress_report_id||"-"]}),!!r.work_completed&&e.jsxs(D,{variant:"body2",sx:{mt:1},children:[e.jsx("strong",{children:"Work:"})," ",(r.work_completed||"").slice(0,90),(r.work_completed||"").length>90?"…":""]}),!!r.site_issues&&e.jsxs(D,{variant:"body2",color:"error",sx:{mt:.5},children:[e.jsx("strong",{children:"Issue:"})," ",(r.site_issues||"").slice(0,90),(r.site_issues||"").length>90?"…":""]})]}),e.jsx(tr,{sx:{mt:"auto",p:1.5,pt:0},children:e.jsxs(be,{direction:"column",spacing:1,sx:{width:"100%"},children:[e.jsxs(be,{direction:"row",spacing:1,children:[e.jsx(se,{slug:t,action:"can_update",children:e.jsx(F,{fullWidth:!0,variant:"contained",color:"success",size:"small",onClick:i=>{i.stopPropagation(),fe(r,"on track")},children:"On Track"})}),e.jsx(se,{slug:t,action:"can_update",children:e.jsx(F,{fullWidth:!0,variant:"contained",color:"warning",size:"small",onClick:i=>{i.stopPropagation(),fe(r,"delayed")},children:"Delay"})}),e.jsx(se,{slug:t,action:"can_update",children:e.jsx(F,{fullWidth:!0,variant:"contained",color:"error",size:"small",onClick:i=>{i.stopPropagation(),fe(r,"halted")},children:"Halt"})})]}),e.jsxs(be,{direction:"row",spacing:1,children:[e.jsx(se,{slug:t,action:"can_update",children:e.jsx(F,{fullWidth:!0,variant:"outlined",color:"warning",size:"small",startIcon:e.jsx(lt,{}),onClick:i=>{i.stopPropagation(),ee(r),G(""),x(!0)},children:"Log Issue"})}),e.jsx(se,{slug:t,action:"can_update",children:e.jsx(F,{fullWidth:!0,variant:"outlined",color:"info",size:"small",startIcon:e.jsx(ct,{}),onClick:i=>{i.stopPropagation(),ee(r),he(""),Le(""),te(!0)},children:"Request Materials"})})]}),e.jsxs(be,{direction:"row",spacing:1,children:[e.jsx(se,{slug:t,action:"can_update",children:e.jsx(F,{fullWidth:!0,variant:"outlined",size:"small",startIcon:e.jsx(Ne,{}),onClick:i=>{i.stopPropagation(),Me(r)},children:"Update"})}),e.jsx(Fe,{slug:t,action:"can_delete",children:e.jsx(F,{fullWidth:!0,variant:"outlined",color:"error",size:"small",startIcon:e.jsx(Ue,{}),onClick:i=>{i.stopPropagation(),Oe(r.site_id)},children:"Delete"})})]})]})})]})},`${r.site_id}-${o}`)})})})]})})}),e.jsxs(Ge,{open:m,onClose:ke,fullWidth:!0,maxWidth:"md",children:[e.jsx(He,{sx:{backgroundColor:"#f7f7fb",color:"#2f2a8d"},children:"Enter Site Execution Details"}),e.jsxs(qe,{sx:{position:"relative"},children:[e.jsx(Ie,{"aria-label":"close",onClick:ke,sx:{position:"absolute",right:8,top:8,color:r=>r.palette.grey[500]},children:e.jsx(Dt,{})}),e.jsx(ge,{component:"form",sx:{mt:2},children:e.jsxs(d,{container:!0,spacing:3,direction:"column",children:[e.jsxs(d,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Project Information"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{item:!0,xs:6,children:e.jsx(E,{fullWidth:!0,size:"small",label:"Project ID",id:"projectId",value:j,disabled:!0})}),e.jsx(d,{item:!0,xs:6,children:e.jsx(E,{fullWidth:!0,size:"small",label:"Site ID",id:"siteId",value:h.siteId||"",disabled:!0})})]})]}),e.jsxs(d,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Site Information"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{item:!0,xs:6,children:e.jsx(E,{fullWidth:!0,size:"small",label:"Site Supervisor ID",id:"siteSupervisorID",name:"siteSupervisorID",value:h.siteSupervisorID||"",onChange:Z})}),e.jsx(d,{item:!0,xs:6,children:e.jsx(E,{fullWidth:!0,size:"small",label:"Daily Progress Report ID",id:"dailyProgressReportID",name:"dailyProgressReportID",value:h.dailyProgressReportID||"",onChange:Z})}),e.jsx(d,{item:!0,xs:6,children:e.jsx(E,{fullWidth:!0,size:"small",label:"Work Completed",id:"workCompleted",name:"workCompleted",value:h.workCompleted||"",onChange:Z})})]})]}),e.jsxs(d,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Weather & Materials"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{item:!0,xs:6,children:e.jsx(E,{fullWidth:!0,size:"small",label:"Equipment Used",id:"equipmentUsed",name:"equipmentUsed",value:h.equipmentUsed||"",onChange:Z})}),e.jsx(d,{item:!0,xs:6,children:e.jsx(E,{fullWidth:!0,size:"small",label:"Weather Conditions",id:"wetherCondition",name:"wetherCondition",value:h.wetherCondition||"",onChange:Z})}),e.jsx(d,{item:!0,xs:6,children:e.jsx(E,{fullWidth:!0,size:"small",label:"Safety Compliance Report",id:"safetyCompliance",name:"safetyCompliance",value:h.safetyCompliance||"",onChange:Z})}),e.jsx(d,{item:!0,xs:6,children:e.jsx(E,{fullWidth:!0,size:"small",label:"Material Consumption",id:"materialConsumption",name:"materialConsumption",value:h.materialConsumption||"",onChange:Z})})]})]}),e.jsxs(d,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Site Issues & Status"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{item:!0,xs:6,children:e.jsx(E,{fullWidth:!0,size:"small",label:"Site Issues",id:"siteIssues",name:"siteIssues",multiline:!0,minRows:3,value:h.siteIssues||"",onChange:Z})}),e.jsx(d,{item:!0,xs:6,children:e.jsxs(E,{select:!0,fullWidth:!0,size:"small",id:"siteStatus",name:"siteStatus",label:"Site Execution Status",SelectProps:{native:!0},value:h.siteStatus||"on track",onChange:Z,children:[e.jsx("option",{value:"on track",children:"On Track"}),e.jsx("option",{value:"delayed",children:"Delayed"}),e.jsx("option",{value:"halted",children:"Halted"})]})})]})]}),e.jsxs(d,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Labour Usage"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsx(d,{container:!0,spacing:1,children:(ue||[]).map((r,o)=>e.jsx(d,{item:!0,xs:12,children:e.jsxs(d,{container:!0,spacing:1,alignItems:"center",children:[e.jsx(d,{item:!0,xs:12,sm:4,children:e.jsxs(E,{select:!0,fullWidth:!0,size:"small",label:"Labour Resource",SelectProps:{native:!0},value:r.labour_resource||"",onChange:c=>L(u=>u.map((i,H)=>H===o?{...i,labour_resource:c.target.value}:i)),children:[e.jsx("option",{value:"",children:"Select Labour Resource"}),(Q||[]).map(c=>e.jsx("option",{value:c.id,children:wt(c)},c.id))]})}),e.jsx(d,{item:!0,xs:12,sm:2,children:e.jsx(E,{fullWidth:!0,size:"small",type:"number",label:"# Workers",value:r.number_of_workers,onChange:c=>L(u=>u.map((i,H)=>H===o?{...i,number_of_workers:c.target.value}:i))})}),e.jsx(d,{item:!0,xs:12,sm:2,children:e.jsx(E,{fullWidth:!0,size:"small",type:"number",label:"Work Hours",value:r.work_hours,onChange:c=>L(u=>u.map((i,H)=>H===o?{...i,work_hours:c.target.value}:i))})}),e.jsx(d,{item:!0,xs:12,sm:4,children:e.jsx(E,{fullWidth:!0,size:"small",type:"datetime-local",label:"Date/Time",InputLabelProps:{shrink:!0},value:r.date,onChange:c=>L(u=>u.map((i,H)=>H===o?{...i,date:c.target.value}:i))})}),e.jsx(d,{item:!0,xs:12,children:e.jsxs(ge,{display:"flex",justifyContent:"flex-end",gap:1,children:[e.jsx(F,{size:"small",variant:"outlined",onClick:()=>L(c=>[...c,{labour_resource:"",number_of_workers:"",work_hours:"",date:""}]),children:"Add Row"}),ue.length>1&&e.jsx(F,{size:"small",color:"error",variant:"outlined",onClick:()=>L(c=>c.filter((u,i)=>i!==o)),children:"Remove"})]})})]})},o))})]})]})})]}),e.jsxs(Ve,{children:[e.jsx(F,{onClick:ke,sx:{outline:"2px solid #800000",color:"#800000","&:hover":{outline:"2px solid #b30000",color:"#b30000"}},children:"Cancel"}),e.jsx(se,{slug:t,action:"can_create",children:e.jsx(F,{variant:"outlined",onClick:_t,sx:{borderColor:"#7267ef",color:"#7267ef","&:hover":{borderColor:"#9e8df2",color:"#9e8df2"}},children:"Submit"})})]})]}),e.jsxs(Ge,{open:pe,onClose:()=>x(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(He,{sx:{backgroundColor:"#f7f7fb",color:"#2f2a8d"},children:"Log Issue"}),e.jsxs(qe,{children:[e.jsxs(D,{variant:"body2",color:"text.secondary",sx:{mb:1},children:["Site: ",(C==null?void 0:C.site_id)||"-"," | Project: ",(C==null?void 0:C.project)||"-"]}),e.jsx(E,{fullWidth:!0,multiline:!0,minRows:3,label:"Describe the issue",value:P,onChange:r=>G(r.target.value)})]}),e.jsxs(Ve,{children:[e.jsx(F,{onClick:()=>x(!1),color:"inherit",children:"Cancel"}),e.jsx(F,{variant:"contained",sx:{backgroundColor:"#7267ef"},onClick:async()=>{if(!C||!P.trim()){x(!1);return}const o=`[${new Date().toLocaleString()}] ISSUE: ${P.trim()}`,c=[...S];T(u=>u.map(i=>i.site_id===C.site_id?{...i,site_issues:(i.site_issues||"")+(i.site_issues?`
`:"")+o}:i));try{await Re(C.site_id,{site_issues:(C.site_issues||"")+(C.site_issues?`
`:"")+o})}catch{T(c),alert("Failed to log issue")}finally{x(!1)}},children:"Save"})]})]}),e.jsxs(Ge,{open:Ee,onClose:()=>te(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(He,{sx:{backgroundColor:"#f7f7fb",color:"#2f2a8d"},children:"Request Materials"}),e.jsxs(qe,{children:[e.jsxs(D,{variant:"body2",color:"text.secondary",sx:{mb:1},children:["Site: ",(C==null?void 0:C.site_id)||"-"," | Project: ",(C==null?void 0:C.project)||"-"]}),e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{item:!0,xs:12,sm:8,children:e.jsx(E,{fullWidth:!0,size:"small",label:"Material Item",value:xe,onChange:r=>he(r.target.value)})}),e.jsx(d,{item:!0,xs:12,sm:4,children:e.jsx(E,{fullWidth:!0,size:"small",type:"number",label:"Qty",value:ze,onChange:r=>Le(r.target.value)})}),e.jsx(d,{item:!0,xs:12,children:e.jsx(D,{variant:"caption",color:"text.secondary",children:"A simple note will be appended to Site Issues to notify procurement."})})]})]}),e.jsxs(Ve,{children:[e.jsx(F,{onClick:()=>te(!1),color:"inherit",children:"Cancel"}),e.jsx(F,{variant:"contained",sx:{backgroundColor:"#7267ef"},onClick:async()=>{if(!C||!xe.trim()||!ze){te(!1);return}const o=`[${new Date().toLocaleString()}] MATERIAL REQUEST: ${xe.trim()} x ${ze}`,c=[...S];T(u=>u.map(i=>i.site_id===C.site_id?{...i,site_issues:(i.site_issues||"")+(i.site_issues?`
`:"")+o}:i));try{await Re(C.site_id,{site_issues:(C.site_issues||"")+(C.site_issues?`
`:"")+o})}catch{T(c),alert("Failed to request materials")}finally{te(!1)}},children:"Send"})]})]}),e.jsx(Nt,{color:"primary",sx:{position:"fixed",right:24,bottom:24,backgroundColor:"#7267ef",boxShadow:6},onClick:()=>{const r=we[0];r!=null&&r.project_id&&Xe(r.project_id)},"aria-label":"quick add",children:e.jsx(at,{})}),e.jsxs(pr,{anchor:"bottom",open:yt,onClose:()=>X(!1),PaperProps:{sx:{borderTopLeftRadius:12,borderTopRightRadius:12}},children:[e.jsxs(ge,{sx:{p:2,pb:0},children:[e.jsx(D,{variant:"subtitle1",sx:{fontWeight:700},children:($==null?void 0:$.site_id)||"Site"}),e.jsxs(D,{variant:"caption",color:"text.secondary",children:["Supervisor: ",($==null?void 0:$.site_supervisor_id)||"-"," · Project: ",($==null?void 0:$.project)||"-"]})]}),e.jsxs(Qt,{children:[e.jsxs(le,{onClick:()=>{$&&fe($,"on track"),X(!1)},children:[e.jsx(ce,{children:e.jsx(ie,{size:"small",color:"success",label:"On"})}),e.jsx(ne,{primary:"Mark On Track"})]}),e.jsxs(le,{onClick:()=>{$&&fe($,"delayed"),X(!1)},children:[e.jsx(ce,{children:e.jsx(ie,{size:"small",color:"warning",label:"Delay"})}),e.jsx(ne,{primary:"Mark Delayed"})]}),e.jsxs(le,{onClick:()=>{$&&fe($,"halted"),X(!1)},children:[e.jsx(ce,{children:e.jsx(ie,{size:"small",color:"error",label:"Halt"})}),e.jsx(ne,{primary:"Mark Halted"})]}),e.jsx(it,{}),e.jsxs(le,{onClick:()=>{$&&(ee($),G(""),x(!0)),X(!1)},children:[e.jsx(ce,{children:e.jsx(lt,{color:"warning"})}),e.jsx(ne,{primary:"Log Issue",secondary:"Add a quick issue note"})]}),e.jsxs(le,{onClick:()=>{$&&(ee($),he(""),Le(""),te(!0)),X(!1)},children:[e.jsx(ce,{children:e.jsx(ct,{color:"info"})}),e.jsx(ne,{primary:"Request Materials",secondary:"Send a simple request"})]}),e.jsx(it,{}),e.jsxs(le,{onClick:()=>{$&&Me($),X(!1)},children:[e.jsx(ce,{children:e.jsx(Ne,{})}),e.jsx(ne,{primary:"Update Details"})]}),e.jsxs(le,{onClick:()=>{$&&Oe($.site_id),X(!1)},children:[e.jsx(ce,{children:e.jsx(Ue,{color:"error"})}),e.jsx(ne,{primary:"Delete"})]})]})]})]})};export{Xr as default};
