import{r as n,j as e,a2 as Ho,a3 as Uo,a4 as Go,x as Ko,a5 as Qo,a6 as Mt,a7 as To,a8 as Yo,a9 as Jo,k as Ft,i as Bt,m as Pt,o as ge,n as mt,q as Ue,t as qt,J as Zt,w as Ge,a0 as Zo,aa as Xo,z as Ut,ab as er,A as St,_ as Xt,I as Jt,ac as Eo,ad as tr,O as ke,d as or,ae as rr,E as H,T as m,af as sr,S as kt,G as Gt,H as xo,ag as nr,ah as ir}from"./main-Skim5IJC.js";import{g as ar}from"./engineering-BJ3wTiKO.js";import{i as bo,n as lr,k as yo,g as cr,m as dr}from"./construction-CMO2W9OH.js";import{g as ur,a as vo,f as pr}from"./procurement-BWIn9uW6.js";import{g as mr}from"./inventory-BCILrqmV.js";import{u as hr}from"./index-CV0T-gUl.js";import{R as gr}from"./index-Pp9EW3wT.js";import{T as fr}from"./Toolbar-Dufg8Txv.js";import{P as No,T as eo}from"./Tooltip-YrZkw7B4.js";import{C as st}from"./Chip-DTcaVcsg.js";import{S as $,C as So,a as jo,F as Co}from"./Stack-BGApbFiI.js";import{T as Z}from"./TextField-D43kg6c3.js";import{M as xr}from"./MenuItem-Cm5ZuES4.js";import{s as br,B as xe,D as Dt,a as zt,b as Tt,c as Et}from"./DialogTitle-CvDFHAwp.js";import{D as Nt}from"./Divider-mutym74u.js";import{L as Fo}from"./LinearProgress-Doxu96ic.js";import{A as yr,f as It,c as vt,o as _o,d as to}from"./Select-BThNtn2k.js";import{u as oo}from"./useControlled-CHkDrNg3.js";import{G as ne}from"./Grid-fY_ATwTx.js";import"./useSlotProps-CCL6Y0ZK.js";import"./useFormControl-C6hS7-Rn.js";const vr=o=>{const s=n.useRef({});return n.useEffect(()=>{s.current=o}),s.current},Bo=n.createContext(null);function lo(){return n.useContext(Bo)}const Sr=typeof Symbol=="function"&&Symbol.for,jr=Sr?Symbol.for("mui.nested"):"__THEME_NESTED__";function Cr(o,s){return typeof s=="function"?s(o):{...o,...s}}function _r(o){const{children:s,theme:l}=o,u=lo(),y=n.useMemo(()=>{const w=u===null?{...l}:Cr(u,l);return w!=null&&(w[jr]=u!==null),w},[l,u]);return e.jsx(Bo.Provider,{value:y,children:s})}const wo={};function ko(o,s,l,u=!1){return n.useMemo(()=>{const y=o&&s[o]||s;if(typeof l=="function"){const w=l(y),x=o?{...s,[o]:w}:w;return u?()=>x:x}return o?{...s,[o]:l}:{...s,...l}},[o,s,l,u])}function qo(o){const{children:s,theme:l,themeId:u}=o,y=Ho(wo),w=lo()||wo,x=ko(u,y,l),p=ko(u,w,l,!0),z=(u?x[u]:x).direction==="rtl";return e.jsx(_r,{theme:p,children:e.jsx(Uo.Provider,{value:x,children:e.jsx(gr,{value:z,children:e.jsx(Go,{value:u?x[u].components:x.components,children:s})})})})}const co="mode",uo="color-scheme",wr="data-color-scheme";function kr(o){const{defaultMode:s="system",defaultLightColorScheme:l="light",defaultDarkColorScheme:u="dark",modeStorageKey:y=co,colorSchemeStorageKey:w=uo,attribute:x=wr,colorSchemeNode:p="document.documentElement",nonce:z}=o||{};let R="",C=x;if(x==="class"&&(C=".%s"),x==="data"&&(C="[data-%s]"),C.startsWith(".")){const F=C.substring(1);R+=`${p}.classList.remove('${F}'.replace('%s', light), '${F}'.replace('%s', dark));
      ${p}.classList.add('${F}'.replace('%s', colorScheme));`}const k=C.match(/\[([^\]]+)\]/);if(k){const[F,_]=k[1].split("=");_||(R+=`${p}.removeAttribute('${F}'.replace('%s', light));
      ${p}.removeAttribute('${F}'.replace('%s', dark));`),R+=`
      ${p}.setAttribute('${F}'.replace('%s', colorScheme), ${_?`${_}.replace('%s', colorScheme)`:'""'});`}else R+=`${p}.setAttribute('${C}', colorScheme);`;return e.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?z:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  let colorScheme = '';
  const mode = localStorage.getItem('${y}') || '${s}';
  const dark = localStorage.getItem('${w}-dark') || '${u}';
  const light = localStorage.getItem('${w}-light') || '${l}';
  if (mode === 'system') {
    // handle system mode
    const mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = dark
    } else {
      colorScheme = light
    }
  }
  if (mode === 'light') {
    colorScheme = light;
  }
  if (mode === 'dark') {
    colorScheme = dark;
  }
  if (colorScheme) {
    ${R}
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function Ir(){}const Mr=({key:o,storageWindow:s})=>(!s&&typeof window<"u"&&(s=window),{get(l){if(typeof window>"u")return;if(!s)return l;let u;try{u=s.localStorage.getItem(o)}catch{}return u||l},set:l=>{if(s)try{s.localStorage.setItem(o,l)}catch{}},subscribe:l=>{if(!s)return Ir;const u=y=>{const w=y.newValue;y.key===o&&l(w)};return s.addEventListener("storage",u),()=>{s.removeEventListener("storage",u)}}});function ro(){}function Io(o){if(typeof window<"u"&&typeof window.matchMedia=="function"&&o==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Wo(o,s){if(o.mode==="light"||o.mode==="system"&&o.systemMode==="light")return s("light");if(o.mode==="dark"||o.mode==="system"&&o.systemMode==="dark")return s("dark")}function Pr(o){return Wo(o,s=>{if(s==="light")return o.lightColorScheme;if(s==="dark")return o.darkColorScheme})}function $r(o){const{defaultMode:s="light",defaultLightColorScheme:l,defaultDarkColorScheme:u,supportedColorSchemes:y=[],modeStorageKey:w=co,colorSchemeStorageKey:x=uo,storageWindow:p=typeof window>"u"?void 0:window,storageManager:z=Mr,noSsr:R=!1}=o,C=y.join(","),k=y.length>1,F=n.useMemo(()=>z==null?void 0:z({key:w,storageWindow:p}),[z,w,p]),_=n.useMemo(()=>z==null?void 0:z({key:`${x}-light`,storageWindow:p}),[z,x,p]),g=n.useMemo(()=>z==null?void 0:z({key:`${x}-dark`,storageWindow:p}),[z,x,p]),[G,X]=n.useState(()=>{const A=(F==null?void 0:F.get(s))||s,O=(_==null?void 0:_.get(l))||l,N=(g==null?void 0:g.get(u))||u;return{mode:A,systemMode:Io(A),lightColorScheme:O,darkColorScheme:N}}),[Y,ie]=n.useState(R||!k);n.useEffect(()=>{ie(!0)},[]);const re=Pr(G),Ce=n.useCallback(A=>{X(O=>{if(A===O.mode)return O;const N=A??s;return F==null||F.set(N),{...O,mode:N,systemMode:Io(N)}})},[F,s]),Ie=n.useCallback(A=>{A?typeof A=="string"?A&&!C.includes(A)?console.error(`\`${A}\` does not exist in \`theme.colorSchemes\`.`):X(O=>{const N={...O};return Wo(O,q=>{q==="light"&&(_==null||_.set(A),N.lightColorScheme=A),q==="dark"&&(g==null||g.set(A),N.darkColorScheme=A)}),N}):X(O=>{const N={...O},q=A.light===null?l:A.light,I=A.dark===null?u:A.dark;return q&&(C.includes(q)?(N.lightColorScheme=q,_==null||_.set(q)):console.error(`\`${q}\` does not exist in \`theme.colorSchemes\`.`)),I&&(C.includes(I)?(N.darkColorScheme=I,g==null||g.set(I)):console.error(`\`${I}\` does not exist in \`theme.colorSchemes\`.`)),N}):X(O=>(_==null||_.set(l),g==null||g.set(u),{...O,lightColorScheme:l,darkColorScheme:u}))},[C,_,g,l,u]),D=n.useCallback(A=>{G.mode==="system"&&X(O=>{const N=A!=null&&A.matches?"dark":"light";return O.systemMode===N?O:{...O,systemMode:N}})},[G.mode]),_e=n.useRef(D);return _e.current=D,n.useEffect(()=>{if(typeof window.matchMedia!="function"||!k)return;const A=(...N)=>_e.current(...N),O=window.matchMedia("(prefers-color-scheme: dark)");return O.addListener(A),A(O),()=>{O.removeListener(A)}},[k]),n.useEffect(()=>{if(k){const A=(F==null?void 0:F.subscribe(q=>{(!q||["light","dark","system"].includes(q))&&Ce(q||s)}))||ro,O=(_==null?void 0:_.subscribe(q=>{(!q||C.match(q))&&Ie({light:q})}))||ro,N=(g==null?void 0:g.subscribe(q=>{(!q||C.match(q))&&Ie({dark:q})}))||ro;return()=>{A(),O(),N()}}},[Ie,Ce,C,s,p,k,F,_,g]),{...G,mode:Y?G.mode:void 0,systemMode:Y?G.systemMode:void 0,colorScheme:Y?re:void 0,setMode:Ce,setColorScheme:Ie}}const Ar="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function Lr(o){const{themeId:s,theme:l={},modeStorageKey:u=co,colorSchemeStorageKey:y=uo,disableTransitionOnChange:w=!1,defaultColorScheme:x,resolveTheme:p}=o,z={allColorSchemes:[],colorScheme:void 0,darkColorScheme:void 0,lightColorScheme:void 0,mode:void 0,setColorScheme:()=>{},setMode:()=>{},systemMode:void 0},R=n.createContext(void 0),C=()=>n.useContext(R)||z,k={},F={};function _(Y){var Be,ht,$e,De;const{children:ie,theme:re,modeStorageKey:Ce=u,colorSchemeStorageKey:Ie=y,disableTransitionOnChange:D=w,storageManager:_e,storageWindow:A=typeof window>"u"?void 0:window,documentNode:O=typeof document>"u"?void 0:document,colorSchemeNode:N=typeof document>"u"?void 0:document.documentElement,disableNestedContext:q=!1,disableStyleSheetGeneration:I=!1,defaultMode:Ke="system",forceThemeRerender:Qe=!1,noSsr:U}=Y,Me=n.useRef(!1),Ee=lo(),Ye=n.useContext(R),nt=!!Ye&&!q,it=n.useMemo(()=>re||(typeof l=="function"?l():l),[re]),be=it[s],V=be||it,{colorSchemes:we=k,components:Je=F,cssVarPrefix:ae}=V,b=Object.keys(we).filter(W=>!!we[W]).join(","),ye=n.useMemo(()=>b.split(","),[b]),Ne=typeof x=="string"?x:x.light,J=typeof x=="string"?x:x.dark,fe=we[Ne]&&we[J]?Ke:((ht=(Be=we[V.defaultColorScheme])==null?void 0:Be.palette)==null?void 0:ht.mode)||(($e=V.palette)==null?void 0:$e.mode),{mode:Ze,setMode:at,systemMode:le,lightColorScheme:Fe,darkColorScheme:Xe,colorScheme:se,setColorScheme:lt}=$r({supportedColorSchemes:ye,defaultLightColorScheme:Ne,defaultDarkColorScheme:J,modeStorageKey:Ce,colorSchemeStorageKey:Ie,defaultMode:fe,storageManager:_e,storageWindow:A,noSsr:U});let S=Ze,ce=se;nt&&(S=Ye.mode,ce=Ye.colorScheme);let M=ce||V.defaultColorScheme;V.vars&&!Qe&&(M=V.defaultColorScheme);const ve=n.useMemo(()=>{var te;const W=((te=V.generateThemeVars)==null?void 0:te.call(V))||V.vars,v={...V,components:Je,colorSchemes:we,cssVarPrefix:ae,vars:W};if(typeof v.generateSpacing=="function"&&(v.spacing=v.generateSpacing()),M){const me=we[M];me&&typeof me=="object"&&Object.keys(me).forEach(Q=>{me[Q]&&typeof me[Q]=="object"?v[Q]={...v[Q],...me[Q]}:v[Q]=me[Q]})}return p?p(v):v},[V,M,Je,we,ae]),K=V.colorSchemeSelector;Ko(()=>{if(ce&&N&&K&&K!=="media"){const W=K;let v=K;if(W==="class"&&(v=".%s"),W==="data"&&(v="[data-%s]"),W!=null&&W.startsWith("data-")&&!W.includes("%s")&&(v=`[${W}="%s"]`),v.startsWith("."))N.classList.remove(...ye.map(te=>v.substring(1).replace("%s",te))),N.classList.add(v.substring(1).replace("%s",ce));else{const te=v.replace("%s",ce).match(/\[([^\]]+)\]/);if(te){const[me,Q]=te[1].split("=");Q||ye.forEach(qe=>{N.removeAttribute(me.replace(ce,qe))}),N.setAttribute(me,Q?Q.replace(/"|'/g,""):"")}else N.setAttribute(v,ce)}}},[ce,K,N,ye]),n.useEffect(()=>{let W;if(D&&Me.current&&O){const v=O.createElement("style");v.appendChild(O.createTextNode(Ar)),O.head.appendChild(v),window.getComputedStyle(O.body),W=setTimeout(()=>{O.head.removeChild(v)},1)}return()=>{clearTimeout(W)}},[ce,D,O]),n.useEffect(()=>(Me.current=!0,()=>{Me.current=!1}),[]);const Oe=n.useMemo(()=>({allColorSchemes:ye,colorScheme:ce,darkColorScheme:Xe,lightColorScheme:Fe,mode:S,setColorScheme:lt,setMode:at,systemMode:le}),[ye,ce,Xe,Fe,S,lt,at,le,ve.colorSchemeSelector]);let ze=!0;(I||V.cssVariables===!1||nt&&(Ee==null?void 0:Ee.cssVarPrefix)===ae)&&(ze=!1);const Se=e.jsxs(n.Fragment,{children:[e.jsx(qo,{themeId:be?s:void 0,theme:ve,children:ie}),ze&&e.jsx(Qo,{styles:((De=ve.generateStyleSheets)==null?void 0:De.call(ve))||[]})]});return nt?Se:e.jsx(R.Provider,{value:Oe,children:Se})}const g=typeof x=="string"?x:x.light,G=typeof x=="string"?x:x.dark;return{CssVarsProvider:_,useColorScheme:C,getInitColorSchemeScript:Y=>kr({colorSchemeStorageKey:y,defaultLightColorScheme:g,defaultDarkColorScheme:G,modeStorageKey:u,...Y})}}function so({theme:o,...s}){const l=Mt in o?o[Mt]:void 0;return e.jsx(qo,{...s,themeId:l?Mt:void 0,theme:l||o})}const Kt={colorSchemeStorageKey:"mui-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"mui-mode"},{CssVarsProvider:Rr}=Lr({themeId:Mt,theme:()=>To({cssVariables:!0}),colorSchemeStorageKey:Kt.colorSchemeStorageKey,modeStorageKey:Kt.modeStorageKey,defaultColorScheme:{light:Kt.defaultLightColorScheme,dark:Kt.defaultDarkColorScheme},resolveTheme:o=>{const s={...o,typography:Yo(o.palette,o.typography)};return s.unstable_sx=function(u){return Jo({sx:u,theme:this})},s}}),Or=Rr;function Dr({theme:o,...s}){if(typeof o=="function")return e.jsx(so,{theme:o,...s});const l=Mt in o?o[Mt]:o;return"colorSchemes"in l?e.jsx(Or,{theme:o,...s}):"vars"in l?e.jsx(so,{theme:o,...s}):e.jsx(so,{theme:{...o,vars:null},...s})}function zr(o){return Ft("MuiAppBar",o)}Bt("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const Tr=o=>{const{color:s,position:l,classes:u}=o,y={root:["root",`color${Ue(s)}`,`position${Ue(l)}`]};return qt(y,zr,u)},Mo=(o,s)=>o?`${o==null?void 0:o.replace(")","")}, ${s})`:s,Er=ge(Zt,{name:"MuiAppBar",slot:"Root",overridesResolver:(o,s)=>{const{ownerState:l}=o;return[s.root,s[`position${Ue(l.position)}`],s[`color${Ue(l.color)}`]]}})(Ge(({theme:o})=>({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0,variants:[{props:{position:"fixed"},style:{position:"fixed",zIndex:(o.vars||o).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}}},{props:{position:"absolute"},style:{position:"absolute",zIndex:(o.vars||o).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"sticky"},style:{position:"sticky",zIndex:(o.vars||o).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"static"},style:{position:"static"}},{props:{position:"relative"},style:{position:"relative"}},{props:{color:"inherit"},style:{"--AppBar-color":"inherit"}},{props:{color:"default"},style:{"--AppBar-background":o.vars?o.vars.palette.AppBar.defaultBg:o.palette.grey[100],"--AppBar-color":o.vars?o.vars.palette.text.primary:o.palette.getContrastText(o.palette.grey[100]),...o.applyStyles("dark",{"--AppBar-background":o.vars?o.vars.palette.AppBar.defaultBg:o.palette.grey[900],"--AppBar-color":o.vars?o.vars.palette.text.primary:o.palette.getContrastText(o.palette.grey[900])})}},...Object.entries(o.palette).filter(Zo(["contrastText"])).map(([s])=>({props:{color:s},style:{"--AppBar-background":(o.vars??o).palette[s].main,"--AppBar-color":(o.vars??o).palette[s].contrastText}})),{props:s=>s.enableColorOnDark===!0&&!["inherit","transparent"].includes(s.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)"}},{props:s=>s.enableColorOnDark===!1&&!["inherit","transparent"].includes(s.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...o.applyStyles("dark",{backgroundColor:o.vars?Mo(o.vars.palette.AppBar.darkBg,"var(--AppBar-background)"):null,color:o.vars?Mo(o.vars.palette.AppBar.darkColor,"var(--AppBar-color)"):null})}},{props:{color:"transparent"},style:{"--AppBar-background":"transparent","--AppBar-color":"inherit",backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...o.applyStyles("dark",{backgroundImage:"none"})}}]}))),Nr=n.forwardRef(function(s,l){const u=Pt({props:s,name:"MuiAppBar"}),{className:y,color:w="primary",enableColorOnDark:x=!1,position:p="fixed",...z}=u,R={...u,color:w,position:p,enableColorOnDark:x},C=Tr(R);return e.jsx(Er,{square:!0,component:"header",ownerState:R,elevation:4,className:mt(C.root,y,p==="fixed"&&"mui-fixed"),ref:l,...z})});function Po(o){return o.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function Fr(o={}){const{ignoreAccents:s=!0,ignoreCase:l=!0,limit:u,matchFrom:y="any",stringify:w,trim:x=!1}=o;return(p,{inputValue:z,getOptionLabel:R})=>{let C=x?z.trim():z;l&&(C=C.toLowerCase()),s&&(C=Po(C));const k=C?p.filter(F=>{let _=(w||R)(F);return l&&(_=_.toLowerCase()),s&&(_=Po(_)),y==="start"?_.startsWith(C):_.includes(C)}):p;return typeof u=="number"?k.slice(0,u):k}}const Br=Fr(),qr=5,Wr=o=>{var s;return o.current!==null&&((s=o.current.parentElement)==null?void 0:s.contains(document.activeElement))},Vr=[];function $o(o,s,l,u){if(s||o==null||u)return"";const y=l(o);return typeof y=="string"?y:""}function Hr(o){const{unstable_isActiveElementInListbox:s=Wr,unstable_classNamePrefix:l="Mui",autoComplete:u=!1,autoHighlight:y=!1,autoSelect:w=!1,blurOnSelect:x=!1,clearOnBlur:p=!o.freeSolo,clearOnEscape:z=!1,componentName:R="useAutocomplete",defaultValue:C=o.multiple?Vr:null,disableClearable:k=!1,disableCloseOnSelect:F=!1,disabled:_,disabledItemsFocusable:g=!1,disableListWrap:G=!1,filterOptions:X=Br,filterSelectedOptions:Y=!1,freeSolo:ie=!1,getOptionDisabled:re,getOptionKey:Ce,getOptionLabel:Ie=a=>a.label??a,groupBy:D,handleHomeEndKeys:_e=!o.freeSolo,id:A,includeInputInList:O=!1,inputValue:N,isOptionEqualToValue:q=(a,i)=>a===i,multiple:I=!1,onChange:Ke,onClose:Qe,onHighlightChange:U,onInputChange:Me,onOpen:Ee,open:Ye,openOnFocus:nt=!1,options:it,readOnly:be=!1,renderValue:V,selectOnFocus:we=!o.freeSolo,value:Je}=o,ae=Xo(A);let b=Ie;b=a=>{const i=Ie(a);return typeof i!="string"?String(i):i};const ye=n.useRef(!1),Ne=n.useRef(!0),J=n.useRef(null),fe=n.useRef(null),[Ze,at]=n.useState(null),[le,Fe]=n.useState(-1),Xe=y?0:-1,se=n.useRef(Xe),lt=n.useRef($o(C??Je,I,b)).current,[S,ce]=oo({controlled:Je,default:C,name:R}),[M,ve]=oo({controlled:N,default:lt,name:R,state:"inputValue"}),[K,Oe]=n.useState(!1),ze=n.useCallback((a,i,f)=>{if(!(I?S.length<i.length:i!==null)&&!p)return;const j=$o(i,I,b,V);M!==j&&(ve(j),Me&&Me(a,j,f))},[b,M,I,Me,ve,p,S,V]),[Se,Be]=oo({controlled:Ye,default:!1,name:R,state:"open"}),[ht,$e]=n.useState(!0),De=!I&&S!=null&&M===b(S),W=Se&&!be,v=W?X(it.filter(a=>!(Y&&(I?S:[S]).some(i=>i!==null&&q(a,i)))),{inputValue:De&&ht?"":M,getOptionLabel:b}):[],te=vr({filteredOptions:v,value:S,inputValue:M});n.useEffect(()=>{const a=S!==te.value;K&&!a||ie&&!a||ze(null,S,"reset")},[S,ze,K,te.value,ie]);const me=Se&&v.length>0&&!be,Q=Ut(a=>{if(a===-1)J.current.focus();else{const i=V?"data-item-index":"data-tag-index";Ze.querySelector(`[${i}="${a}"]`).focus()}});n.useEffect(()=>{I&&le>S.length-1&&(Fe(-1),Q(-1))},[S,I,le,Q]);function qe(a,i){if(!fe.current||a<0||a>=v.length)return-1;let f=a;for(;;){const T=fe.current.querySelector(`[data-option-index="${f}"]`),j=g?!1:!T||T.disabled||T.getAttribute("aria-disabled")==="true";if(T&&T.hasAttribute("tabindex")&&!j)return f;if(i==="next"?f=(f+1)%v.length:f=(f-1+v.length)%v.length,f===a)return-1}}const Ae=Ut(({event:a,index:i,reason:f})=>{if(se.current=i,i===-1?J.current.removeAttribute("aria-activedescendant"):J.current.setAttribute("aria-activedescendant",`${ae}-option-${i}`),U&&["mouse","keyboard","touch"].includes(f)&&U(a,i===-1?null:v[i],f),!fe.current)return;const T=fe.current.querySelector(`[role="option"].${l}-focused`);T&&(T.classList.remove(`${l}-focused`),T.classList.remove(`${l}-focusVisible`));let j=fe.current;if(fe.current.getAttribute("role")!=="listbox"&&(j=fe.current.parentElement.querySelector('[role="listbox"]')),!j)return;if(i===-1){j.scrollTop=0;return}const ee=fe.current.querySelector(`[data-option-index="${i}"]`);if(ee&&(ee.classList.add(`${l}-focused`),f==="keyboard"&&ee.classList.add(`${l}-focusVisible`),j.scrollHeight>j.clientHeight&&f!=="mouse"&&f!=="touch")){const oe=ee,he=j.clientHeight+j.scrollTop,_t=oe.offsetTop+oe.offsetHeight;_t>he?j.scrollTop=_t-j.clientHeight:oe.offsetTop-oe.offsetHeight*(D?1.3:0)<j.scrollTop&&(j.scrollTop=oe.offsetTop-oe.offsetHeight*(D?1.3:0))}}),Le=Ut(({event:a,diff:i,direction:f="next",reason:T})=>{if(!W)return;const ee=qe((()=>{const oe=v.length-1;if(i==="reset")return Xe;if(i==="start")return 0;if(i==="end")return oe;const he=se.current+i;return he<0?he===-1&&O?-1:G&&se.current!==-1||Math.abs(i)>1?0:oe:he>oe?he===oe+1&&O?-1:G||Math.abs(i)>1?oe:0:he})(),f);if(Ae({index:ee,reason:T,event:a}),u&&i!=="reset")if(ee===-1)J.current.value=M;else{const oe=b(v[ee]);J.current.value=oe,oe.toLowerCase().indexOf(M.toLowerCase())===0&&M.length>0&&J.current.setSelectionRange(M.length,oe.length)}}),jt=()=>{const a=(i,f)=>{const T=i?b(i):"",j=f?b(f):"";return T===j};if(se.current!==-1&&te.filteredOptions&&te.filteredOptions.length!==v.length&&te.inputValue===M&&(I?S.length===te.value.length&&te.value.every((i,f)=>b(S[f])===b(i)):a(te.value,S))){const i=te.filteredOptions[se.current];if(i)return v.findIndex(f=>b(f)===b(i))}return-1},ct=n.useCallback(()=>{if(!W)return;const a=jt();if(a!==-1){se.current=a;return}const i=I?S[0]:S;if(v.length===0||i==null){Le({diff:"reset"});return}if(fe.current){if(i!=null){const f=v[se.current];if(I&&f&&S.findIndex(j=>q(f,j))!==-1)return;const T=v.findIndex(j=>q(j,i));T===-1?Le({diff:"reset"}):Ae({index:T});return}if(se.current>=v.length-1){Ae({index:v.length-1});return}Ae({index:se.current})}},[v.length,I?!1:S,Y,Le,Ae,W,M,I]),gt=Ut(a=>{br(fe,a),a&&ct()});n.useEffect(()=>{ct()},[ct]);const ue=a=>{Se||(Be(!0),$e(!0),Ee&&Ee(a))},et=(a,i)=>{Se&&(Be(!1),Qe&&Qe(a,i))},je=(a,i,f,T)=>{if(I){if(S.length===i.length&&S.every((j,ee)=>j===i[ee]))return}else if(S===i)return;Ke&&Ke(a,i,f,T),ce(i)},We=n.useRef(!1),Re=(a,i,f="selectOption",T="options")=>{let j=f,ee=i;if(I){ee=Array.isArray(S)?S.slice():[];const oe=ee.findIndex(he=>q(i,he));oe===-1?ee.push(i):T!=="freeSolo"&&(ee.splice(oe,1),j="removeOption")}ze(a,ee,j),je(a,ee,j,{option:i}),!F&&(!a||!a.ctrlKey&&!a.metaKey)&&et(a,j),(x===!0||x==="touch"&&We.current||x==="mouse"&&!We.current)&&J.current.blur()};function tt(a,i){if(a===-1)return-1;let f=a;for(;;){if(i==="next"&&f===S.length||i==="previous"&&f===-1)return-1;const T=V?"data-item-index":"data-tag-index",j=Ze.querySelector(`[${T}="${f}"]`);if(!j||!j.hasAttribute("tabindex")||j.disabled||j.getAttribute("aria-disabled")==="true")f+=i==="next"?1:-1;else return f}}const Pe=(a,i)=>{if(!I)return;M===""&&et(a,"toggleInput");let f=le;le===-1?M===""&&i==="previous"&&(f=S.length-1):(f+=i==="next"?1:-1,f<0&&(f=0),f===S.length&&(f=-1)),f=tt(f,i),Fe(f),Q(f)},ot=a=>{ye.current=!0,ve(""),Me&&Me(a,"","clear"),je(a,I?[]:null,"clear")},ft=a=>i=>{if(a.onKeyDown&&a.onKeyDown(i),!i.defaultMuiPrevented&&(le!==-1&&!["ArrowLeft","ArrowRight"].includes(i.key)&&(Fe(-1),Q(-1)),i.which!==229))switch(i.key){case"Home":W&&_e&&(i.preventDefault(),Le({diff:"start",direction:"next",reason:"keyboard",event:i}));break;case"End":W&&_e&&(i.preventDefault(),Le({diff:"end",direction:"previous",reason:"keyboard",event:i}));break;case"PageUp":i.preventDefault(),Le({diff:-5,direction:"previous",reason:"keyboard",event:i}),ue(i);break;case"PageDown":i.preventDefault(),Le({diff:qr,direction:"next",reason:"keyboard",event:i}),ue(i);break;case"ArrowDown":i.preventDefault(),Le({diff:1,direction:"next",reason:"keyboard",event:i}),ue(i);break;case"ArrowUp":i.preventDefault(),Le({diff:-1,direction:"previous",reason:"keyboard",event:i}),ue(i);break;case"ArrowLeft":!I&&V?Q(0):Pe(i,"previous");break;case"ArrowRight":!I&&V?Q(-1):Pe(i,"next");break;case"Enter":if(se.current!==-1&&W){const f=v[se.current],T=re?re(f):!1;if(i.preventDefault(),T)return;Re(i,f,"selectOption"),u&&J.current.setSelectionRange(J.current.value.length,J.current.value.length)}else ie&&M!==""&&De===!1&&(I&&i.preventDefault(),Re(i,M,"createOption","freeSolo"));break;case"Escape":W?(i.preventDefault(),i.stopPropagation(),et(i,"escape")):z&&(M!==""||I&&S.length>0||V)&&(i.preventDefault(),i.stopPropagation(),ot(i));break;case"Backspace":if(I&&!be&&M===""&&S.length>0){const f=le===-1?S.length-1:le,T=S.slice();T.splice(f,1),je(i,T,"removeOption",{option:S[f]})}!I&&V&&!be&&(ce(null),Q(-1));break;case"Delete":if(I&&!be&&M===""&&S.length>0&&le!==-1){const f=le,T=S.slice();T.splice(f,1),je(i,T,"removeOption",{option:S[f]})}!I&&V&&!be&&(ce(null),Q(-1));break}},$t=a=>{Oe(!0),nt&&!ye.current&&ue(a)},Ve=a=>{if(s(fe)){J.current.focus();return}Oe(!1),Ne.current=!0,ye.current=!1,w&&se.current!==-1&&W?Re(a,v[se.current],"blur"):w&&ie&&M!==""?Re(a,M,"blur","freeSolo"):p&&ze(a,S,"blur"),et(a,"blur")},dt=a=>{const i=a.target.value;M!==i&&(ve(i),$e(!1),Me&&Me(a,i,"input")),i===""?!k&&!I&&je(a,null,"clear"):ue(a)},xt=a=>{const i=Number(a.currentTarget.getAttribute("data-option-index"));se.current!==i&&Ae({event:a,index:i,reason:"mouse"})},At=a=>{Ae({event:a,index:Number(a.currentTarget.getAttribute("data-option-index")),reason:"touch"}),We.current=!0},Lt=a=>{const i=Number(a.currentTarget.getAttribute("data-option-index"));Re(a,v[i],"selectOption"),We.current=!1},Ct=a=>i=>{const f=S.slice();f.splice(a,1),je(i,f,"removeOption",{option:S[a]})},Wt=a=>{je(a,null,"removeOption",{option:S})},rt=a=>{Se?et(a,"toggleInput"):ue(a)},pe=a=>{a.currentTarget.contains(a.target)&&a.target.getAttribute("id")!==ae&&a.preventDefault()},de=a=>{a.currentTarget.contains(a.target)&&(J.current.focus(),we&&Ne.current&&J.current.selectionEnd-J.current.selectionStart===0&&J.current.select(),Ne.current=!1)},Te=a=>{!_&&(M===""||!Se)&&rt(a)};let bt=ie&&M.length>0;bt=bt||(I?S.length>0:S!==null);let yt=v;return D&&(yt=v.reduce((a,i,f)=>{const T=D(i);return a.length>0&&a[a.length-1].group===T?a[a.length-1].options.push(i):a.push({key:f,index:f,group:T,options:[i]}),a},[])),_&&K&&Ve(),{getRootProps:(a={})=>({...a,onKeyDown:ft(a),onMouseDown:pe,onClick:de}),getInputLabelProps:()=>({id:`${ae}-label`,htmlFor:ae}),getInputProps:()=>({id:ae,value:M,onBlur:Ve,onFocus:$t,onChange:dt,onMouseDown:Te,"aria-activedescendant":W?"":null,"aria-autocomplete":u?"both":"list","aria-controls":me?`${ae}-listbox`:void 0,"aria-expanded":me,autoComplete:"off",ref:J,autoCapitalize:"none",spellCheck:"false",role:"combobox",disabled:_}),getClearProps:()=>({tabIndex:-1,type:"button",onClick:ot}),getItemProps:({index:a=0}={})=>({...I&&{key:a},...V?{"data-item-index":a}:{"data-tag-index":a},tabIndex:-1,...!be&&{onDelete:I?Ct(a):Wt}}),getPopupIndicatorProps:()=>({tabIndex:-1,type:"button",onClick:rt}),getTagProps:({index:a})=>({key:a,"data-tag-index":a,tabIndex:-1,...!be&&{onDelete:Ct(a)}}),getListboxProps:()=>({role:"listbox",id:`${ae}-listbox`,"aria-labelledby":`${ae}-label`,ref:gt,onMouseDown:a=>{a.preventDefault()}}),getOptionProps:({index:a,option:i})=>{const f=(I?S:[S]).some(j=>j!=null&&q(i,j)),T=re?re(i):!1;return{key:(Ce==null?void 0:Ce(i))??b(i),tabIndex:-1,role:"option",id:`${ae}-option-${a}`,onMouseMove:xt,onClick:Lt,onTouchStart:At,"data-option-index":a,"aria-disabled":T,"aria-selected":f}},id:ae,inputValue:M,value:S,dirty:bt,expanded:W&&Ze,popupOpen:W,focused:K||le!==-1,anchorEl:Ze,setAnchorEl:at,focusedItem:le,focusedTag:le,groupedOptions:yt}}function Ur(o){return Ft("MuiListSubheader",o)}Bt("MuiListSubheader",["root","colorPrimary","colorInherit","gutters","inset","sticky"]);const Gr=o=>{const{classes:s,color:l,disableGutters:u,inset:y,disableSticky:w}=o,x={root:["root",l!=="default"&&`color${Ue(l)}`,!u&&"gutters",y&&"inset",!w&&"sticky"]};return qt(x,Ur,s)},Kr=ge("li",{name:"MuiListSubheader",slot:"Root",overridesResolver:(o,s)=>{const{ownerState:l}=o;return[s.root,l.color!=="default"&&s[`color${Ue(l.color)}`],!l.disableGutters&&s.gutters,l.inset&&s.inset,!l.disableSticky&&s.sticky]}})(Ge(({theme:o})=>({boxSizing:"border-box",lineHeight:"48px",listStyle:"none",color:(o.vars||o).palette.text.secondary,fontFamily:o.typography.fontFamily,fontWeight:o.typography.fontWeightMedium,fontSize:o.typography.pxToRem(14),variants:[{props:{color:"primary"},style:{color:(o.vars||o).palette.primary.main}},{props:{color:"inherit"},style:{color:"inherit"}},{props:({ownerState:s})=>!s.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:s})=>s.inset,style:{paddingLeft:72}},{props:({ownerState:s})=>!s.disableSticky,style:{position:"sticky",top:0,zIndex:1,backgroundColor:(o.vars||o).palette.background.paper}}]}))),io=n.forwardRef(function(s,l){const u=Pt({props:s,name:"MuiListSubheader"}),{className:y,color:w="default",component:x="li",disableGutters:p=!1,disableSticky:z=!1,inset:R=!1,...C}=u,k={...u,color:w,component:x,disableGutters:p,disableSticky:z,inset:R},F=Gr(k);return e.jsx(Kr,{as:x,className:mt(F.root,y),ref:l,ownerState:k,...C})});io&&(io.muiSkipListHighlight=!0);function Qr(o){return Ft("MuiAutocomplete",o)}const E=Bt("MuiAutocomplete",["root","expanded","fullWidth","focused","focusVisible","tag","tagSizeSmall","tagSizeMedium","hasPopupIcon","hasClearIcon","inputRoot","input","inputFocused","endAdornment","clearIndicator","popupIndicator","popupIndicatorOpen","popper","popperDisablePortal","paper","listbox","loading","noOptions","option","groupLabel","groupUl"]);var Ao,Lo;const Yr=o=>{const{classes:s,disablePortal:l,expanded:u,focused:y,fullWidth:w,hasClearIcon:x,hasPopupIcon:p,inputFocused:z,popupOpen:R,size:C}=o,k={root:["root",u&&"expanded",y&&"focused",w&&"fullWidth",x&&"hasClearIcon",p&&"hasPopupIcon"],inputRoot:["inputRoot"],input:["input",z&&"inputFocused"],tag:["tag",`tagSize${Ue(C)}`],endAdornment:["endAdornment"],clearIndicator:["clearIndicator"],popupIndicator:["popupIndicator",R&&"popupIndicatorOpen"],popper:["popper",l&&"popperDisablePortal"],paper:["paper"],listbox:["listbox"],loading:["loading"],noOptions:["noOptions"],option:["option"],groupLabel:["groupLabel"],groupUl:["groupUl"]};return qt(k,Qr,s)},Jr=ge("div",{name:"MuiAutocomplete",slot:"Root",overridesResolver:(o,s)=>{const{ownerState:l}=o,{fullWidth:u,hasClearIcon:y,hasPopupIcon:w,inputFocused:x,size:p}=l;return[{[`& .${E.tag}`]:s.tag},{[`& .${E.tag}`]:s[`tagSize${Ue(p)}`]},{[`& .${E.inputRoot}`]:s.inputRoot},{[`& .${E.input}`]:s.input},{[`& .${E.input}`]:x&&s.inputFocused},s.root,u&&s.fullWidth,w&&s.hasPopupIcon,y&&s.hasClearIcon]}})({[`&.${E.focused} .${E.clearIndicator}`]:{visibility:"visible"},"@media (pointer: fine)":{[`&:hover .${E.clearIndicator}`]:{visibility:"visible"}},[`& .${E.tag}`]:{margin:3,maxWidth:"calc(100% - 6px)"},[`& .${E.inputRoot}`]:{[`.${E.hasPopupIcon}&, .${E.hasClearIcon}&`]:{paddingRight:30},[`.${E.hasPopupIcon}.${E.hasClearIcon}&`]:{paddingRight:56},[`& .${E.input}`]:{width:0,minWidth:30}},[`& .${to.root}`]:{paddingBottom:1,"& .MuiInput-input":{padding:"4px 4px 4px 0px"}},[`& .${to.root}.${vt.sizeSmall}`]:{[`& .${to.input}`]:{padding:"2px 4px 3px 0"}},[`& .${_o.root}`]:{padding:9,[`.${E.hasPopupIcon}&, .${E.hasClearIcon}&`]:{paddingRight:39},[`.${E.hasPopupIcon}.${E.hasClearIcon}&`]:{paddingRight:65},[`& .${E.input}`]:{padding:"7.5px 4px 7.5px 5px"},[`& .${E.endAdornment}`]:{right:9}},[`& .${_o.root}.${vt.sizeSmall}`]:{paddingTop:6,paddingBottom:6,paddingLeft:6,[`& .${E.input}`]:{padding:"2.5px 4px 2.5px 8px"}},[`& .${It.root}`]:{paddingTop:19,paddingLeft:8,[`.${E.hasPopupIcon}&, .${E.hasClearIcon}&`]:{paddingRight:39},[`.${E.hasPopupIcon}.${E.hasClearIcon}&`]:{paddingRight:65},[`& .${It.input}`]:{padding:"7px 4px"},[`& .${E.endAdornment}`]:{right:9}},[`& .${It.root}.${vt.sizeSmall}`]:{paddingBottom:1,[`& .${It.input}`]:{padding:"2.5px 4px"}},[`& .${vt.hiddenLabel}`]:{paddingTop:8},[`& .${It.root}.${vt.hiddenLabel}`]:{paddingTop:0,paddingBottom:0,[`& .${E.input}`]:{paddingTop:16,paddingBottom:17}},[`& .${It.root}.${vt.hiddenLabel}.${vt.sizeSmall}`]:{[`& .${E.input}`]:{paddingTop:8,paddingBottom:9}},[`& .${E.input}`]:{flexGrow:1,textOverflow:"ellipsis",opacity:0},variants:[{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{[`& .${E.tag}`]:{margin:2,maxWidth:"calc(100% - 4px)"}}},{props:{inputFocused:!0},style:{[`& .${E.input}`]:{opacity:1}}},{props:{multiple:!0},style:{[`& .${E.inputRoot}`]:{flexWrap:"wrap"}}}]}),Zr=ge("div",{name:"MuiAutocomplete",slot:"EndAdornment",overridesResolver:(o,s)=>s.endAdornment})({position:"absolute",right:0,top:"50%",transform:"translate(0, -50%)"}),Xr=ge(Jt,{name:"MuiAutocomplete",slot:"ClearIndicator",overridesResolver:(o,s)=>s.clearIndicator})({marginRight:-2,padding:4,visibility:"hidden"}),es=ge(Jt,{name:"MuiAutocomplete",slot:"PopupIndicator",overridesResolver:(o,s)=>{const{ownerState:l}=o;return[s.popupIndicator,l.popupOpen&&s.popupIndicatorOpen]}})({padding:2,marginRight:-2,variants:[{props:{popupOpen:!0},style:{transform:"rotate(180deg)"}}]}),ts=ge(No,{name:"MuiAutocomplete",slot:"Popper",overridesResolver:(o,s)=>{const{ownerState:l}=o;return[{[`& .${E.option}`]:s.option},s.popper,l.disablePortal&&s.popperDisablePortal]}})(Ge(({theme:o})=>({zIndex:(o.vars||o).zIndex.modal,variants:[{props:{disablePortal:!0},style:{position:"absolute"}}]}))),os=ge(Zt,{name:"MuiAutocomplete",slot:"Paper",overridesResolver:(o,s)=>s.paper})(Ge(({theme:o})=>({...o.typography.body1,overflow:"auto"}))),rs=ge("div",{name:"MuiAutocomplete",slot:"Loading",overridesResolver:(o,s)=>s.loading})(Ge(({theme:o})=>({color:(o.vars||o).palette.text.secondary,padding:"14px 16px"}))),ss=ge("div",{name:"MuiAutocomplete",slot:"NoOptions",overridesResolver:(o,s)=>s.noOptions})(Ge(({theme:o})=>({color:(o.vars||o).palette.text.secondary,padding:"14px 16px"}))),ns=ge("ul",{name:"MuiAutocomplete",slot:"Listbox",overridesResolver:(o,s)=>s.listbox})(Ge(({theme:o})=>({listStyle:"none",margin:0,padding:"8px 0",maxHeight:"40vh",overflow:"auto",position:"relative",[`& .${E.option}`]:{minHeight:48,display:"flex",overflow:"hidden",justifyContent:"flex-start",alignItems:"center",cursor:"pointer",paddingTop:6,boxSizing:"border-box",outline:"0",WebkitTapHighlightColor:"transparent",paddingBottom:6,paddingLeft:16,paddingRight:16,[o.breakpoints.up("sm")]:{minHeight:"auto"},[`&.${E.focused}`]:{backgroundColor:(o.vars||o).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},'&[aria-disabled="true"]':{opacity:(o.vars||o).palette.action.disabledOpacity,pointerEvents:"none"},[`&.${E.focusVisible}`]:{backgroundColor:(o.vars||o).palette.action.focus},'&[aria-selected="true"]':{backgroundColor:o.vars?`rgba(${o.vars.palette.primary.mainChannel} / ${o.vars.palette.action.selectedOpacity})`:Xt(o.palette.primary.main,o.palette.action.selectedOpacity),[`&.${E.focused}`]:{backgroundColor:o.vars?`rgba(${o.vars.palette.primary.mainChannel} / calc(${o.vars.palette.action.selectedOpacity} + ${o.vars.palette.action.hoverOpacity}))`:Xt(o.palette.primary.main,o.palette.action.selectedOpacity+o.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(o.vars||o).palette.action.selected}},[`&.${E.focusVisible}`]:{backgroundColor:o.vars?`rgba(${o.vars.palette.primary.mainChannel} / calc(${o.vars.palette.action.selectedOpacity} + ${o.vars.palette.action.focusOpacity}))`:Xt(o.palette.primary.main,o.palette.action.selectedOpacity+o.palette.action.focusOpacity)}}}}))),is=ge(io,{name:"MuiAutocomplete",slot:"GroupLabel",overridesResolver:(o,s)=>s.groupLabel})(Ge(({theme:o})=>({backgroundColor:(o.vars||o).palette.background.paper,top:-8}))),as=ge("ul",{name:"MuiAutocomplete",slot:"GroupUl",overridesResolver:(o,s)=>s.groupUl})({padding:0,[`& .${E.option}`]:{paddingLeft:24}}),Qt=n.forwardRef(function(s,l){const u=Pt({props:s,name:"MuiAutocomplete"}),{autoComplete:y=!1,autoHighlight:w=!1,autoSelect:x=!1,blurOnSelect:p=!1,ChipProps:z,className:R,clearIcon:C=Ao||(Ao=e.jsx(er,{fontSize:"small"})),clearOnBlur:k=!u.freeSolo,clearOnEscape:F=!1,clearText:_="Clear",closeText:g="Close",componentsProps:G,defaultValue:X=u.multiple?[]:null,disableClearable:Y=!1,disableCloseOnSelect:ie=!1,disabled:re=!1,disabledItemsFocusable:Ce=!1,disableListWrap:Ie=!1,disablePortal:D=!1,filterOptions:_e,filterSelectedOptions:A=!1,forcePopupIcon:O="auto",freeSolo:N=!1,fullWidth:q=!1,getLimitTagsText:I=h=>`+${h}`,getOptionDisabled:Ke,getOptionKey:Qe,getOptionLabel:U,isOptionEqualToValue:Me,groupBy:Ee,handleHomeEndKeys:Ye=!u.freeSolo,id:nt,includeInputInList:it=!1,inputValue:be,limitTags:V=-1,ListboxComponent:we,ListboxProps:Je,loading:ae=!1,loadingText:b="Loadingâ€¦",multiple:ye=!1,noOptionsText:Ne="No options",onChange:J,onClose:fe,onHighlightChange:Ze,onInputChange:at,onOpen:le,open:Fe,openOnFocus:Xe=!1,openText:se="Open",options:lt,PaperComponent:S,PopperComponent:ce,popupIcon:M=Lo||(Lo=e.jsx(yr,{})),readOnly:ve=!1,renderGroup:K,renderInput:Oe,renderOption:ze,renderTags:Se,renderValue:Be,selectOnFocus:ht=!u.freeSolo,size:$e="medium",slots:De={},slotProps:W={},value:v,...te}=u,{getRootProps:me,getInputProps:Q,getInputLabelProps:qe,getPopupIndicatorProps:Ae,getClearProps:Le,getItemProps:jt,getListboxProps:ct,getOptionProps:gt,value:ue,dirty:et,expanded:je,id:We,popupOpen:Re,focused:tt,focusedItem:Pe,anchorEl:ot,setAnchorEl:ft,inputValue:$t,groupedOptions:Ve}=Hr({...u,componentName:"Autocomplete"}),dt=!Y&&!re&&et&&!ve,xt=(!N||O===!0)&&O!==!1,{onMouseDown:At}=Q(),{ref:Lt,...Ct}=ct(),rt=U||(h=>h.label??h),pe={...u,disablePortal:D,expanded:je,focused:tt,fullWidth:q,getOptionLabel:rt,hasClearIcon:dt,hasPopupIcon:xt,inputFocused:Pe===-1,popupOpen:Re,size:$e},de=Yr(pe),Te={slots:{paper:S,popper:ce,...De},slotProps:{chip:z,listbox:Je,...G,...W}},[bt,yt]=St("listbox",{elementType:ns,externalForwardedProps:Te,ownerState:pe,className:de.listbox,additionalProps:Ct,ref:Lt}),[a,i]=St("paper",{elementType:Zt,externalForwardedProps:Te,ownerState:pe,className:de.paper}),[f,T]=St("popper",{elementType:No,externalForwardedProps:Te,ownerState:pe,className:de.popper,additionalProps:{disablePortal:D,style:{width:ot?ot.clientWidth:null},role:"presentation",anchorEl:ot,open:Re}});let j;const ee=h=>({className:de.tag,disabled:re,...jt(h)});if(Se&&ye&&ue.length>0?j=Se(ue,ee,pe):Be&&ue?j=Be(ue,ee,pe):ye&&ue.length>0&&(j=ue.map((h,L)=>{const{key:P,...B}=ee({index:L});return e.jsx(st,{label:rt(h),size:$e,...B,...Te.slotProps.chip},P)})),V>-1&&Array.isArray(j)){const h=j.length-V;!tt&&h>0&&(j=j.splice(0,V),j.push(e.jsx("span",{className:de.tag,children:I(h)},j.length)))}const he=K||(h=>e.jsxs("li",{children:[e.jsx(is,{className:de.groupLabel,ownerState:pe,component:"div",children:h.group}),e.jsx(as,{className:de.groupUl,ownerState:pe,children:h.children})]},h.key)),t=ze||((h,L)=>{const{key:P,...B}=h;return e.jsx("li",{...B,children:rt(L)},P)}),r=(h,L)=>{const P=gt({option:h,index:L});return t({...P,className:de.option},h,{selected:P["aria-selected"],index:L,inputValue:$t},pe)},c=Te.slotProps.clearIndicator,d=Te.slotProps.popupIndicator;return e.jsxs(n.Fragment,{children:[e.jsx(Jr,{ref:l,className:mt(de.root,R),ownerState:pe,...me(te),children:Oe({id:We,disabled:re,fullWidth:!0,size:$e==="small"?"small":void 0,InputLabelProps:qe(),InputProps:{ref:ft,className:de.inputRoot,startAdornment:j,onMouseDown:h=>{h.target===h.currentTarget&&At(h)},...(dt||xt)&&{endAdornment:e.jsxs(Zr,{className:de.endAdornment,ownerState:pe,children:[dt?e.jsx(Xr,{...Le(),"aria-label":_,title:_,ownerState:pe,...c,className:mt(de.clearIndicator,c==null?void 0:c.className),children:C}):null,xt?e.jsx(es,{...Ae(),disabled:re,"aria-label":Re?g:se,title:Re?g:se,ownerState:pe,...d,className:mt(de.popupIndicator,d==null?void 0:d.className),children:M}):null]})}},inputProps:{className:de.input,disabled:re,readOnly:ve,...Q()}})}),ot?e.jsx(ts,{as:f,...T,children:e.jsxs(os,{as:a,...i,children:[ae&&Ve.length===0?e.jsx(rs,{className:de.loading,ownerState:pe,children:b}):null,Ve.length===0&&!N&&!ae?e.jsx(ss,{className:de.noOptions,ownerState:pe,role:"presentation",onMouseDown:h=>{h.preventDefault()},children:Ne}):null,Ve.length>0?e.jsx(bt,{as:we,...yt,children:Ve.map((h,L)=>Ee?he({key:h.key,group:h.group,children:h.options.map((P,B)=>r(P,h.index+B))}):r(h,L))}):null]})}):null]})});function ls(o){return Ft("MuiCardMedia",o)}Bt("MuiCardMedia",["root","media","img"]);const cs=o=>{const{classes:s,isMediaComponent:l,isImageComponent:u}=o;return qt({root:["root",l&&"media",u&&"img"]},ls,s)},ds=ge("div",{name:"MuiCardMedia",slot:"Root",overridesResolver:(o,s)=>{const{ownerState:l}=o,{isMediaComponent:u,isImageComponent:y}=l;return[s.root,u&&s.media,y&&s.img]}})({display:"block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center",variants:[{props:{isMediaComponent:!0},style:{width:"100%"}},{props:{isImageComponent:!0},style:{objectFit:"cover"}}]}),us=["video","audio","picture","iframe","img"],ps=["picture","img"],Ro=n.forwardRef(function(s,l){const u=Pt({props:s,name:"MuiCardMedia"}),{children:y,className:w,component:x="div",image:p,src:z,style:R,...C}=u,k=us.includes(x),F=!k&&p?{backgroundImage:`url("${p}")`,...R}:R,_={...u,component:x,isMediaComponent:k,isImageComponent:ps.includes(x)},g=cs(_);return e.jsx(ds,{className:mt(g.root,w),as:x,role:!k&&p?"img":void 0,ref:l,style:F,ownerState:_,src:k?p||z:void 0,...C,children:y})}),ao=typeof Eo({})=="function",ms=(o,s)=>({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%",...s&&!o.vars&&{colorScheme:o.palette.mode}}),hs=o=>({color:(o.vars||o).palette.text.primary,...o.typography.body1,backgroundColor:(o.vars||o).palette.background.default,"@media print":{backgroundColor:(o.vars||o).palette.common.white}}),Vo=(o,s=!1)=>{var w,x;const l={};s&&o.colorSchemes&&typeof o.getColorSchemeSelector=="function"&&Object.entries(o.colorSchemes).forEach(([p,z])=>{var C,k;const R=o.getColorSchemeSelector(p);R.startsWith("@")?l[R]={":root":{colorScheme:(C=z.palette)==null?void 0:C.mode}}:l[R.replace(/\s*&/,"")]={colorScheme:(k=z.palette)==null?void 0:k.mode}});let u={html:ms(o,s),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:o.typography.fontWeightBold},body:{margin:0,...hs(o),"&::backdrop":{backgroundColor:(o.vars||o).palette.background.default}},...l};const y=(x=(w=o.components)==null?void 0:w.MuiCssBaseline)==null?void 0:x.styleOverrides;return y&&(u=[u,y]),u},Yt="mui-ecs",gs=o=>{const s=Vo(o,!1),l=Array.isArray(s)?s[0]:s;return!o.vars&&l&&(l.html[`:root:has(${Yt})`]={colorScheme:o.palette.mode}),o.colorSchemes&&Object.entries(o.colorSchemes).forEach(([u,y])=>{var x,p;const w=o.getColorSchemeSelector(u);w.startsWith("@")?l[w]={[`:root:not(:has(.${Yt}))`]:{colorScheme:(x=y.palette)==null?void 0:x.mode}}:l[w.replace(/\s*&/,"")]={[`&:not(:has(.${Yt}))`]:{colorScheme:(p=y.palette)==null?void 0:p.mode}}}),s},fs=Eo(ao?({theme:o,enableColorScheme:s})=>Vo(o,s):({theme:o})=>gs(o));function xs(o){const s=Pt({props:o,name:"MuiCssBaseline"}),{children:l,enableColorScheme:u=!1}=s;return e.jsxs(n.Fragment,{children:[ao&&e.jsx(fs,{enableColorScheme:u}),!ao&&!u&&e.jsx("span",{className:Yt,style:{display:"none"}}),l]})}function bs(o){return Ft("MuiMobileStepper",o)}Bt("MuiMobileStepper",["root","positionBottom","positionTop","positionStatic","dots","dot","dotActive","progress"]);const ys=o=>{const{classes:s,position:l}=o,u={root:["root",`position${Ue(l)}`],dots:["dots"],dot:["dot"],dotActive:["dotActive"],progress:["progress"]};return qt(u,bs,s)},vs=ge(Zt,{name:"MuiMobileStepper",slot:"Root",overridesResolver:(o,s)=>{const{ownerState:l}=o;return[s.root,s[`position${Ue(l.position)}`]]}})(Ge(({theme:o})=>({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",background:(o.vars||o).palette.background.default,padding:8,variants:[{props:({position:s})=>s==="top"||s==="bottom",style:{position:"fixed",left:0,right:0,zIndex:(o.vars||o).zIndex.mobileStepper}},{props:{position:"top"},style:{top:0}},{props:{position:"bottom"},style:{bottom:0}}]}))),Ss=ge("div",{name:"MuiMobileStepper",slot:"Dots",overridesResolver:(o,s)=>s.dots})({variants:[{props:{variant:"dots"},style:{display:"flex",flexDirection:"row"}}]}),js=ge("div",{name:"MuiMobileStepper",slot:"Dot",shouldForwardProp:o=>tr(o)&&o!=="dotActive",overridesResolver:(o,s)=>{const{dotActive:l}=o;return[s.dot,l&&s.dotActive]}})(Ge(({theme:o})=>({variants:[{props:{variant:"dots"},style:{transition:o.transitions.create("background-color",{duration:o.transitions.duration.shortest}),backgroundColor:(o.vars||o).palette.action.disabled,borderRadius:"50%",width:8,height:8,margin:"0 2px"}},{props:{variant:"dots",dotActive:!0},style:{backgroundColor:(o.vars||o).palette.primary.main}}]}))),Cs=ge(Fo,{name:"MuiMobileStepper",slot:"Progress",overridesResolver:(o,s)=>s.progress})({variants:[{props:{variant:"progress"},style:{width:"50%"}}]}),_s=n.forwardRef(function(s,l){const u=Pt({props:s,name:"MuiMobileStepper"}),{activeStep:y=0,backButton:w,className:x,LinearProgressProps:p,nextButton:z,position:R="bottom",steps:C,variant:k="dots",slots:F={},slotProps:_={},...g}=u,G={...u,activeStep:y,position:R,variant:k};let X;k==="progress"&&(C===1?X=100:X=Math.ceil(y/(C-1)*100));const Y=ys(G),ie={slots:F,slotProps:{progress:p,..._}},[re,Ce]=St("root",{ref:l,elementType:vs,shouldForwardComponentProp:!0,className:mt(Y.root,x),externalForwardedProps:{...ie,...g},ownerState:G,additionalProps:{square:!0,elevation:0}}),[Ie,D]=St("dots",{className:Y.dots,elementType:Ss,externalForwardedProps:ie,ownerState:G}),[_e,A]=St("dot",{elementType:js,externalForwardedProps:ie,ownerState:G}),[O,N]=St("progress",{className:Y.progress,elementType:Cs,shouldForwardComponentProp:!0,externalForwardedProps:ie,ownerState:G,additionalProps:{value:X,variant:"determinate"}});return e.jsxs(re,{...Ce,children:[w,k==="text"&&e.jsxs(n.Fragment,{children:[y+1," / ",C]}),k==="dots"&&e.jsx(Ie,{...D,children:[...new Array(C)].map((q,I)=>e.jsx(_e,{...A,className:mt(Y.dot,A.className,I===y&&Y.dotActive),dotActive:I===y},I))}),k==="progress"&&e.jsx(O,{...N}),z]})}),Oo=ke([e.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),e.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")]),ws=ke(e.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"})),ks=ke(e.jsx("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m2 14H7v-2h7zm3-4H7v-2h10zm0-4H7V7h10z"})),Do=ke(e.jsx("path",{d:"m22.7 19-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4"})),Is=ke([e.jsx("circle",{cx:"12",cy:"12",r:"3.2"},"0"),e.jsx("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")]),Ms=ke(e.jsx("path",{d:"m13.7826 15.1719 2.1213-2.1213 5.9963 5.9962-2.1213 2.1213zM17.5 10c1.93 0 3.5-1.57 3.5-3.5 0-.58-.16-1.12-.41-1.6l-2.7 2.7-1.49-1.49 2.7-2.7c-.48-.25-1.02-.41-1.6-.41C15.57 3 14 4.57 14 6.5c0 .41.08.8.21 1.16l-1.85 1.85-1.78-1.78.71-.71-1.41-1.41L12 3.49c-1.17-1.17-3.07-1.17-4.24 0L4.22 7.03l1.41 1.41H2.81l-.71.71 3.54 3.54.71-.71V9.15l1.41 1.41.71-.71 1.78 1.78-7.41 7.41 2.12 2.12L16.34 9.79c.36.13.75.21 1.16.21"})),Ps=ke(e.jsx("path",{d:"M3 13h8V3H3zm0 8h8v-6H3zm10 0h8V11h-8zm0-18v6h8V3z"})),$s=ke(e.jsx("path",{d:"M4 6h18V4H4c-1.1 0-2 .9-2 2v11H0v3h14v-3H4zm19 2h-6c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1m-1 9h-4v-7h4z"})),As=ke(e.jsx("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3m-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3m0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5m8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5"})),Ls=ke(e.jsx("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"})),Rs=ke(e.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"})),Os=ke(e.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"})),Ds=ke(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39"})),zs=ke([e.jsx("path",{d:"M12 5.99 19.53 19H4.47zM12 2 1 21h22z"},"0"),e.jsx("path",{d:"M13 16h-2v2h2zm0-6h-2v5h2z"},"1")]),Ts=ke(e.jsx("path",{d:"m6.76 4.84-1.8-1.79-1.41 1.41 1.79 1.79zM4 10.5H1v2h3zm9-9.95h-2V3.5h2zm7.45 3.91-1.41-1.41-1.79 1.79 1.41 1.41zm-3.21 13.7 1.79 1.8 1.41-1.41-1.8-1.79zM20 10.5v2h3v-2zm-8-5c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6m-1 16.95h2V19.5h-2zm-7.45-3.91 1.41 1.41 1.79-1.8-1.41-1.41z"})),no="construction",Es="dpr_draft_",zo=[{key:"on track",label:"On Track",color:"success"},{key:"delayed",label:"Delayed",color:"warning"},{key:"halted",label:"Halted",color:"error"}],ln=()=>{var _t;const o=or(),{user:s}=rr(),l=hr("(max-width:600px)"),u=n.useRef(null),y=n.useRef(null),[w,x]=n.useState([]),[p,z]=n.useState(""),[R,C]=n.useState("list"),[k,F]=n.useState(0),_=["Details","Compliance","Location","Photo","Review"],[g,G]=n.useState({site_supervisor_id:"",work_completed:"",equipment_used:"",weather_conditions:"",safety_compliance_report:"",material_consumption:"",site_issues:"",site_execution_status:"on track",progress_percent:"",milestone:""}),[X,Y]=n.useState([]),[ie,re]=n.useState([]),[Ce,Ie]=n.useState([]),[D,_e]=n.useState({latitude:null,longitude:null,accuracy:null,timestamp:null,error:"",loading:!1,permission:"prompt"}),[A,O]=n.useState(""),[N,q]=n.useState(null),[I,Ke]=n.useState(!1),[Qe,U]=n.useState({open:!1,severity:"success",message:""}),[Me,Ee]=n.useState(!1),[Ye,nt]=n.useState(!1),[it,be]=n.useState([]),[V,we]=n.useState(!1),[Je,ae]=n.useState(!1),[b,ye]=n.useState(null),[Ne,J]=n.useState(!1),[fe,Ze]=n.useState([]),[at,le]=n.useState([]),[Fe,Xe]=n.useState(!1),[se,lt]=n.useState(!1),[S,ce]=n.useState(!1),[M,ve]=n.useState(null),[K,Oe]=n.useState({item:null,quantity:"",unit_price:"",requested_by:""}),[ze,Se]=n.useState(!1),Be=n.useMemo(()=>{if(!s)return!1;const t=!!(s!=null&&s.is_admin),r=((s==null?void 0:s.role)||"").toString().toLowerCase(),d=(Array.isArray(s==null?void 0:s.groups)?s.groups:[]).map(B=>typeof B=="string"?B:(B==null?void 0:B.name)||(B==null?void 0:B.title)||(B==null?void 0:B.slug)||"").filter(Boolean).map(B=>B.toString().toLowerCase()),h=d.some(B=>B&&B!=="site supervisor"),L=d.length===0||!h;return t||!(r==="site supervisor"&&L)},[s]),[ht,$e]=n.useState(!1),[De,W]=n.useState([]),[v,te]=n.useState(""),[me,Q]=n.useState(!1),[qe,Ae]=n.useState([]),[Le,jt]=n.useState(!1),ct=n.useMemo(()=>navigator.userAgent||"unknown",[]),gt=n.useCallback(t=>{if(!t)return"-";const r=new Date(t);if(isNaN(r))return"-";const c=String(r.getDate()).padStart(2,"0"),d=String(r.getMonth()+1).padStart(2,"0"),h=r.getFullYear();return`${c}/${d}/${h}`},[]);n.useEffect(()=>{let t=!0;return(async()=>{try{const[r,c]=await Promise.all([bo(),ur()]);t&&(re(Array.isArray(r)?r:[]),Ie(Array.isArray(c)?c:[]))}catch(r){console.error("Failed to load labour resources or vendors",r)}})(),()=>{t=!1}},[]);const ue=n.useCallback(t=>{if(t==null||t==="")return"-";const r=Number(t);if(isNaN(r))return`â‚¹ ${t}`;try{return`â‚¹ ${new Intl.NumberFormat("en-IN",{maximumFractionDigits:2}).format(r)}`}catch{return`â‚¹ ${r}`}},[]),et=n.useMemo(()=>To({shape:{borderRadius:14},typography:{fontFamily:'Quicksand, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif',fontSize:15,body1:{fontSize:"0.98rem"},body2:{fontSize:"0.92rem"},button:{fontSize:"0.96rem"},h6:{fontWeight:700}},palette:{primary:{main:"#57B79D"},secondary:{main:"#FFB672"},info:{main:"#FEB4A9"},text:{primary:"#021A2D"}},components:{MuiChip:{defaultProps:{size:"medium"},styleOverrides:{root:{borderRadius:999},outlinedPrimary:{backgroundColor:"rgba(87,183,157,0.08)"},outlinedInfo:{backgroundColor:"rgba(254,180,169,0.10)"},outlinedSecondary:{backgroundColor:"rgba(255,182,114,0.10)"}}},MuiButton:{defaultProps:{size:"medium"},styleOverrides:{root:{textTransform:"none",borderRadius:10,padding:"8px 16px"}}},MuiPaper:{styleOverrides:{root:{borderRadius:16}}},MuiCard:{styleOverrides:{root:{borderRadius:16}}},MuiOutlinedInput:{styleOverrides:{root:{borderRadius:12,"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#57B79D"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#57B79D",borderWidth:2}},notchedOutline:{borderRadius:12},input:{paddingTop:10,paddingBottom:10}}},MuiDialog:{styleOverrides:{paper:{borderRadius:18}}}}}),[]);n.useEffect(()=>{const t="quicksand-font-link";if(!document.getElementById(t)){const r=document.createElement("link");r.id=t,r.rel="stylesheet",r.href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap",document.head.appendChild(r)}},[]);const je=n.useMemo(()=>`${Es}${p||"no_project"}`,[p]),We=n.useCallback(t=>typeof t=="string"?t.replace(/\w\S*/g,r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()):t,[]),Re=n.useCallback(t=>{if(!t)return"-";const r=typeof t=="object"&&t!==null?t:{category:String(t)},c=We(r.category||""),d=r.subcategory?` â€” ${We(r.subcategory)}`:"";return`${c}${d}`},[We]),tt=n.useCallback(t=>{if(!t)return"-";const r=t.category?Re(t.category):"(No Category)";let c="";if(t.vendor){const d=(Ce||[]).find(L=>String(L.vendor_id)===String(t.vendor)),h=d!=null&&d.vendor_name?` (${d.vendor_name})`:"";c=` â€¢ ${t.vendor}${h}`}return`${r}${c}`},[Re,Ce]),Pe=(t,r)=>G(c=>({...c,[t]:r})),ot=n.useCallback(t=>{if(!t)return;const r=()=>{const c=new Date;c.setHours(9,0,0,0);const d=c.getFullYear(),h=String(c.getMonth()+1).padStart(2,"0"),L=String(c.getDate()).padStart(2,"0"),P=String(c.getHours()).padStart(2,"0"),B=String(c.getMinutes()).padStart(2,"0");return`${d}-${h}-${L}T${P}:${B}`};Y(c=>c.some(h=>String(h.labour_resource)===String(t.id))?c:[...c,{labour_resource:t.id,number_of_workers:"",work_hours:"",date:r()}])},[]),ft=n.useCallback((t,r,c)=>{Y(d=>d.map(h=>String(h.labour_resource)===String(t)?{...h,[r]:c}:h))},[]),$t=n.useCallback(t=>{Y(r=>r.filter(c=>String(c.labour_resource)!==String(t)))},[]);n.useEffect(()=>{let t=!0;return(async()=>{try{const r=await ar();t&&x(Array.isArray(r)?r:[])}catch(r){console.error("Failed to load projects",r)}})(),()=>{t=!1}},[]),n.useEffect(()=>{try{const t=localStorage.getItem(je);if(t){const r=JSON.parse(t);G(r.form||{}),O(r.photoPreview||""),Y(Array.isArray(r.labourUsage)?r.labourUsage:[]),Ee(!0),U({open:!0,severity:"success",message:"Draft restored"})}else G(r=>({...r})),Y([])}catch{}},[je]),n.useEffect(()=>{(async()=>{if(!p){be([]);return}we(!0);try{const r=await yo(),c=Array.isArray(r)?r.filter(d=>String(d.project)===String(p)):[];c.sort((d,h)=>new Date(h.created_at||h.updated_at||0)-new Date(d.created_at||d.updated_at||0)),be(c)}catch(r){console.error("Failed to load reports",r)}finally{we(!1)}})()},[p]),n.useEffect(()=>{(async()=>{if(!p){Ae([]);return}try{jt(!0);const r=await cr(p);Ae(Array.isArray(r)?r:[])}catch(r){console.error("Failed to load milestones",r),Ae([])}finally{jt(!1)}})()},[p]);const Ve=n.useCallback(()=>{if(!p){U({open:!0,severity:"info",message:"Select a project first"});return}$e(!0)},[p]),dt=n.useCallback(()=>{$e(!1)},[]),xt=n.useCallback(t=>{t&&W(r=>r.some(d=>{var h;return((h=d.item)==null?void 0:h.item_id)===t.item_id})?r:[...r,{item:t,quantity:""}])},[]),At=n.useCallback((t,r)=>{W(c=>c.map(d=>{var h;return((h=d.item)==null?void 0:h.item_id)===t?{...d,quantity:r}:d}))},[]),Lt=n.useCallback(t=>{W(r=>r.filter(c=>{var d;return((d=c.item)==null?void 0:d.item_id)!==t}))},[]),Ct=n.useCallback(async()=>{var r;if(!p){U({open:!0,severity:"warning",message:"Project is required"});return}const t=De.filter(c=>c.item&&c.quantity&&Number(c.quantity)>0).map(c=>({material:c.item.item_id,project:p,material_name:c.item.item_name,quantity_used:c.quantity}));if(t.length===0){U({open:!0,severity:"warning",message:"Add at least one item with quantity"});return}try{Q(!0);for(const h of t)await lr(h);const c=t.map(h=>`${h.material} - ${h.material_name}: ${h.quantity_used}`).join(", "),d=v!=null&&v.trim()?`${c}. Notes: ${v.trim()}`:c;G(h=>({...h,material_consumption:d})),U({open:!0,severity:"success",message:"Material consumption recorded"}),$e(!1)}catch(c){const d=(r=c==null?void 0:c.response)!=null&&r.data?JSON.stringify(c.response.data):c.message;U({open:!0,severity:"error",message:d||"Failed to save material consumption"})}finally{Q(!1)}},[De,v,p]);n.useEffect(()=>{let t=!0;return(async()=>{try{Xe(!0);const r=await mr();t&&Ze(Array.isArray(r)?r:[])}catch(r){console.error("Failed to load inventory",r)}finally{Xe(!1)}})(),()=>{t=!1}},[]),n.useEffect(()=>{let t=!0;return(async()=>{if(!p){le([]);return}try{lt(!0);const r=await vo(),c=(Array.isArray(r)?r:[]).filter(d=>String(d.project)===String(p));t&&le(c)}catch(r){console.error("Failed to load procurements",r)}finally{lt(!1)}})(),()=>{t=!1}},[p]);const Wt=n.useCallback(()=>{if(!p){U({open:!0,severity:"info",message:"Select a project to request materials"});return}Oe({item:null,quantity:"",unit_price:"",requested_by:""}),J(!0)},[p]),rt=n.useCallback(()=>J(!1),[]),pe=n.useCallback(async()=>{var t;if(!p){U({open:!0,severity:"warning",message:"Project is required"});return}if(!K.item){U({open:!0,severity:"warning",message:"Select an item"});return}if(!K.quantity){U({open:!0,severity:"warning",message:"Enter quantity"});return}try{const r=new FormData;r.append("project",p),r.append("material_name",K.item.item_name||""),r.append("material_code",K.item.item_id||""),r.append("quantity_requested",String(K.quantity)),K.unit_price&&r.append("unit_price",String(K.unit_price)),r.append("requested_by",K.requested_by||""),r.append("request_date",new Date().toISOString().slice(0,10)),r.append("approval_status","Pending"),r.append("payment_status","Pending"),await pr(r),U({open:!0,severity:"success",message:"Material request submitted"}),J(!1);try{const c=await vo(),d=(Array.isArray(c)?c:[]).filter(h=>String(h.project)===String(p));le(d)}catch{}}catch(r){const c=(t=r==null?void 0:r.response)!=null&&t.data?JSON.stringify(r.response.data):r.message;U({open:!0,severity:"error",message:c||"Failed to submit"})}},[p,K]),de=n.useCallback(t=>{ve(t),ce(!0)},[]),Te=n.useCallback(()=>{ce(!1),ve(null)},[]),bt=n.useCallback(t=>{ye(t),ae(!0)},[]),yt=n.useCallback(()=>{ae(!1),ye(null)},[]);n.useEffect(()=>{const t=setTimeout(()=>{try{const r={form:g,photoPreview:A,labourUsage:X};localStorage.setItem(je,JSON.stringify(r))}catch{}},400);return()=>clearTimeout(t)},[g,A,X,je]);const a=n.useCallback(()=>{try{localStorage.removeItem(je),U({open:!0,severity:"success",message:"Draft cleared"})}catch{}},[je]),i=n.useCallback(()=>{if(!("geolocation"in navigator)){_e(t=>({...t,error:"Geolocation not supported",permission:"denied"}));return}_e(t=>({...t,loading:!0,error:""})),navigator.geolocation.getCurrentPosition(t=>{_e({latitude:t.coords.latitude,longitude:t.coords.longitude,accuracy:t.coords.accuracy,timestamp:t.timestamp?new Date(t.timestamp).toISOString():new Date().toISOString(),error:"",loading:!1,permission:"granted"})},t=>{_e(r=>({...r,error:t.message||"Location permission denied",loading:!1,permission:"denied"}))},{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})},[]);n.useEffect(()=>{Ye||(nt(!0),i())},[Ye,i]);const f=()=>{u.current&&u.current.click()},T=async(t,r)=>{const c=new Image,d=URL.createObjectURL(t);return new Promise((h,L)=>{c.onload=async()=>{try{const P=y.current;if(!P)return L(new Error("Canvas not found"));const B=1280,Rt=c.width>B?B/c.width:1,ut=Math.round(c.width*Rt),Vt=Math.round(c.height*Rt);P.width=ut,P.height=Vt;const He=P.getContext("2d");He.drawImage(c,0,0,ut,Vt);const wt=[];if(r.latitude&&r.longitude&&wt.push(`Lat: ${Number(r.latitude).toFixed(6)}, Lng: ${Number(r.longitude).toFixed(6)}`),r.timestamp){const pt=new Date(r.timestamp);wt.push(`Time: ${pt.toLocaleString()}`)}He.font=`${Math.max(14,Math.round(ut*.018))}px sans-serif`,He.fillStyle="rgba(0,0,0,0.55)",He.textBaseline="bottom";const Ht=8,po=Math.max(18,Math.round(ut*.024)),mo=wt.reduce((pt,Ot)=>Math.max(pt,He.measureText(Ot).width),0)+Ht*2,ho=po*wt.length+Ht*2,go=ut-mo-10,fo=Vt-10;He.fillRect(go,fo-ho,mo,ho),He.fillStyle="white",wt.forEach((pt,Ot)=>{He.fillText(pt,go+Ht,fo-Ht-(wt.length-1-Ot)*po)}),P.toBlob(pt=>{if(!pt)return L(new Error("Failed to export image"));const Ot=P.toDataURL("image/jpeg",.9);h({blob:pt,preview:Ot})},"image/jpeg",.9)}catch(P){L(P)}finally{URL.revokeObjectURL(d)}},c.onerror=()=>{URL.revokeObjectURL(d),L(new Error("Failed to load image"))},c.src=d})},j=async t=>{var c;const r=(c=t.target.files)==null?void 0:c[0];if(r)try{const{blob:d,preview:h}=await T(r,{latitude:D.latitude,longitude:D.longitude,timestamp:D.timestamp||new Date().toISOString()});q(d),O(h),U({open:!0,severity:"success",message:"Photo captured"})}catch(d){console.error(d),U({open:!0,severity:"error",message:"Failed to process photo"})}finally{t.target.value=""}},ee=()=>{var c,d;const t=[];p||t.push("Project is required"),(c=g.site_supervisor_id)!=null&&c.trim()||t.push("Supervisor ID is required"),(d=g.work_completed)!=null&&d.trim()||t.push("Work completed is required"),g.site_execution_status||t.push("Status is required"),g.milestone||t.push("Milestone is required");const r=Number(g.progress_percent);return(g.progress_percent===""||isNaN(r)||r<0||r>100)&&t.push("Valid progress percent (0-100) is required"),t.length?(U({open:!0,severity:"error",message:t[0]}),!1):!0},oe=async()=>{var t;if(ee()){Ke(!0);try{const r=new FormData;r.append("project",p),r.append("site_supervisor_id",g.site_supervisor_id),r.append("work_completed",g.work_completed),r.append("equipment_used",g.equipment_used||""),r.append("weather_conditions",g.weather_conditions||""),r.append("safety_compliance_report",g.safety_compliance_report||""),r.append("material_consumption",g.material_consumption||""),g.site_issues&&r.append("site_issues",g.site_issues),r.append("site_execution_status",g.site_execution_status||"on track"),r.append("progress_percent",String(g.progress_percent||"0")),r.append("milestone",String(g.milestone));try{const d=(X||[]).filter(L=>L&&L.labour_resource&&L.number_of_workers&&L.work_hours&&L.date).map(L=>{const P=String(L.date);let B=P;return P&&!P.endsWith("Z")&&(B=P.length===16?`${P}:00Z`:`${P}Z`),{labour_resource:Number(L.labour_resource),number_of_workers:Number(L.number_of_workers),work_hours:Number(L.work_hours),date:B}});if((X||[]).length>0&&d.length===0){U({open:!0,severity:"warning",message:"Complete Labour Usage rows (resource, workers, hours, date) or remove them."}),Ke(!1);return}console.log("DEBUG labour_usage_input (array):",d),r.append("labour_usage_input",JSON.stringify(d||[]))}catch{}D.latitude!=null&&r.append("latitude",String(D.latitude)),D.longitude!=null&&r.append("longitude",String(D.longitude)),D.accuracy!=null&&r.append("location_accuracy",String(D.accuracy)),D.timestamp&&r.append("location_timestamp",D.timestamp),ct&&r.append("device_id",ct),N&&r.append("photo_evidence",N,"evidence.jpg");try{for(const[d,h]of r.entries())console.log("DEBUG FormData entry:",d,h)}catch(d){console.warn("DEBUG could not iterate FormData entries:",d)}const c=await dr(r);U({open:!0,severity:"success",message:`Saved! Site ID: ${(c==null?void 0:c.site_id)||"generated"}`}),G({site_supervisor_id:"",work_completed:"",equipment_used:"",weather_conditions:"",safety_compliance_report:"",material_consumption:"",site_issues:"",site_execution_status:"on track",progress_percent:"",milestone:""}),Y([]),q(null),O(""),a(),C("list"),F(0);try{const d=await yo(),h=Array.isArray(d)?d.filter(L=>String(L.project)===String(p)):[];h.sort((L,P)=>new Date(P.created_at||P.updated_at||0)-new Date(L.created_at||L.updated_at||0)),be(h)}catch{}}catch(r){console.error("Submit failed",r);const c=(t=r==null?void 0:r.response)!=null&&t.data?JSON.stringify(r.response.data):(r==null?void 0:r.message)||"Submit failed";U({open:!0,severity:"error",message:c})}finally{Ke(!1)}}},he=n.useCallback(()=>{var t;try{let r="";const c=localStorage.getItem("userInfo");if(c){const d=JSON.parse(c);r=(d==null?void 0:d.user_id)||(d==null?void 0:d.userid)||(d==null?void 0:d.userId)||(d==null?void 0:d.id)||((t=d==null?void 0:d.profile)==null?void 0:t.user_id)||""}if(!r){const d=getLoggedInUserInfo==null?void 0:getLoggedInUserInfo();r=(d==null?void 0:d.user_id)||""}return r}catch{return""}},[]);return n.useEffect(()=>{const t=()=>{const r=he();r&&!g.site_supervisor_id&&G(c=>({...c,site_supervisor_id:r}))};return t(),window.addEventListener("userInfoUpdated",t),()=>window.removeEventListener("userInfoUpdated",t)},[g.site_supervisor_id,he]),n.useEffect(()=>{if(!g.site_supervisor_id){const t=he();t&&G(r=>({...r,site_supervisor_id:t}))}},[Me]),n.useEffect(()=>{if(R==="form"&&!g.site_supervisor_id){const t=he();t&&G(r=>({...r,site_supervisor_id:t}))}},[R,g.site_supervisor_id,he]),e.jsxs(Dr,{theme:et,children:[e.jsx(xs,{}),e.jsxs(H,{sx:{pb:10},children:[e.jsx("canvas",{ref:y,style:{display:"none"}}),e.jsx(Nr,{position:"sticky",elevation:0,sx:{backgroundColor:"background.paper",boxShadow:"none",borderBottom:t=>`1px solid ${t.palette.divider}`},children:e.jsxs(fr,{sx:{minHeight:56,alignItems:"center",gap:1},children:[Be&&e.jsx(eo,{title:"Back to Admin Dashboard",children:e.jsx(Jt,{color:"primary",size:"small",onClick:()=>o("/dashboard"),sx:{mr:1},children:e.jsx(Ps,{fontSize:"small"})})}),e.jsx(m,{variant:"h6",sx:{flex:1,color:"text.primary",fontWeight:600},children:"Site Execution Supervisor"}),e.jsx(eo,{title:"Logout",children:e.jsx(Jt,{color:"error",size:"small",onClick:()=>Se(!0),children:e.jsx(sr,{fontSize:"small"})})}),e.jsx(st,{label:((_t=zo.find(t=>t.key===g.site_execution_status))==null?void 0:_t.label)||"Status",color:"primary",size:"small",variant:"outlined"})]})}),e.jsxs(H,{sx:{p:0},children:[n.useEffect(()=>{let t=!0;return(async()=>{try{const r=await bo();t&&re(Array.isArray(r)?r:[])}catch(r){console.error("Failed to load labour resources",r)}})(),()=>{t=!1}},[]),R==="list"&&e.jsxs(H,{sx:{position:"relative",overflow:"hidden",px:2,pt:2,pb:6,background:"linear-gradient(135deg, rgba(87,183,157,0.18) 0%, rgba(255,182,114,0.12) 100%)",color:"text.primary",borderBottomLeftRadius:28,borderBottom:t=>`1px solid ${t.palette.divider}`},children:[e.jsx(H,{sx:{position:"absolute",right:-30,top:-30,width:140,height:140,bgcolor:"primary.main",opacity:.12,borderRadius:"50%"}}),e.jsx(H,{sx:{position:"absolute",right:40,top:-10,width:60,height:60,bgcolor:"secondary.main",opacity:.14,borderRadius:"50%"}}),e.jsxs($,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(m,{variant:"h6",sx:{flex:1},children:"Today"}),e.jsx(st,{size:"small",color:"primary",variant:"filled",label:new Date().toLocaleDateString(),sx:{bgcolor:"primary.main",color:t=>t.palette.getContrastText(t.palette.primary.main),"& .MuiChip-label":{fontWeight:700}}})]}),e.jsx(m,{variant:"body2",sx:{mt:.5,color:"text.primary",fontWeight:500},children:"Log your daily progress, capture a photo and location."}),e.jsx(H,{component:"svg",viewBox:"0 0 1440 80",preserveAspectRatio:"none",sx:{position:"absolute",left:0,right:0,bottom:-1,height:40,width:"100%"},children:e.jsx("path",{fill:"currentColor",fillOpacity:"0.06",d:"M0,64L60,53.3C120,43,240,21,360,21.3C480,21,600,43,720,58.7C840,75,960,85,1080,69.3C1200,53,1320,11,1380,-5.3L1440,-21L1440,81L1380,81C1320,81,1200,81,1080,81C960,81,840,81,720,81C600,81,480,81,360,81C240,81,120,81,60,81L0,81Z"})})]}),e.jsx(So,{elevation:0,sx:{border:"none",borderRadius:2,mt:0,mx:2,mb:2,backgroundColor:"background.paper",boxShadow:"0 6px 20px rgba(0,0,0,0.06)",p:1},children:e.jsx(jo,{children:e.jsxs($,{spacing:2,children:[e.jsx(Z,{select:!0,label:"Project",fullWidth:!0,size:"small",required:!0,value:p,onChange:t=>z(t.target.value),children:w.map((t,r)=>e.jsx(xr,{value:t.project_id,children:t.project_id},r))}),!p&&e.jsx(m,{variant:"caption",color:"text.secondary",sx:{pl:.5},children:"Select a project to add today's report."}),e.jsxs($,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(m,{variant:"subtitle1",sx:{color:"text.secondary",flex:1},children:"Previous Reports"}),e.jsx(kt,{slug:"construction",action:"can_create",children:e.jsx(xe,{size:"small",variant:"outlined",onClick:Wt,disabled:!p,children:"Request Materials"})})]}),R==="list"&&e.jsxs(e.Fragment,{children:[V?e.jsxs($,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(Gt,{size:18}),e.jsx(m,{variant:"body2",children:"Loadingâ€¦"})]}):it.length===0?e.jsx(m,{variant:"body2",color:"text.secondary",children:"No reports yet for this project."}):e.jsx($,{spacing:1.5,children:it.slice(0,6).map((t,r)=>e.jsxs($,{direction:"row",alignItems:"center",spacing:2,onClick:()=>bt(t),sx:{p:1.6,borderRadius:1.5,backgroundColor:"background.paper",border:"1px solid",borderColor:"divider",cursor:"pointer",position:"relative","&:before":{content:'""',position:"absolute",left:-10,top:0,bottom:0,width:2,background:"linear-gradient(180deg, #57B79D, transparent)"},"&:hover":{boxShadow:"0 6px 16px rgba(0,0,0,0.06)",transform:"translateY(-1px)",transition:"all .15s ease"}},children:[e.jsx(H,{sx:{width:10,height:10,borderRadius:"50%",bgcolor:"primary.main"}}),e.jsxs(H,{sx:{flex:1},children:[e.jsx(m,{variant:"subtitle2",sx:{lineHeight:1.1},children:t.daily_progress_report_id||t.site_id}),e.jsx(m,{variant:"caption",color:"text.secondary",children:new Date(t.updated_at||t.created_at).toLocaleString()}),e.jsx(m,{variant:"body2",sx:{mt:.5},children:t.work_completed?String(t.work_completed).slice(0,64)+(String(t.work_completed).length>64?"â€¦":""):"-"})]}),e.jsx(st,{label:(t.site_execution_status||"").replace(/\b\w/g,c=>c.toUpperCase()),size:"small",variant:"outlined"})]},`${t.site_id}-${r}`))}),e.jsx(Nt,{sx:{my:1.5}}),e.jsx(m,{variant:"subtitle1",sx:{color:"text.secondary"},children:"Requested Materials"}),se?e.jsxs($,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(Gt,{size:18}),e.jsx(m,{variant:"body2",children:"Loadingâ€¦"})]}):at.length===0?e.jsx(m,{variant:"body2",color:"text.secondary",children:"No material requests for this project."}):e.jsxs($,{spacing:1.5,children:[e.jsxs($,{direction:"row",spacing:2.5,alignItems:"center",sx:{color:"text.secondary",fontSize:12},children:[e.jsx(H,{sx:{width:14,height:6,bgcolor:"warning.light",borderRadius:1}})," ",e.jsx("span",{children:"Approval"}),e.jsx(H,{sx:{width:14,height:6,bgcolor:"info.light",borderRadius:1}})," ",e.jsx("span",{children:"Delivery"}),e.jsx(H,{sx:{width:14,height:6,bgcolor:"success.light",borderRadius:1}})," ",e.jsx("span",{children:"Payment"})]}),at.map((t,r)=>{const c=t.approval_status==="Approved"?50:t.approval_status==="Rejected"?0:20;let d=0;if(t.expected_delivery_date&&t.request_date){const P=new Date(t.request_date),B=new Date(t.expected_delivery_date),Rt=new Date;if(!isNaN(P)&&!isNaN(B)&&B>P){const ut=B-P,He=Math.min(Math.max(Rt-P,0),ut)/ut;d=Math.round(30*He)}else!isNaN(B)&&B<=Rt&&(d=30)}else if(t.expected_delivery_date){const P=new Date(t.expected_delivery_date);d=new Date>=P?30:0}const h=t.payment_status==="Completed"?20:t.payment_status==="Partially Paid"?10:0,L=Math.min(100,c+d+h);return e.jsxs(H,{onClick:()=>de(t),sx:{p:1.6,borderRadius:1.5,border:"1px solid",borderColor:"divider",cursor:"pointer","&:hover":{boxShadow:"0 8px 18px rgba(0,0,0,0.08)"}},children:[e.jsxs($,{direction:"row",alignItems:"center",spacing:1.5,sx:{flexWrap:"wrap",p:1},children:[e.jsx(st,{size:"small",label:t.approval_status,variant:"outlined",color:t.approval_status==="Approved"?"success":t.approval_status==="Rejected"?"error":"warning"}),e.jsx(st,{size:"small",label:"Payment "+t.payment_status,variant:"outlined"})]}),e.jsx($,{direction:"row",alignItems:"center",spacing:1.5,sx:{flexWrap:"wrap"},children:e.jsxs(m,{variant:"subtitle1",sx:{flex:1},children:[t.material_name," (",t.material_code,")"]})}),e.jsxs($,{direction:"row",spacing:2,sx:{mt:1,flexWrap:"wrap",alignItems:"center"},children:[e.jsxs(m,{color:"text.secondary",variant:"caption",sx:{fontWeight:700},children:["Qty: ",t.quantity_requested]}),e.jsxs(m,{variant:"caption",children:["Unit Cost: ",ue(t.unit_price)]}),e.jsxs(m,{variant:"caption",children:["Total Cost: ",ue(t.total_cost)]}),e.jsxs(m,{variant:"caption",sx:{ml:.5,fontWeight:700},children:["Expected: ",t.expected_delivery_date?gt(t.expected_delivery_date):"-"]})]}),e.jsxs(H,{sx:{mt:1.2,height:12,borderRadius:999,overflow:"hidden",display:"flex",border:P=>`1px solid ${P.palette.divider}`,backgroundColor:P=>P.palette.action.hover},children:[e.jsx(H,{sx:{width:`${c}%`,height:"100%",bgcolor:"warning.main"}}),e.jsx(H,{sx:{width:`${d}%`,height:"100%",bgcolor:"info.main"}}),e.jsx(H,{sx:{width:`${h}%`,height:"100%",bgcolor:"success.main"}}),e.jsx(H,{sx:{width:`${Math.max(0,100-L)}%`,height:"100%",bgcolor:"transparent"}})]})]},r)})]})]})]})})}),R==="form"&&e.jsx(So,{elevation:0,sx:{border:"none",borderRadius:0,backgroundColor:"transparent",boxShadow:"none"},children:e.jsxs(jo,{children:[e.jsxs($,{direction:"row",alignItems:"center",sx:{mb:1},children:[e.jsxs(m,{variant:"subtitle2",color:"text.secondary",children:["Step ",k+1," of ",_.length,": ",_[k]]}),e.jsx(H,{sx:{ml:"auto"},children:e.jsx(xe,{size:"small",onClick:()=>C("list"),children:"Cancel"})})]}),e.jsx(_s,{variant:"dots",steps:_.length,position:"static",activeStep:k,sx:{background:"transparent",mb:1,p:0},nextButton:e.jsx("span",{}),backButton:e.jsx("span",{})}),e.jsxs($,{spacing:2,children:[k===0&&e.jsxs(e.Fragment,{children:[e.jsx(m,{variant:"caption",color:"text.secondary",children:"Status*"}),e.jsx($,{direction:"row",spacing:1,sx:{flexWrap:"wrap",gap:1},children:zo.map(t=>e.jsx(st,{label:t.label,color:g.site_execution_status===t.key?"primary":"default",variant:"outlined",size:"small",onClick:()=>Pe("site_execution_status",t.key),sx:{borderRadius:999}},t.key))}),e.jsx(Z,{label:"Site Supervisor ID",required:!0,fullWidth:!0,size:"small",placeholder:"Auto-filled from your account",helperText:"Prefilled with your user ID. You can change it if needed.",value:g.site_supervisor_id,onChange:t=>Pe("site_supervisor_id",t.target.value)}),e.jsx(Z,{label:"Work Completed",required:!0,fullWidth:!0,size:"small",multiline:!0,minRows:3,value:g.work_completed,onChange:t=>Pe("work_completed",t.target.value)}),e.jsxs(H,{sx:{p:1.5,border:"1px dashed",borderColor:"divider",borderRadius:2,backgroundColor:"background.paper"},children:[e.jsx(m,{variant:"subtitle2",sx:{color:"text.secondary"},children:"Labour Usage"}),e.jsx(m,{variant:"caption",color:"text.secondary",children:"Add Labour"}),e.jsx(Qt,{options:ie,getOptionLabel:t=>tt(t),onChange:(t,r)=>ot(r),disablePortal:!0,renderInput:t=>e.jsx(Z,{...t,placeholder:"Search labour category/vendor",size:"small",fullWidth:!0,sx:{mt:.5,mb:1}})}),X.filter(t=>t.labour_resource).length>0&&e.jsx($,{spacing:1,children:X.filter(t=>t.labour_resource).map(t=>{const r=(ie||[]).find(d=>String(d.id)===String(t.labour_resource)),c=r?tt(r):`Resource #${t.labour_resource}`;return e.jsxs($,{direction:{xs:"column",sm:"row"},spacing:1,alignItems:{xs:"stretch",sm:"center"},sx:{p:1.25,border:"1px solid",borderColor:"divider",borderRadius:1},children:[e.jsx(m,{sx:{flex:1},children:c}),e.jsx(Z,{label:"# Workers",type:"number",size:"small",value:t.number_of_workers,onChange:d=>ft(t.labour_resource,"number_of_workers",d.target.value),sx:{width:{xs:"100%",sm:140}}}),e.jsx(Z,{label:"Work Hours",type:"number",size:"small",value:t.work_hours,onChange:d=>ft(t.labour_resource,"work_hours",d.target.value),sx:{width:{xs:"100%",sm:140}}}),e.jsx(Z,{label:"Date/Time",type:"datetime-local",size:"small",InputLabelProps:{shrink:!0},value:t.date,onChange:d=>ft(t.labour_resource,"date",d.target.value),sx:{width:{xs:"100%",sm:220}}}),e.jsx(xe,{color:"error",onClick:()=>$t(t.labour_resource),children:"Remove"})]},t.labour_resource||Math.random())})})]}),e.jsx(Z,{label:"Equipment Used",required:!0,fullWidth:!0,size:"small",multiline:!0,minRows:2,value:g.equipment_used,onChange:t=>Pe("equipment_used",t.target.value)}),e.jsx(Z,{label:"Weather Conditions",required:!0,fullWidth:!0,size:"small",value:g.weather_conditions,onChange:t=>Pe("weather_conditions",t.target.value)}),e.jsx(Qt,{options:qe,getOptionLabel:t=>t!=null&&t.name?`${t.name}`:"",loading:Le,value:qe.find(t=>String(t.id)===String(g.milestone))||null,onChange:(t,r)=>Pe("milestone",(r==null?void 0:r.id)||""),isOptionEqualToValue:(t,r)=>String(t.id)===String(r.id),disabled:!p,renderInput:t=>e.jsx(Z,{...t,label:"Milestone",required:!0,size:"small",helperText:p?"":"Select a project to load milestones"})}),e.jsx(Z,{label:"Progress (%)",required:!0,type:"number",inputProps:{min:0,max:100},fullWidth:!0,size:"small",value:g.progress_percent,onChange:t=>Pe("progress_percent",t.target.value)})]}),k===1&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{label:"Safety Compliance Report",required:!0,fullWidth:!0,size:"small",multiline:!0,minRows:3,value:g.safety_compliance_report,onChange:t=>Pe("safety_compliance_report",t.target.value)}),e.jsxs($,{spacing:1,children:[e.jsxs($,{direction:{xs:"column",sm:"row"},spacing:1,alignItems:{xs:"stretch",sm:"center"},children:[e.jsx(Z,{label:"Material Consumption (summary)",fullWidth:!0,size:"small",value:g.material_consumption,placeholder:"Click to select materials used",multiline:!0,minRows:2,InputProps:{readOnly:!0},onClick:Ve}),e.jsx(xe,{variant:"outlined",onClick:Ve,children:"Select Materials"})]}),e.jsx(Z,{label:"Material Consumption Notes (optional)",fullWidth:!0,size:"small",value:v,onChange:t=>te(t.target.value),placeholder:"Add any extra notes regarding material consumption",multiline:!0,minRows:2})]}),e.jsx(Z,{label:"Site Issues (optional)",fullWidth:!0,size:"small",multiline:!0,minRows:2,value:g.site_issues,onChange:t=>Pe("site_issues",t.target.value)})]}),k===2&&e.jsxs(e.Fragment,{children:[e.jsxs($,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(xe,{variant:"outlined",size:"small",startIcon:e.jsx(Ls,{}),onClick:i,disabled:D.loading,children:D.loading?"Fetching Locationâ€¦":"Enable Location"}),D.latitude&&D.longitude?e.jsx(m,{variant:"body2",color:"text.secondary",children:`Lat: ${Number(D.latitude).toFixed(6)}, Lng: ${Number(D.longitude).toFixed(6)}${D.accuracy?` (Â±${Math.round(D.accuracy)}m)`:""}`}):e.jsx(m,{variant:"body2",color:"text.secondary",children:"Location not available"})]}),D.error&&e.jsx(xo,{severity:"warning",variant:"outlined",children:D.error})]}),k===3&&e.jsxs(e.Fragment,{children:[A&&e.jsxs(H,{sx:{borderRadius:2,overflow:"hidden"},children:[e.jsx(Ro,{component:"img",image:A,alt:"Photo evidence",sx:{maxHeight:420,objectFit:"contain",borderRadius:2,boxShadow:"none"}}),e.jsx(m,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:.5},children:"Location stamped on image when available."})]}),!A&&e.jsx(m,{variant:"body2",color:"text.secondary",children:"Tap the camera button to capture a photo."})]}),k===4&&e.jsxs(e.Fragment,{children:[e.jsx(m,{variant:"subtitle2",children:"Review"}),e.jsxs($,{spacing:.5,children:[e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Project:"})," ",p||"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Status:"})," ",g.site_execution_status]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Supervisor:"})," ",g.site_supervisor_id||"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Work:"})," ",g.work_completed||"-"]}),e.jsx(m,{variant:"body2",children:e.jsx("strong",{children:"Labour Usage:"})}),e.jsx(H,{sx:{pl:1},children:X&&X.length>0?e.jsx($,{spacing:.25,children:X.map((t,r)=>{const c=(ie||[]).find(L=>String(L.id)===String(t.labour_resource)),d=c?tt(c):t.labour_resource?`Resource #${t.labour_resource}`:"(No Resource)",h=t.date?(()=>{const L=new Date(t.date);return isNaN(L)?t.date:L.toLocaleString()})():"-";return e.jsxs(m,{variant:"body2",color:"text.secondary",children:["â€¢ ",d,": ",t.number_of_workers||"-"," workers, ",t.work_hours||"-"," hrs, ",h]},r)})}):e.jsx(m,{variant:"body2",color:"text.secondary",children:"-"})}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Equipment:"})," ",g.equipment_used||"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Weather:"})," ",g.weather_conditions||"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Safety:"})," ",g.safety_compliance_report||"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Materials:"})," ",g.material_consumption||"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Issues:"})," ",g.site_issues||"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Location:"})," ",D.latitude&&D.longitude?`${D.latitude}, ${D.longitude}`:"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Photo:"})," ",A?"Attached":"Not attached"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Milestone:"})," ",(()=>{const t=qe.find(r=>String(r.id)===String(g.milestone));return t?`${t.name} (#${t.id})`:"-"})()]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Progress:"})," ",g.progress_percent!==""?`${g.progress_percent}%`:"-"]})]})]}),e.jsxs($,{direction:"row",spacing:1,sx:{pt:1},children:[e.jsx(xe,{size:"small",disabled:k===0,onClick:()=>F(t=>Math.max(0,t-1)),children:"Back"}),k<_.length-1?e.jsx(xe,{variant:"contained",size:"small",onClick:()=>F(t=>Math.min(_.length-1,t+1)),children:"Next"}):e.jsx(kt,{slug:no,action:"can_create",children:e.jsx(xe,{variant:"contained",size:"small",onClick:oe,disabled:I,children:I?e.jsx(Gt,{size:18,sx:{color:"white"}}):"Submit"})})]})]})]})})]}),e.jsx("input",{ref:u,type:"file",accept:"image/*",capture:"user",onChange:j,style:{display:"none"}}),R==="list"?e.jsx(kt,{slug:no,action:"can_create",children:e.jsx(eo,{title:p?"Add today's report":"Select a project to add a report",placement:"left",children:e.jsx("span",{onClick:()=>{p||U({open:!0,severity:"info",message:"Select a project to add today's report"})},children:e.jsx(Co,{color:"primary",onClick:()=>{p&&(C("form"),F(0))},"aria-label":"add",disabled:!p,sx:{position:"fixed",right:16,bottom:16,boxShadow:1,backgroundColor:"primary.main",color:"primary.contrastText","&:hover":{backgroundColor:"primary.dark",boxShadow:2},"&.Mui-disabled":{backgroundColor:t=>t.palette.action.disabledBackground,color:t=>t.palette.action.disabled,boxShadow:"none"}},children:e.jsx(ws,{})})})})}):k===3?e.jsx(kt,{slug:no,action:"can_create",children:e.jsx(Co,{color:"primary",onClick:f,"aria-label":"capture",sx:{position:"fixed",right:16,bottom:16,boxShadow:4,background:"linear-gradient(135deg, #7267ef 0%, #9a94ff 100%)"},children:e.jsx(Is,{})})}):null,e.jsx(nr,{open:Qe.open,autoHideDuration:3500,onClose:()=>U(t=>({...t,open:!1})),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(xo,{onClose:()=>U(t=>({...t,open:!1})),severity:Qe.severity,variant:"filled",sx:{width:"100%"},children:Qe.message})}),e.jsxs(Dt,{open:Je,onClose:yt,fullWidth:!0,maxWidth:"sm",children:[e.jsx(zt,{sx:{p:0},children:b&&e.jsxs(H,{sx:{px:2,py:2,background:"linear-gradient(135deg, rgba(87,183,157,0.08) 0%, rgba(255,182,114,0.08) 100%)",borderBottom:t=>`1px solid ${t.palette.divider}`},children:[e.jsxs($,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(ks,{sx:{fontSize:16}}),e.jsx(m,{variant:"subtitle1",sx:{fontWeight:700},children:b.daily_progress_report_id||b.site_id}),e.jsx(H,{sx:{flex:1}}),e.jsx(st,{size:"small",label:(b.site_execution_status||"").replace(/\b\w/g,t=>t.toUpperCase()),color:"primary",variant:"outlined"})]}),e.jsx($,{direction:"row",spacing:2,sx:{mt:.5},children:e.jsxs($,{direction:"row",alignItems:"center",spacing:.5,children:[e.jsx(Oo,{sx:{fontSize:16}}),e.jsxs(m,{variant:"caption",children:["Updated ",new Date(b.updated_at||b.created_at).toLocaleString()]})]})})]})}),e.jsx(Tt,{dividers:!0,sx:{p:0},children:b?e.jsx(H,{sx:{p:2},children:e.jsxs($,{spacing:2,children:[e.jsxs(H,{sx:{p:2,border:"1px solid",borderColor:"divider",borderRadius:2},children:[e.jsx(m,{variant:"overline",color:"text.secondary",children:"Overview"}),e.jsxs(ne,{container:!0,spacing:1.5,sx:{mt:.5},children:[e.jsx(ne,{item:!0,xs:12,sm:6,children:e.jsxs($,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Rs,{sx:{fontSize:16}}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Supervisor:"})," ",b.site_supervisor_id]})]})}),e.jsx(ne,{item:!0,xs:12,sm:6,children:e.jsxs($,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Ms,{sx:{fontSize:16}}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Project:"})," ",b.project]})]})}),e.jsx(ne,{item:!0,xs:12,sm:6,children:e.jsxs($,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Do,{sx:{fontSize:16}}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Milestone:"})," ",(()=>{const t=qe.find(r=>String(r.id)===String(b.milestone));return t?`${t.name} (#${t.id})`:b.milestone?`#${b.milestone}`:"â€”"})()]})]})}),e.jsx(ne,{item:!0,xs:12,sm:6,children:e.jsxs($,{spacing:.5,children:[e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Progress:"})," ",b.progress_percent!=null?`${b.progress_percent}%`:"â€”"]}),b.progress_percent!=null&&e.jsx(Fo,{variant:"determinate",value:Number(b.progress_percent)||0})]})})]})]}),e.jsxs(H,{sx:{p:2,border:"1px solid",borderColor:"divider",borderRadius:2},children:[e.jsx(m,{variant:"overline",color:"text.secondary",children:"Work & Resources"}),e.jsx(Nt,{sx:{my:1}}),e.jsxs(ne,{container:!0,spacing:1.5,children:[e.jsx(ne,{item:!0,xs:12,children:e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Work Completed:"})," ",b.work_completed||"-"]})}),e.jsx(ne,{item:!0,xs:12,sm:6,children:e.jsxs($,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Do,{sx:{fontSize:16}}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Equipment:"})," ",b.equipment_used||"-"]})]})}),e.jsx(ne,{item:!0,xs:12,sm:6,children:e.jsxs($,{direction:"row",spacing:1,alignItems:"flex-start",children:[e.jsx(As,{sx:{fontSize:16,mt:.4}}),e.jsxs(H,{sx:{flex:1},children:[e.jsx(m,{variant:"body2",sx:{mb:.25},children:e.jsx("strong",{children:"Labour Usage:"})}),(()=>{const t=Array.isArray(b.labour_usage)?b.labour_usage:[];return t.length?e.jsx($,{spacing:.25,children:t.map((r,c)=>{const d=(ie||[]).find(P=>String(P.id)===String(r.labour_resource)),h=d?tt(d):r.labour_resource?`Resource #${r.labour_resource}`:"(No Resource)",L=r.date?(()=>{const P=new Date(r.date);return isNaN(P)?r.date:P.toLocaleString()})():"â€”";return e.jsxs(m,{variant:"body2",color:"text.secondary",children:["â€¢ ",h,": ",r.number_of_workers??"â€”"," workers, ",r.work_hours??"â€”"," hrs, ",L]},c)})}):e.jsx(m,{variant:"body2",color:"text.secondary",children:"â€”"})})()]})]})}),e.jsx(ne,{item:!0,xs:12,sm:6,children:e.jsxs($,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Ts,{sx:{fontSize:16}}),e.jsx(m,{variant:"body2",children:e.jsx("strong",{children:"Weather:"})}),e.jsx(st,{size:"small",color:"info",variant:"outlined",label:b.weather_conditions||"-"})]})})]})]}),e.jsxs(H,{sx:{p:2,border:"1px solid",borderColor:"divider",borderRadius:2},children:[e.jsx(m,{variant:"overline",color:"text.secondary",children:"Safety & Materials"}),e.jsx(Nt,{sx:{my:1}}),e.jsxs(ne,{container:!0,spacing:1.5,children:[e.jsx(ne,{item:!0,xs:12,children:e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Safety:"})," ",b.safety_compliance_report||"-"]})}),e.jsx(ne,{item:!0,xs:12,children:e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Materials:"})," ",b.material_consumption||"-"]})}),!!b.site_issues&&e.jsx(ne,{item:!0,xs:12,children:e.jsxs($,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(zs,{color:"warning",sx:{fontSize:16}}),e.jsxs(m,{variant:"body2",color:"error",children:[e.jsx("strong",{children:"Issues:"})," ",b.site_issues]})]})})]})]}),e.jsxs(H,{sx:{p:2,border:"1px solid",borderColor:"divider",borderRadius:2},children:[e.jsx(m,{variant:"overline",color:"text.secondary",children:"Location & System"}),e.jsx(Nt,{sx:{my:1}}),e.jsxs(ne,{container:!0,spacing:1.5,children:[e.jsx(ne,{item:!0,xs:12,sm:6,children:e.jsxs($,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Os,{sx:{fontSize:16}}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Location:"})," ",b.latitude&&b.longitude?`${b.latitude}, ${b.longitude}`:"â€”"]})]})}),e.jsx(ne,{item:!0,xs:12,sm:6,children:e.jsxs($,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Oo,{sx:{fontSize:16}}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Location Time:"})," ",b.location_timestamp?new Date(b.location_timestamp).toLocaleString():"â€”"]})]})}),e.jsx(ne,{item:!0,xs:12,sm:6,children:e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Check-in:"})," ",b.checkin_time?new Date(b.checkin_time).toLocaleString():"â€”"]})}),e.jsx(ne,{item:!0,xs:12,sm:6,children:e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Check-out:"})," ",b.checkout_time?new Date(b.checkout_time).toLocaleString():"â€”"]})}),e.jsx(ne,{item:!0,xs:12,sm:6,children:e.jsxs($,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx($s,{sx:{fontSize:16}}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Device:"})," ",b.device_id||"â€”"]})]})}),e.jsx(ne,{item:!0,xs:12,sm:6,children:e.jsxs($,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Ds,{sx:{fontSize:16}}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"IP:"})," ",b.ip_address||"â€”"]})]})})]})]}),!!b.photo_evidence&&e.jsxs(H,{sx:{p:2,border:"1px solid",borderColor:"divider",borderRadius:2},children:[e.jsx(m,{variant:"overline",color:"text.secondary",children:"Photo Evidence"}),e.jsx(Nt,{sx:{my:1}}),e.jsx(Ro,{component:"img",src:b.photo_evidence,alt:"Photo",sx:{borderRadius:1,maxHeight:360,objectFit:"contain"}})]})]})}):null}),e.jsx(Et,{children:e.jsx(xe,{onClick:yt,children:"Close"})})]}),e.jsxs(Dt,{open:ht,onClose:dt,fullWidth:!0,maxWidth:"sm",fullScreen:l,children:[e.jsx(zt,{children:"Select Materials Used"}),e.jsx(Tt,{dividers:!0,children:e.jsxs($,{spacing:2,children:[e.jsx(m,{variant:"caption",color:"text.secondary",children:"Project"}),e.jsx(Z,{value:p||"",fullWidth:!0,size:"small",disabled:!0}),e.jsx(m,{variant:"caption",color:"text.secondary",children:"Add Item"}),e.jsx(Qt,{options:fe,loading:Fe,getOptionLabel:t=>t!=null&&t.item_name?`${t.item_id} - ${t.item_name}`:"",onChange:(t,r)=>xt(r),disablePortal:!0,renderInput:t=>e.jsx(Z,{...t,placeholder:"Search items",size:"small",fullWidth:!0})}),De.length>0&&e.jsx($,{spacing:1,children:De.map(t=>e.jsxs($,{direction:{xs:"column",sm:"row"},spacing:1,alignItems:{xs:"stretch",sm:"center"},sx:{p:1.25,border:"1px solid",borderColor:"divider",borderRadius:1},children:[e.jsxs(m,{sx:{flex:1},children:[t.item.item_id," - ",t.item.item_name]}),e.jsx(Z,{label:"Quantity Used",type:"number",size:"small",value:t.quantity,onChange:r=>At(t.item.item_id,r.target.value),sx:{width:"100%"}}),e.jsx(xe,{color:"error",onClick:()=>Lt(t.item.item_id),children:"Remove"})]},t.item.item_id))}),e.jsx(Z,{label:"Notes (optional)",size:"small",fullWidth:!0,value:v,onChange:t=>te(t.target.value),multiline:!0,minRows:2})]})}),e.jsxs(Et,{children:[e.jsx(xe,{onClick:dt,children:"Cancel"}),e.jsx(kt,{slug:"construction",action:"can_create",children:e.jsx(xe,{variant:"contained",onClick:Ct,disabled:me,children:me?e.jsx(Gt,{size:18,sx:{color:"white"}}):"Save Consumption"})})]})]}),e.jsxs(Dt,{open:S,onClose:Te,fullWidth:!0,maxWidth:"sm",children:[e.jsx(zt,{children:"Material Request Details"}),e.jsx(Tt,{dividers:!0,children:M&&e.jsxs($,{spacing:1.2,children:[e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Item:"})," ",M.material_name," (",M.material_code,")"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Quantity:"})," ",M.quantity_requested]}),e.jsxs(m,{variant:"body2",sx:{fontWeight:700},children:["Unit Cost: ",ue(M.unit_price)]}),e.jsxs(m,{variant:"body2",sx:{fontWeight:700},children:["Total Cost: ",ue(M.total_cost)]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Approval Status:"})," ",M.approval_status]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Payment Status:"})," ",M.payment_status]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Expected Delivery:"})," ",M.expected_delivery_date?gt(M.expected_delivery_date):"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Requested By:"})," ",M.requested_by||"-"]}),e.jsxs(m,{variant:"body2",children:[e.jsx("strong",{children:"Request Date:"})," ",M.request_date?gt(M.request_date):"-"]})]})}),e.jsx(Et,{children:e.jsx(xe,{onClick:Te,children:"Close"})})]}),e.jsxs(Dt,{open:Ne,onClose:rt,fullWidth:!0,maxWidth:"sm",children:[e.jsx(zt,{children:"Request Materials"}),e.jsx(Tt,{dividers:!0,children:e.jsxs($,{spacing:2,children:[e.jsx(m,{variant:"caption",color:"text.secondary",children:"Project"}),e.jsx(Z,{value:p||"",fullWidth:!0,size:"small",disabled:!0}),e.jsx(m,{variant:"caption",color:"text.secondary",children:"Item"}),e.jsx(Qt,{options:fe,loading:Fe,getOptionLabel:t=>t!=null&&t.item_name?`${t.item_name} (${t.item_id})`:"",value:K.item,onChange:(t,r)=>Oe(c=>({...c,item:r})),renderInput:t=>e.jsx(Z,{...t,placeholder:"Search items",size:"small"})}),e.jsxs($,{direction:{xs:"column",sm:"row"},spacing:1,children:[e.jsx(Z,{label:"Quantity",type:"number",size:"small",fullWidth:!0,value:K.quantity,onChange:t=>Oe(r=>({...r,quantity:t.target.value}))}),e.jsx(Z,{label:"Unit Price (optional)",type:"number",size:"small",fullWidth:!0,value:K.unit_price,onChange:t=>Oe(r=>({...r,unit_price:t.target.value}))})]}),e.jsx(Z,{label:"Requested By",size:"small",fullWidth:!0,value:K.requested_by,onChange:t=>Oe(r=>({...r,requested_by:t.target.value}))})]})}),e.jsxs(Et,{children:[e.jsx(xe,{onClick:rt,children:"Cancel"}),e.jsx(kt,{slug:"construction",action:"can_create",children:e.jsx(xe,{variant:"contained",onClick:pe,children:"Submit Request"})})]})]}),e.jsxs(Dt,{open:ze,onClose:()=>Se(!1),maxWidth:"xs",fullWidth:!0,children:[e.jsx(zt,{children:"Confirm Logout"}),e.jsx(Tt,{children:e.jsx(m,{variant:"body2",children:"Are you sure you want to logout?"})}),e.jsxs(Et,{children:[e.jsx(xe,{onClick:()=>Se(!1),children:"Cancel"}),e.jsx(xe,{color:"error",variant:"contained",onClick:ir,children:"Logout"})]})]})]})]})};export{ln as default};
