import{r as i,j as e,T as v,z as P}from"./main-IxGEKZMA.js";import{C as Q}from"./Close-DoqWsXz3.js";import{g as q}from"./engineering-BuN6Pdrr.js";import{a as z,b as J,e as U,f as V}from"./commision-C73dLlpE.js";import{G as n}from"./Grid-C72N-tAO.js";import{t as E,T as w,h as T,i as h,j as s,k as N,I as p,D as W,f as K,g as X,e as F}from"./TableRow-CRAT5KT_.js";import{A as Z}from"./AddCircle-DWIRGPUh.js";import{T as ee}from"./TableContainer-BaU58JEj.js";import{E as re}from"./Edit-g2hjeeYC.js";import{D as se}from"./Delete-cHl_EB0l.js";import{D as te}from"./DialogActions-D5wP0Mt-.js";import"./Transition-C29ZPDdz.js";const ve=()=>{const[g,L]=i.useState(""),[f,A]=i.useState(""),[k,m]=i.useState(!1),[D,b]=i.useState(""),[o,c]=i.useState({}),[_,y]=i.useState([]),[j,u]=i.useState(!1),[ne,S]=i.useState(null),[R,O]=i.useState([]),[C,I]=i.useState(null),B=r=>{b(r);const t=new Date().getFullYear(),d=(_.length+1).toString().padStart(3,"0");c({handoverprocessID:`HND-${t}-${d}`,projectId:r}),u(!1),S(null),m(!0)};i.useEffect(()=>{(async()=>{try{const t=await q();O(t)}catch(t){console.error("❌ Error fetching projects:",t)}})()},[]);const H=async()=>{try{const r=await z();y(r)}catch(r){console.error("❌ Error fetching handovers:",r)}};i.useEffect(()=>{H()},[]);const $=r=>{c({handoverprocessID:r.handover_id,handoverDate:r.handover_date,receivingDepartment:r.receiving_department,handoverDocID:r.handover_document_id,componentList:r.system_component_list,trainingprovided:r.training_provided?"true":"false",document:r.training_documentation,issues:r.pending_issues,approvalStatus:r.final_approval_status}),I(r.handover_id),b(r.project_id),u(!0),m(!0)},Y=async r=>{if(window.confirm(`Are you sure you want to delete Handover ID: ${r}?`))try{await J(r),y(a=>a.filter(d=>d.handover_id!==r)),alert(`✅ Handover ID ${r} deleted successfully!`)}catch(a){console.error("❌ Error deleting handover:",a),alert("⚠️ Failed to delete handover. Please try again.")}},x=()=>{m(!1),c({}),u(!1),S(null)},l=r=>{const{name:t,value:a}=r.target;c(d=>({...d,[t]:a}))},G=async r=>{r.preventDefault();try{if(!o.handoverDocID||!o.componentList||!o.approvalStatus){alert("⚠️ Please fill in all required fields!");return}const t={project_id:D,handover_date:o.handoverDate,receiving_department:o.receivingDepartment,handover_document_id:o.handoverDocID,system_component_list:o.componentList,training_provided:o.trainingprovided==="true",training_documentation:o.document,pending_issues:o.issues,final_approval_status:o.approvalStatus};if(j&&C){const a=await U(C,t);alert(`✏️ Handover updated successfully! Handover ID: ${a.data.handover_id}`)}else{const a=await V(t);alert(`✅ Handover submitted successfully! Handover ID: ${a.data.handover_id}`)}H(),c({handoverprocessID:"",handoverDate:"",receivingDepartment:"",handoverDocID:"",componentList:"",trainingprovided:"",document:"",issues:"",approvalStatus:""}),u(!1),I(null),x()}catch(t){console.error("❌ Submission error:",t),alert("⚠️ Submission failed! Please check your input.")}},M=_.filter(r=>Object.values(r).some(t=>t&&t.toString().toLowerCase().includes(f.toLowerCase())));return e.jsxs(e.Fragment,{children:[e.jsx(v,{variant:"h5",gutterBottom:!0,sx:{mt:5},children:"Handover Process"}),e.jsx(n,{container:!0,spacing:2,direction:"column",sx:{mb:2},children:e.jsx(n,{item:!0,xs:12,children:e.jsxs(E,{sx:{p:2,backgroundColor:"#fff",border:"1px solid #ccc"},children:[e.jsx(v,{variant:"h6",gutterBottom:!0,children:"PROJECT RECORDS"}),e.jsx(P,{sx:{my:2,mx:1},children:e.jsx("input",{type:"text",placeholder:"Search Project ID",value:g,onChange:r=>L(r.target.value),className:"input",style:{width:"100%",padding:"8px",border:"1px solid #ccc",borderRadius:4}})}),e.jsxs(w,{children:[e.jsx(T,{children:e.jsxs(h,{children:[e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project ID"})}),e.jsx(s,{sx:{display:"flex",justifyContent:"flex-end",color:"#660000"},children:e.jsx("strong",{children:"Action"})})]})}),e.jsx(N,{children:R.filter(r=>{var t;return(t=r.id)==null?void 0:t.toString().toLowerCase().includes(g.toLowerCase())}).map((r,t)=>e.jsxs(h,{children:[e.jsx(s,{children:r.project_id}),e.jsx(s,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(p,{onClick:()=>B(r.project_id),color:"primary",children:e.jsx(Z,{sx:{color:"#7267ef"}})})})]},t))})]})]})})}),e.jsx(n,{container:!0,spacing:2,children:e.jsx(n,{item:!0,xs:12,children:e.jsxs(E,{sx:{p:2,backgroundColor:"#fff",border:"1px solid #ccc"},children:[e.jsx(v,{variant:"h6",gutterBottom:!0,children:"HANDOVER PROCESS DETAILS"}),e.jsx("input",{type:"text",placeholder:"Search Handover Process",value:f,onChange:r=>A(r.target.value),className:"input",style:{width:"100%",padding:"8px",border:"1px solid #ccc",borderRadius:4,marginBottom:"16px"}}),e.jsx(ee,{sx:{maxHeight:400,overflow:"auto",border:"1px solid #ddd"},children:e.jsxs(w,{stickyHeader:!0,children:[e.jsx(T,{children:e.jsxs(h,{children:[e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project ID"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Handover ID"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Handover Date"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Receiving Department"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Handover Document ID"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"System/Component List"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Training Provided"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Training Documentation"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Pending Issues"})}),e.jsx(s,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Final Approval"})}),e.jsx(s,{sx:{color:"#660000"},children:e.jsx("strong",{children:"Actions"})})]})}),e.jsx(N,{children:M.map((r,t)=>e.jsxs(h,{children:[e.jsx(s,{children:r.project_id}),e.jsx(s,{children:r.handover_id}),e.jsx(s,{children:r.handover_date}),e.jsx(s,{children:r.receiving_department}),e.jsx(s,{children:r.handover_document_id}),e.jsx(s,{children:r.system_component_list}),e.jsx(s,{children:r.training_provided===!0?"YES":r.training_provided===!1?"NO":"-"}),e.jsx(s,{children:r.training_documentation}),e.jsx(s,{children:r.pending_issues}),e.jsx(s,{children:r.final_approval_status}),e.jsxs(s,{children:[e.jsx(p,{onClick:()=>$(r),color:"warning",children:e.jsx(re,{sx:{color:"orange"}})}),e.jsx(p,{onClick:()=>Y(r.handover_id),color:"error",children:e.jsx(se,{sx:{color:"red"}})})]})]},t))})]})})]})})}),e.jsxs(W,{open:k,onClose:x,fullWidth:!0,children:[e.jsx(K,{children:j?"Edit Handover Process":"Enter Handover Process Details"}),e.jsxs(X,{sx:{position:"relative"},children:[e.jsx(p,{"aria-label":"close",onClick:x,sx:{position:"absolute",right:8,top:8,color:r=>r.palette.grey[500]},children:e.jsx(Q,{})}),e.jsx(P,{component:"form",sx:{mt:2},children:e.jsxs(n,{container:!0,spacing:3,direction:"column",children:[e.jsxs(n,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Project Information"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(n,{container:!0,spacing:2,children:[e.jsxs(n,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"projectId",children:"Project ID"}),e.jsx("input",{id:"projectId",className:"input",value:D||"",disabled:!0})]}),e.jsxs(n,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"handoverprocessID",children:"Handover ID"}),e.jsx("input",{id:"handoverprocessID",className:"input",value:o.handoverprocessID||"",disabled:!0})]})]})]}),e.jsxs(n,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Handover Information"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(n,{container:!0,spacing:2,children:[e.jsxs(n,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"handoverDate",children:"Handover Date"}),e.jsx("input",{type:"date",id:"handoverDate",name:"handoverDate",className:"input",value:o.handoverDate||"",onChange:l})]}),e.jsxs(n,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"receivingDepartment",children:"Recieving Department"}),e.jsx("input",{id:"receivingDepartment",name:"receivingDepartment",className:"input",value:o.receivingDepartment||"",onChange:l})]}),e.jsxs(n,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"handoverDocID",children:"Handover DocumentID"}),e.jsx("input",{id:"handoverDocID",name:"handoverDocID",className:"input",value:o.handoverDocID||"",onChange:l})]}),e.jsxs(n,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"componentList",children:"System/Component List"}),e.jsx("input",{id:"componentList",name:"componentList",className:"input",value:o.componentList||"",onChange:l})]}),e.jsxs(n,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"trainingprovided",children:"Training Provided"}),e.jsxs("select",{id:"trainingprovided",name:"trainingprovided",className:"input",value:o.trainingprovided||"",onChange:l,children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"true",children:"YES"}),e.jsx("option",{value:"false",children:"NO"})]})]}),e.jsxs(n,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"document",children:"Training Documentation"}),e.jsx("input",{id:"document",name:"document",className:"input",value:o.document||"",onChange:l})]})]}),e.jsxs(n,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Pending Issues & Final Status"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(n,{container:!0,spacing:2,children:[e.jsxs(n,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"issues",children:"Pending Issues"}),e.jsx("input",{id:"issues",name:"issues",className:"input",value:o.issues||"",onChange:l})]}),e.jsxs(n,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"approvalStatus",children:"Approval Status"}),e.jsxs("select",{id:"approvalStatus",name:"approvalStatus",className:"input",value:o.approvalStatus||"",onChange:l,children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"Approved",children:"Approved"}),e.jsx("option",{value:"Conditional",children:"Conditional"}),e.jsx("option",{value:"Pending",children:"Pending"})]})]})]})]})]})]})})]}),e.jsxs(te,{children:[e.jsx(F,{onClick:x,sx:{outline:"2px solid #800000",color:"#800000","&:hover":{outline:"2px solid #b30000",color:"#b30000"}},children:"Cancel"}),e.jsx(F,{variant:"outlined",onClick:G,sx:{borderColor:"#7267ef",color:"#7267ef","&:hover":{borderColor:"#9e8df2",color:"#9e8df2"}},children:j?"Update":"Submit"})]})]})]})};export{ve as default};
