import{r as c,j as e,S as k,D as w,T as U}from"./main-BIxdd69i.js";import{E as B}from"./jspdf.plugin.autotable-y_YJgUzU.js";import{C as G}from"./Close-D340Gps3.js";import{g as Y,u as H,c as J,d as Q}from"./inventory-Bcy74QM6.js";import{e as x,D as K,f as V,I as h,g as q,h as X,P as Z}from"./DialogTitle-D59uELMl.js";import{M as ee,a as te}from"./minimize-2-Dl_U24Qm.js";import{G as o}from"./Grid-BnZNKmae.js";import{T as se,a as re,b as N,c as a,d as ae}from"./TableRow-D8X36zJO.js";import{E as ne}from"./Edit-BJV-h6Li.js";import{D as oe}from"./Delete-BHKbKfZ2.js";import{T as le}from"./TablePagination-B2UmV3Uz.js";import"./index-E3WhgaTq.js";import"./KeyboardArrowRight-H8WcZOfv.js";import"./Select-CcRDAcIa.js";import"./dividerClasses-BHbp2fTT.js";import"./MenuItem-BSRQ3XbJ.js";import"./Toolbar-CZiWvmFk.js";const be=()=>{const d="inventory",[y,M]=c.useState(""),[D,I]=c.useState(!1),[l,P]=c.useState(null),[_,L]=c.useState([]),[g,E]=c.useState(!1),[r,p]=c.useState({itemName:"",category:"",netWeight:"",unitOfMeasure:"",minStockLevel:"",maxStockLevel:"",reorderLevel:"",storageLocation:"",itemStatus:"Active"}),O=()=>{E(!g)},j=async()=>{try{const t=await Y();L(t)}catch(t){console.error("❌ Error fetching items:",t)}};c.useEffect(()=>{j()},[]);const[v,b]=c.useState(0),[m,T]=c.useState(5),C=(t=null)=>{P(t),I(!0),p(t?{itemId:t.item_id||"",itemName:t.item_name||"",category:t.category||"",netWeight:t.net_weight||"",unitOfMeasure:t.unit_of_measure||"",minStockLevel:t.minimum_stock_level||"",maxStockLevel:t.maximum_stock_level||"",reorderLevel:t.reorder_level||"",storageLocation:t.storage_location||"",itemStatus:t.item_status||""}:{itemId:"",itemName:"",category:"",netWeight:"",unitOfMeasure:"",minStockLevel:"",maxStockLevel:"",reorderLevel:"",storageLocation:"",itemStatus:""})},u=()=>I(!1),i=t=>{const{name:s,value:n}=t.target;p(S=>({...S,[s]:n}))},W=()=>{const t=new Date().getFullYear(),s=_.length+1;return`ITM-${t}-${String(s).padStart(4,"0")}`},R=async()=>{if(!(Number(r.minStockLevel)<Number(r.reorderLevel)&&Number(r.reorderLevel)<Number(r.maxStockLevel))){alert(`⚠️ Validation Error:
Ensure that: Minimum Stock Level < Reorder Level < Maximum Stock Level`);return}const t=new FormData;t.append("item_name",r.itemName),t.append("category",r.category),t.append("net_weight",r.netWeight||0),t.append("unit_of_measure",r.unitOfMeasure),t.append("minimum_stock_level",r.minStockLevel||0),t.append("maximum_stock_level",r.maxStockLevel||0),t.append("reorder_level",r.reorderLevel||0),t.append("storage_location",r.storageLocation),t.append("item_status",r.itemStatus);try{let s;l&&l.item_id?(s=await H(l.item_id,t),alert(`✅ Item ${l.item_id} updated successfully!`),await j()):(s=await J(t),alert(`✅ Item Created Successfully!
Item ID: ${s.item_id||"N/A"}`),await j()),u()}catch(s){if(console.error("❌ Error:",s),s.response&&s.response.data){let n=typeof s.response.data=="string"?s.response.data:JSON.stringify(s.response.data);alert(`⚠️ Failed to save item:
${n}`)}else alert("⚠️ Failed to save item. Please try again.")}},A=async t=>{if(window.confirm(`Are you sure you want to delete item ${t}?`))try{const s=await Q(t);alert(`✅ Item ${t} deleted successfully!`),L(n=>n.filter(S=>S.item_id!==t))}catch(s){console.error("❌ Error deleting item:",s),s.response&&s.response.data?alert(`⚠️ Failed to delete item:
${JSON.stringify(s.response.data)}`):alert("⚠️ Failed to delete item. Please try again.")}},f=_.filter(t=>Object.values(t).some(s=>s&&s.toString().toLowerCase().includes(y.toLowerCase()))),F=(t,s)=>{b(s)},$=t=>{T(parseInt(t.target.value,10)),b(0)},z=()=>{const t=new B,s=f.map(n=>[n.itemId,n.itemName,n.category,n.netWeight,n.unitOfMeasure,n.minStockLevel,n.maxStockLevel,n.reorderLevel,n.storageLocation,n.itemStatus]);t.autoTable({head:[["Item ID","Name","Category","Net Weight","Unit","Min Stock","Max Stock","Reorder Level","Storage Location","Status"]],body:s}),t.save("inventory_report.pdf")};return e.jsxs("div",{children:[e.jsx(k,{slug:d,action:"can_create",children:e.jsx(x,{variant:"contained",sx:{mt:4,mb:2,backgroundColor:"#7267ef"},onClick:()=>C(),children:"Add Item"})}),e.jsxs(K,{open:D,onClose:u,fullWidth:!0,maxWidth:"xl",PaperProps:{style:g?{width:"100%",height:"100vh",margin:0}:{width:"70%",height:"97vh"}},children:[e.jsxs(V,{sx:{backgroundColor:"#f3f3f3",color:"#7267ef",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[l?"Edit Inventory Item":"Add Inventory Item",e.jsx(h,{onClick:u,sx:{color:"#7267ef"},children:e.jsx(G,{})})]}),e.jsxs(q,{sx:{position:"relative",overflowY:"auto"},children:[e.jsx(h,{"aria-label":"toggle-size",onClick:O,sx:{position:"absolute",right:40,top:8,color:t=>t.palette.grey[600]},children:g?e.jsx(ee,{}):e.jsx(te,{})}),e.jsxs(o,{container:!0,spacing:2,direction:"column",sx:{mt:1},children:[e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Item ID"}),e.jsx("input",{className:"input",disabled:!0,value:l?l.item_id:W()})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Item Name"}),e.jsx("input",{className:"input",name:"itemName",value:r.itemName,onChange:i,placeholder:"e.g., Steel Rods"})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Category"}),e.jsx("input",{className:"input",name:"category",value:r.category,onChange:i,placeholder:"e.g., Raw Materials"})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Net Weight"}),e.jsx("input",{className:"input",name:"netWeight",value:r.netWeight,onChange:i,placeholder:"e.g., 70"})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Unit of Measure"}),e.jsx("input",{className:"input",name:"unitOfMeasure",value:r.unitOfMeasure,onChange:i,placeholder:"e.g., KG"})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Minimum Stock Level"}),e.jsx("input",{className:"input",name:"minStockLevel",type:"number",value:r.minStockLevel,onChange:i})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Maximum Stock Level"}),e.jsx("input",{className:"input",name:"maxStockLevel",type:"number",value:r.maxStockLevel,onChange:i})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Reorder Level"}),e.jsx("input",{className:"input",name:"reorderLevel",type:"number",value:r.reorderLevel,onChange:i})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Storage Location"}),e.jsx("input",{className:"input",name:"storageLocation",value:r.storageLocation,onChange:i,placeholder:"e.g., Warehouse A"})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Item Status"}),e.jsxs("select",{className:"input",name:"itemStatus",value:r.itemStatus,onChange:i,children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"}),e.jsx("option",{value:"Discontinued",children:"Discontinued"})]})]})]})]}),e.jsxs(X,{sx:{pr:3,pb:2},children:[e.jsx(x,{onClick:u,sx:{outline:"2px solid #800000",color:"#800000"},children:"Cancel"}),e.jsx(w,{slug:d,action:l?"can_update":"can_create",children:e.jsx(x,{variant:"outlined",onClick:R,sx:{borderColor:"#7267ef",color:"#7267ef"},children:l?"Update":"Submit"})})]})]}),e.jsxs(Z,{sx:{mt:4,p:2,border:"1px solid #ccc"},children:[e.jsxs(o,{container:!0,justifyContent:"space-between",alignItems:"center",children:[e.jsx(o,{item:!0,children:e.jsx(U,{variant:"h6",gutterBottom:!0,sx:{color:"#7267ef"},children:"Inventory Items Report"})}),e.jsx(o,{item:!0,children:e.jsx(x,{onClick:z,sx:{backgroundColor:"#7267ef",color:"#fff",mt:2,mb:2},children:"Export PDF"})})]}),e.jsx("input",{type:"text",placeholder:"Search Item Details Here....",value:y,onChange:t=>M(t.target.value),className:"input"}),e.jsxs(se,{children:[e.jsx(re,{children:e.jsxs(N,{children:[e.jsx(a,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Item ID"})}),e.jsx(a,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Name"})}),e.jsx(a,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Category"})}),e.jsx(a,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Net Weight"})}),e.jsx(a,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Unit"})}),e.jsx(a,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Min"})}),e.jsx(a,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Max"})}),e.jsx(a,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Reorder"})}),e.jsx(a,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Location"})}),e.jsx(a,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Status"})}),e.jsx(a,{sx:{color:"#660000"},children:e.jsx("strong",{children:"Actions"})})]})}),e.jsx(ae,{children:f.slice(v*m,v*m+m).map((t,s)=>e.jsxs(N,{children:[e.jsx(a,{children:t.item_id}),e.jsx(a,{children:t.item_name}),e.jsx(a,{children:t.category}),e.jsx(a,{children:t.net_weight}),e.jsx(a,{children:t.unit_of_measure}),e.jsx(a,{children:t.minimum_stock_level}),e.jsx(a,{children:t.maximum_stock_level}),e.jsx(a,{children:t.reorder_level}),e.jsx(a,{children:t.storage_location}),e.jsx(a,{children:t.item_status}),e.jsxs(a,{children:[e.jsx(w,{slug:d,action:"can_update",children:e.jsx(h,{color:"warning",onClick:()=>C(t),children:e.jsx(ne,{sx:{color:"orange"}})})}),e.jsx(k,{slug:d,action:"can_delete",children:e.jsx(h,{color:"error",onClick:()=>A(t.item_id),children:e.jsx(oe,{sx:{color:"red"}})})})]})]},s))})]}),e.jsx(le,{rowsPerPageOptions:[5,10,25],component:"div",count:f.length,rowsPerPage:m,page:v,onPageChange:F,onRowsPerPageChange:$})]})]})};export{be as default};
