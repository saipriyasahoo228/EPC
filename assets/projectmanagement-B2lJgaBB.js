import{r as l,j as e,T as C,x as M,S,D as v}from"./main-BIxdd69i.js";import{C as q}from"./Close-D340Gps3.js";import{g as Y}from"./engineering-4VzvUWDc.js";import{f as K,d as V,u as X,c as Z}from"./construction-TCh-rxln.js";import{G as s}from"./Grid-BnZNKmae.js";import{P as I,I as j,D as ee,f as te,g as re,h as oe,e as T}from"./DialogTitle-D59uELMl.js";import{T as w,a as E,b as u,c as r,d as B}from"./TableRow-D8X36zJO.js";import{A as se}from"./AddCircle-Bn9h5MaP.js";import{T as ne}from"./TableContainer-1Xqyy-f8.js";import{E as ce}from"./Edit-BJV-h6Li.js";import{D as ae}from"./Delete-BHKbKfZ2.js";import{M as le,a as ie}from"./minimize-2-Dl_U24Qm.js";const _e=()=>{const x="construction",[de,b]=l.useState(null),[A,F]=l.useState(""),[_,L]=l.useState(""),[k,h]=l.useState(!1),[p,m]=l.useState(""),[D,R]=l.useState([]),[O,z]=l.useState([]),[g,N]=l.useState(!1),[f,U]=l.useState(!1),[o,d]=l.useState({project:"",projectName:"",projectType:"",clientName:"",projectLocation:"",startDate:"",endDate:"",projectManagerId:"",projectManagerName:"",projectStatus:"planning",projectBudget:"",projectMilestones:"",resourceAllocation:""}),G=()=>{U(!f)};l.useEffect(()=>{(async()=>{try{const n=await Y();R(n)}catch(n){console.error("Error fetching projects:",n)}})()},[]);const P=async()=>{try{const t=await K();console.log("✅ Construction Projects:",t),z(t)}catch(t){console.error("❌ Failed to load construction projects:",t)}};l.useEffect(()=>{P()},[]);const H=(t,n=null)=>{m(t),b(n),d(n!==null?D[n]:{}),h(!0)},y=()=>{h(!1),b(null),d({})},J=t=>{d({projectName:t.project_name,projectType:t.project_type,clientName:t.client_name,projectLocation:t.project_location,startDate:t.start_date,endDate:t.end_date,projectManagerId:t.project_manager_id,projectManagerName:t.project_manager_name,projectStatus:t.project_status,projectBudget:t.project_budget,projectMilestones:t.project_milestones,resourceAllocation:t.resource_allocation}),m(t.project),N(!0),h(!0)},c=t=>{const{name:n,value:a}=t.target;d(i=>({...i,[n]:a}))},Q=async()=>{var t,n;try{const a={project:p,project_name:o.projectName,project_type:o.projectType,client_name:o.clientName,project_location:o.projectLocation,start_date:o.startDate,end_date:o.endDate,project_manager_id:o.projectManagerId,project_manager_name:o.projectManagerName,project_status:((t=o.projectStatus)==null?void 0:t.toLowerCase())||"planning",project_budget:o.projectBudget,project_milestones:o.projectMilestones,resource_allocation:o.resourceAllocation};let i;g&&p?(i=await X(p,a),console.log("✅ Project updated:",i),alert("Project updated successfully!")):(i=await Z(a),console.log("✅ Project created:",i),alert("Project Details for Construction Submitted Successfully!!")),d({projectName:"",projectType:"",clientName:"",projectLocation:"",startDate:"",endDate:"",projectManagerId:"",projectManagerName:"",projectStatus:"planning",projectBudget:"",projectMilestones:"",resourceAllocation:""}),m(""),N(!1),h(!1),P()}catch(a){if(console.error("❌ Error in project submit:",a),(n=a.response)!=null&&n.data){const i=a.response.data.message||a.response.data.error||Object.values(a.response.data)[0];alert(`Error: ${i}`)}else alert("Error in submitting Project Details for Construction!!")}},W=async t=>{if(window.confirm(`Are you sure you want to delete project with ID: ${t}?`))try{await V(t),alert("✅ Project deleted successfully!"),P()}catch(a){console.error("❌ Error deleting project:",a),alert("❌ Failed to delete project.")}},$=D.filter(t=>Object.values(t).some(n=>n&&n.toString().toLowerCase().includes(_.toLowerCase())));return e.jsxs(e.Fragment,{children:[e.jsx(C,{variant:"h5",gutterBottom:!0,sx:{mt:5},children:"Project Management"}),e.jsx(s,{container:!0,spacing:2,direction:"column",sx:{mb:2},children:e.jsx(s,{item:!0,xs:12,children:e.jsxs(I,{sx:{p:2,backgroundColor:"#fff",border:"1px solid #ccc"},children:[e.jsx(C,{variant:"h6",gutterBottom:!0,children:"PROJECT RECORDS"}),e.jsx(M,{sx:{my:2,mx:1},children:e.jsx("input",{type:"text",placeholder:"Search Project ID",value:A,onChange:t=>F(t.target.value),className:"input",style:{width:"100%",padding:"8px",border:"1px solid #ccc",borderRadius:4}})}),e.jsxs(w,{children:[e.jsx(E,{children:e.jsxs(u,{children:[e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project ID"})}),e.jsx(r,{sx:{display:"flex",justifyContent:"flex-end",color:"#660000"},children:e.jsx("strong",{children:"Action"})})]})}),e.jsx(B,{children:$.map((t,n)=>e.jsxs(u,{children:[e.jsx(r,{children:t.project_id}),e.jsx(r,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(S,{slug:x,action:"can_create",children:e.jsx(j,{onClick:()=>H(t.project_id),color:"primary",children:e.jsx(se,{sx:{color:"#7267ef"}})})})})]},n))})]})]})})}),e.jsx(s,{container:!0,spacing:2,children:e.jsx(s,{item:!0,xs:12,children:e.jsxs(I,{sx:{p:2,backgroundColor:"#fff",border:"1px solid #ccc"},children:[e.jsx(C,{variant:"h6",gutterBottom:!0,children:"SUBMITTED PROJECTS"}),e.jsx("input",{type:"text",placeholder:"Search Projects",value:_,onChange:t=>L(t.target.value),className:"input"}),e.jsx(ne,{sx:{maxHeight:400,overflow:"auto",border:"1px solid #ddd"},children:e.jsxs(w,{stickyHeader:!0,children:[e.jsx(E,{children:e.jsxs(u,{children:[e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project ID"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project Name"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project Type"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Client Name"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project Location"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Start Date"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"End Date"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project Manager Id"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project Manager Name"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project Status"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project Budget"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project Milestones"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Resource Allocation"})}),e.jsx(r,{sx:{color:"#660000"},children:e.jsx("strong",{children:"Actions"})})]})}),e.jsx(B,{children:O.map((t,n)=>e.jsxs(u,{children:[e.jsx(r,{children:t.project}),e.jsx(r,{children:t.project_name}),e.jsx(r,{children:t.project_type}),e.jsx(r,{children:t.client_name}),e.jsx(r,{children:t.project_location}),e.jsx(r,{children:t.start_date}),e.jsx(r,{children:t.end_date}),e.jsx(r,{children:t.project_manager_id}),e.jsx(r,{children:t.project_manager_name}),e.jsx(r,{children:t.project_status}),e.jsx(r,{children:t.project_budget}),e.jsx(r,{children:t.project_milestones}),e.jsx(r,{children:t.resource_allocation}),e.jsxs(r,{children:[e.jsx(v,{slug:x,action:"can_update",children:e.jsx(j,{color:"warning",onClick:()=>J(t),children:e.jsx(ce,{sx:{color:"orange"}})})}),e.jsx(S,{slug:x,action:"can_delete",children:e.jsx(j,{color:"error",onClick:()=>W(t.project),children:e.jsx(ae,{sx:{color:"red"}})})})]})]},n))})]})})]})})}),e.jsxs(ee,{open:k,onClose:y,fullWidth:!0,maxWidth:"xl",PaperProps:{style:f?{width:"100%",height:"100vh",margin:0}:{width:"70%",height:"97vh"}},children:[e.jsx(te,{children:"Enter Project Details"}),e.jsxs(re,{sx:{position:"relative",overflowY:"auto"},children:[e.jsx(j,{"aria-label":"toggle-size",onClick:G,sx:{position:"absolute",right:40,top:8,color:t=>t.palette.grey[600]},children:f?e.jsx(le,{}):e.jsx(ie,{})}),e.jsx(j,{"aria-label":"close",onClick:y,sx:{position:"absolute",right:8,top:8,color:t=>t.palette.grey[500]},children:e.jsx(q,{})}),e.jsx(M,{component:"form",sx:{mt:2},children:e.jsxs(s,{container:!0,spacing:3,direction:"column",children:[e.jsxs(s,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Project Information"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(s,{container:!0,spacing:2,children:[e.jsxs(s,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"projectId",children:"Project ID"}),e.jsx("input",{id:"projectId",className:"input",value:p,disabled:!0})]}),e.jsxs(s,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"projectName",children:"Project Name"}),e.jsx("input",{id:"projectName",name:"projectName",className:"input",value:o.projectName||"",onChange:c})]}),e.jsxs(s,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"projectType",children:"Project Type"}),e.jsx("input",{id:"projectType",name:"projectType",className:"input",value:o.projectType||"",onChange:c})]}),e.jsxs(s,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"clientName",children:"Client Name"}),e.jsx("input",{id:"clientName",name:"clientName",className:"input",value:o.clientName||"",onChange:c})]}),e.jsxs(s,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"projectLocation",children:"Project Location"}),e.jsx("input",{id:"projectLocation",name:"projectLocation",className:"input",value:o.projectLocation||"",onChange:c})]}),e.jsxs(s,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"projectStatus",children:"Project Status"}),e.jsxs("select",{id:"projectStatus",name:"projectStatus",className:"input",value:o.projectStatus||"",onChange:c,children:[e.jsx("option",{value:"planning",children:"Planning"}),e.jsx("option",{value:"in progress",children:"In Progress"}),e.jsx("option",{value:"delayed",children:"Delayed"}),e.jsx("option",{value:"completed",children:"Completed"})]})]})]})]}),e.jsxs(s,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Approval Information"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(s,{container:!0,spacing:2,children:[e.jsxs(s,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"startDate",children:"Start Date"}),e.jsx("input",{type:"date",id:"startDate",name:"startDate",className:"input",value:o.startDate||"",onChange:c})]}),e.jsxs(s,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"endDate",children:"End Date"}),e.jsx("input",{type:"date",id:"endDate",name:"endDate",className:"input",value:o.endDate||"",onChange:c})]}),e.jsxs(s,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"projectManagerId",children:"Project Manager ID"}),e.jsx("input",{id:"projectManagerId",name:"projectManagerId",className:"input",value:o.projectManagerId||"",onChange:c})]}),e.jsxs(s,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"projectManagerName",children:"Project Manager Name"}),e.jsx("input",{id:"projectManagerName",name:"projectManagerName",className:"input",value:o.projectManagerName||"",onChange:c})]})]})]}),e.jsxs(s,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Budget and Requirements"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(s,{container:!0,spacing:2,children:[e.jsxs(s,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"projectBudget",children:"Project Budget"}),e.jsx("input",{id:"projectBudget",name:"projectBudget",className:"input",value:o.projectBudget||"",onChange:c})]}),e.jsxs(s,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"projectMilestones",children:"Project Milestone"}),e.jsx("input",{id:"projectMilestones",name:"projectMilestones",className:"input",value:o.projectMilestones||"",onChange:c})]}),e.jsxs(s,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"resourceAllocation",children:"Resource Allocation"}),e.jsx("input",{id:"resourceAllocation",name:"resourceAllocation",className:"input",value:o.resourceAllocation||"",onChange:c})]})]})]})]})})]}),e.jsxs(oe,{children:[e.jsx(T,{onClick:y,sx:{outline:"2px solid #800000",color:"#800000","&:hover":{outline:"2px solid #b30000",color:"#b30000"}},children:"Cancel"}),e.jsx(v,{slug:x,action:g?"can_update":"can_create",children:e.jsx(T,{variant:"outlined",onClick:Q,sx:{borderColor:"#7267ef",color:"#7267ef","&:hover":{borderColor:"#9e8df2",color:"#9e8df2"}},children:g?"Update Project":"Submit Project"})})]})]})]})};export{_e as default};
