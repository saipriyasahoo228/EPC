import{r as l,j as e,T as f,z as N}from"./main-IxGEKZMA.js";import{C as J}from"./Close-DoqWsXz3.js";import{g as Q}from"./engineering-BuN6Pdrr.js";import{f as U,d as $,u as q,c as z}from"./construction-Ca90qLEO.js";import{G as o}from"./Grid-C72N-tAO.js";import{t as _,T as M,h as S,i as p,j as r,k as v,I as h,D as W,f as K,g as V,e as T}from"./TableRow-CRAT5KT_.js";import{A as X}from"./AddCircle-DWIRGPUh.js";import{T as Y}from"./TableContainer-BaU58JEj.js";import{E as Z}from"./Edit-g2hjeeYC.js";import{D as ee}from"./Delete-cHl_EB0l.js";import{D as te}from"./DialogActions-D5wP0Mt-.js";import"./Transition-C29ZPDdz.js";const ue=()=>{const[re,y]=l.useState(null),[I,E]=l.useState(""),[P,w]=l.useState(""),[B,j]=l.useState(!1),[x,u]=l.useState(""),[C,A]=l.useState([]),[F,L]=l.useState([]),[b,D]=l.useState(!1),[s,d]=l.useState({project:"",projectName:"",projectType:"",clientName:"",projectLocation:"",startDate:"",endDate:"",projectManagerId:"",projectManagerName:"",projectStatus:"planning",projectBudget:"",projectMilestones:"",resourceAllocation:""});l.useEffect(()=>{(async()=>{try{const n=await Q();A(n)}catch(n){console.error("Error fetching projects:",n)}})()},[]);const m=async()=>{try{const t=await U();console.log("✅ Construction Projects:",t),L(t)}catch(t){console.error("❌ Failed to load construction projects:",t)}};l.useEffect(()=>{m()},[]);const k=(t,n=null)=>{u(t),y(n),d(n!==null?C[n]:{}),j(!0)},g=()=>{j(!1),y(null),d({})},R=t=>{d({projectName:t.project_name,projectType:t.project_type,clientName:t.client_name,projectLocation:t.project_location,startDate:t.start_date,endDate:t.end_date,projectManagerId:t.project_manager_id,projectManagerName:t.project_manager_name,projectStatus:t.project_status,projectBudget:t.project_budget,projectMilestones:t.project_milestones,resourceAllocation:t.resource_allocation}),u(t.project),D(!0),j(!0)},c=t=>{const{name:n,value:a}=t.target;d(i=>({...i,[n]:a}))},O=async()=>{var t,n;try{const a={project:x,project_name:s.projectName,project_type:s.projectType,client_name:s.clientName,project_location:s.projectLocation,start_date:s.startDate,end_date:s.endDate,project_manager_id:s.projectManagerId,project_manager_name:s.projectManagerName,project_status:((t=s.projectStatus)==null?void 0:t.toLowerCase())||"planning",project_budget:s.projectBudget,project_milestones:s.projectMilestones,resource_allocation:s.resourceAllocation};let i;b&&x?(i=await q(x,a),console.log("✅ Project updated:",i),alert("Project updated successfully!")):(i=await z(a),console.log("✅ Project created:",i),alert("Project Details for Construction Submitted Successfully!!")),d({projectName:"",projectType:"",clientName:"",projectLocation:"",startDate:"",endDate:"",projectManagerId:"",projectManagerName:"",projectStatus:"planning",projectBudget:"",projectMilestones:"",resourceAllocation:""}),u(""),D(!1),j(!1),m()}catch(a){if(console.error("❌ Error in project submit:",a),(n=a.response)!=null&&n.data){const i=a.response.data.message||a.response.data.error||Object.values(a.response.data)[0];alert(`Error: ${i}`)}else alert("Error in submitting Project Details for Construction!!")}},H=async t=>{if(window.confirm(`Are you sure you want to delete project with ID: ${t}?`))try{await $(t),alert("✅ Project deleted successfully!"),m()}catch(a){console.error("❌ Error deleting project:",a),alert("❌ Failed to delete project.")}},G=C.filter(t=>Object.values(t).some(n=>n&&n.toString().toLowerCase().includes(P.toLowerCase())));return e.jsxs(e.Fragment,{children:[e.jsx(f,{variant:"h5",gutterBottom:!0,sx:{mt:5},children:"Project Management"}),e.jsx(o,{container:!0,spacing:2,direction:"column",sx:{mb:2},children:e.jsx(o,{item:!0,xs:12,children:e.jsxs(_,{sx:{p:2,backgroundColor:"#fff",border:"1px solid #ccc"},children:[e.jsx(f,{variant:"h6",gutterBottom:!0,children:"PROJECT RECORDS"}),e.jsx(N,{sx:{my:2,mx:1},children:e.jsx("input",{type:"text",placeholder:"Search Project ID",value:I,onChange:t=>E(t.target.value),className:"input",style:{width:"100%",padding:"8px",border:"1px solid #ccc",borderRadius:4}})}),e.jsxs(M,{children:[e.jsx(S,{children:e.jsxs(p,{children:[e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project ID"})}),e.jsx(r,{sx:{display:"flex",justifyContent:"flex-end",color:"#660000"},children:e.jsx("strong",{children:"Action"})})]})}),e.jsx(v,{children:G.map((t,n)=>e.jsxs(p,{children:[e.jsx(r,{children:t.project_id}),e.jsx(r,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(h,{onClick:()=>k(t.project_id),color:"primary",children:e.jsx(X,{sx:{color:"#7267ef"}})})})]},n))})]})]})})}),e.jsx(o,{container:!0,spacing:2,children:e.jsx(o,{item:!0,xs:12,children:e.jsxs(_,{sx:{p:2,backgroundColor:"#fff",border:"1px solid #ccc"},children:[e.jsx(f,{variant:"h6",gutterBottom:!0,children:"SUBMITTED PROJECTS"}),e.jsx("input",{type:"text",placeholder:"Search Projects",value:P,onChange:t=>w(t.target.value),className:"input"}),e.jsx(Y,{sx:{maxHeight:400,overflow:"auto",border:"1px solid #ddd"},children:e.jsxs(M,{stickyHeader:!0,children:[e.jsx(S,{children:e.jsxs(p,{children:[e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project ID"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project Name"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project Type"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Client Name"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project Location"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Start Date"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"End Date"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project Manager Id"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project Manager Name"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project Status"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project Budget"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project Milestones"})}),e.jsx(r,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Resource Allocation"})}),e.jsx(r,{sx:{color:"#660000"},children:e.jsx("strong",{children:"Actions"})})]})}),e.jsx(v,{children:F.map((t,n)=>e.jsxs(p,{children:[e.jsx(r,{children:t.project}),e.jsx(r,{children:t.project_name}),e.jsx(r,{children:t.project_type}),e.jsx(r,{children:t.client_name}),e.jsx(r,{children:t.project_location}),e.jsx(r,{children:t.start_date}),e.jsx(r,{children:t.end_date}),e.jsx(r,{children:t.project_manager_id}),e.jsx(r,{children:t.project_manager_name}),e.jsx(r,{children:t.project_status}),e.jsx(r,{children:t.project_budget}),e.jsx(r,{children:t.project_milestones}),e.jsx(r,{children:t.resource_allocation}),e.jsxs(r,{children:[e.jsx(h,{color:"warning",onClick:()=>R(t),children:e.jsx(Z,{sx:{color:"orange"}})}),e.jsx(h,{color:"error",onClick:()=>H(t.project),children:e.jsx(ee,{sx:{color:"red"}})})]})]},n))})]})})]})})}),e.jsxs(W,{open:B,onClose:g,fullWidth:!0,children:[e.jsx(K,{children:"Enter Project Details"}),e.jsxs(V,{sx:{position:"relative"},children:[e.jsx(h,{"aria-label":"close",onClick:g,sx:{position:"absolute",right:8,top:8,color:t=>t.palette.grey[500]},children:e.jsx(J,{})}),e.jsx(N,{component:"form",sx:{mt:2},children:e.jsxs(o,{container:!0,spacing:3,direction:"column",children:[e.jsxs(o,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Project ID "}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsx(o,{container:!0,spacing:2,children:e.jsxs(o,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"projectId",children:"Project ID"}),e.jsx("input",{id:"projectId",className:"input",value:x,disabled:!0})]})})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Project Information"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(o,{container:!0,spacing:2,children:[e.jsxs(o,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"projectName",children:"Project Name"}),e.jsx("input",{id:"projectName",name:"projectName",className:"input",value:s.projectName||"",onChange:c})]}),e.jsxs(o,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"projectType",children:"Project Type"}),e.jsx("input",{id:"projectType",name:"projectType",className:"input",value:s.projectType||"",onChange:c})]}),e.jsxs(o,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"clientName",children:"Client Name"}),e.jsx("input",{id:"clientName",name:"clientName",className:"input",value:s.clientName||"",onChange:c})]}),e.jsxs(o,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"projectLocation",children:"Project Location"}),e.jsx("input",{id:"projectLocation",name:"projectLocation",className:"input",value:s.projectLocation||"",onChange:c})]})]})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Approval Information"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(o,{container:!0,spacing:2,children:[e.jsxs(o,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"startDate",children:"Start Date"}),e.jsx("input",{type:"date",id:"startDate",name:"startDate",className:"input",value:s.startDate||"",onChange:c})]}),e.jsxs(o,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"endDate",children:"End Date"}),e.jsx("input",{type:"date",id:"endDate",name:"endDate",className:"input",value:s.endDate||"",onChange:c})]}),e.jsxs(o,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"projectManagerId",children:"Project Manager ID"}),e.jsx("input",{id:"projectManagerId",name:"projectManagerId",className:"input",value:s.projectManagerId||"",onChange:c})]}),e.jsxs(o,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"projectManagerName",children:"Project Manager Name"}),e.jsx("input",{id:"projectManagerName",name:"projectManagerName",className:"input",value:s.projectManagerName||"",onChange:c})]}),e.jsxs(o,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"projectStatus",children:"Project Status"}),e.jsxs("select",{id:"projectStatus",name:"projectStatus",className:"input",value:s.projectStatus||"",onChange:c,children:[e.jsx("option",{value:"planning",children:"Planning"}),e.jsx("option",{value:"in progress",children:"In Progress"}),e.jsx("option",{value:"delayed",children:"Delayed"}),e.jsx("option",{value:"completed",children:"Completed"})]})]})]})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Budget and Requirements"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(o,{container:!0,spacing:2,children:[e.jsxs(o,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"projectBudget",children:"Project Budget"}),e.jsx("input",{id:"projectBudget",name:"projectBudget",className:"input",value:s.projectBudget||"",onChange:c})]}),e.jsxs(o,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"projectMilestones",children:"Project Milestone"}),e.jsx("input",{id:"projectMilestones",name:"projectMilestones",className:"input",value:s.projectMilestones||"",onChange:c})]}),e.jsxs(o,{item:!0,xs:6,children:[e.jsx("label",{htmlFor:"resourceAllocation",children:"Resource Allocation"}),e.jsx("input",{id:"resourceAllocation",name:"resourceAllocation",className:"input",value:s.resourceAllocation||"",onChange:c})]})]})]})]})})]}),e.jsxs(te,{children:[e.jsx(T,{onClick:g,sx:{outline:"2px solid #800000",color:"#800000","&:hover":{outline:"2px solid #b30000",color:"#b30000"}},children:"Cancel"}),e.jsx(T,{variant:"outlined",onClick:O,sx:{borderColor:"#7267ef",color:"#7267ef","&:hover":{borderColor:"#9e8df2",color:"#9e8df2"}},children:b?"Update Project":"Submit Project"})]})]})]})};export{ue as default};
