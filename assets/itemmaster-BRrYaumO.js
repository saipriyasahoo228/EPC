import{r as c,j as e,T as W}from"./main-IxGEKZMA.js";import{E as R}from"./jspdf.plugin.autotable-BR5kQNfz.js";import{C as A}from"./Close-DoqWsXz3.js";import{g as F,u as $,c as B,d as U}from"./inventory-TCBUaCbN.js";import{e as u,D as G,f as H,I as v,g as J,t as Q,T as Y,h as K,i as C,j as n,k as V}from"./TableRow-CRAT5KT_.js";import{G as o}from"./Grid-C72N-tAO.js";import{D as q}from"./DialogActions-D5wP0Mt-.js";import{E as z}from"./Edit-g2hjeeYC.js";import{D as X}from"./Delete-cHl_EB0l.js";import{T as Z}from"./TablePagination-DkVFCvhA.js";import"./Transition-C29ZPDdz.js";import"./dividerClasses-DK6Syutt.js";import"./KeyboardArrowRight-Y-VTRWJY.js";import"./Select-CDJTZGaT.js";const he=()=>{const[f,b]=c.useState(""),[k,S]=c.useState(!1),[i,N]=c.useState(null),[y,I]=c.useState([]),[s,x]=c.useState({itemName:"",category:"",netWeight:"",unitOfMeasure:"",minStockLevel:"",maxStockLevel:"",reorderLevel:"",storageLocation:"",itemStatus:"Active"}),h=async()=>{try{const t=await F();I(t)}catch(t){console.error("❌ Error fetching items:",t)}};c.useEffect(()=>{h()},[]);const[g,L]=c.useState(0),[d,w]=c.useState(5),_=(t=null)=>{N(t),S(!0),x(t?{itemId:t.item_id||"",itemName:t.item_name||"",category:t.category||"",netWeight:t.net_weight||"",unitOfMeasure:t.unit_of_measure||"",minStockLevel:t.minimum_stock_level||"",maxStockLevel:t.maximum_stock_level||"",reorderLevel:t.reorder_level||"",storageLocation:t.storage_location||"",itemStatus:t.item_status||""}:{itemId:"",itemName:"",category:"",netWeight:"",unitOfMeasure:"",minStockLevel:"",maxStockLevel:"",reorderLevel:"",storageLocation:"",itemStatus:""})},m=()=>S(!1),l=t=>{const{name:r,value:a}=t.target;x(j=>({...j,[r]:a}))},D=()=>{const t=new Date().getFullYear(),r=y.length+1;return`ITM-${t}-${String(r).padStart(4,"0")}`},M=async()=>{if(!(Number(s.minStockLevel)<Number(s.reorderLevel)&&Number(s.reorderLevel)<Number(s.maxStockLevel))){alert(`⚠️ Validation Error:
Ensure that: Minimum Stock Level < Reorder Level < Maximum Stock Level`);return}const t=new FormData;t.append("item_name",s.itemName),t.append("category",s.category),t.append("net_weight",s.netWeight||0),t.append("unit_of_measure",s.unitOfMeasure),t.append("minimum_stock_level",s.minStockLevel||0),t.append("maximum_stock_level",s.maxStockLevel||0),t.append("reorder_level",s.reorderLevel||0),t.append("storage_location",s.storageLocation),t.append("item_status",s.itemStatus);try{let r;i&&i.item_id?(r=await $(i.item_id,t),alert(`✅ Item ${i.item_id} updated successfully!`),await h()):(r=await B(t),alert(`✅ Item Created Successfully!
Item ID: ${r.item_id||"N/A"}`),await h()),m()}catch(r){if(console.error("❌ Error:",r),r.response&&r.response.data){let a=typeof r.response.data=="string"?r.response.data:JSON.stringify(r.response.data);alert(`⚠️ Failed to save item:
${a}`)}else alert("⚠️ Failed to save item. Please try again.")}},P=async t=>{if(window.confirm(`Are you sure you want to delete item ${t}?`))try{const r=await U(t);alert(`✅ Item ${t} deleted successfully!`),I(a=>a.filter(j=>j.item_id!==t))}catch(r){console.error("❌ Error deleting item:",r),r.response&&r.response.data?alert(`⚠️ Failed to delete item:
${JSON.stringify(r.response.data)}`):alert("⚠️ Failed to delete item. Please try again.")}},p=y.filter(t=>Object.values(t).some(r=>r&&r.toString().toLowerCase().includes(f.toLowerCase()))),E=(t,r)=>{L(r)},O=t=>{w(parseInt(t.target.value,10)),L(0)},T=()=>{const t=new R,r=p.map(a=>[a.itemId,a.itemName,a.category,a.netWeight,a.unitOfMeasure,a.minStockLevel,a.maxStockLevel,a.reorderLevel,a.storageLocation,a.itemStatus]);t.autoTable({head:[["Item ID","Name","Category","Net Weight","Unit","Min Stock","Max Stock","Reorder Level","Storage Location","Status"]],body:r}),t.save("inventory_report.pdf")};return e.jsxs("div",{children:[e.jsx(u,{variant:"contained",sx:{mt:4,mb:2,backgroundColor:"#7267ef"},onClick:()=>_(),children:"Add Item"}),e.jsxs(G,{open:k,onClose:m,maxWidth:"sm",fullWidth:!0,children:[e.jsxs(H,{sx:{backgroundColor:"#f3f3f3",color:"#7267ef",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i?"Edit Inventory Item":"Add Inventory Item",e.jsx(v,{onClick:m,sx:{color:"#7267ef"},children:e.jsx(A,{})})]}),e.jsx(J,{children:e.jsxs(o,{container:!0,spacing:2,direction:"column",sx:{mt:1},children:[e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Item ID"}),e.jsx("input",{className:"input",disabled:!0,value:i?i.item_id:D()})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Item Name"}),e.jsx("input",{className:"input",name:"itemName",value:s.itemName,onChange:l,placeholder:"e.g., Steel Rods"})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Category"}),e.jsx("input",{className:"input",name:"category",value:s.category,onChange:l,placeholder:"e.g., Raw Materials"})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Net Weight"}),e.jsx("input",{className:"input",name:"netWeight",value:s.netWeight,onChange:l,placeholder:"e.g., 70"})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Unit of Measure"}),e.jsx("input",{className:"input",name:"unitOfMeasure",value:s.unitOfMeasure,onChange:l,placeholder:"e.g., KG"})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Minimum Stock Level"}),e.jsx("input",{className:"input",name:"minStockLevel",type:"number",value:s.minStockLevel,onChange:l})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Maximum Stock Level"}),e.jsx("input",{className:"input",name:"maxStockLevel",type:"number",value:s.maxStockLevel,onChange:l})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Reorder Level"}),e.jsx("input",{className:"input",name:"reorderLevel",type:"number",value:s.reorderLevel,onChange:l})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Storage Location"}),e.jsx("input",{className:"input",name:"storageLocation",value:s.storageLocation,onChange:l,placeholder:"e.g., Warehouse A"})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Item Status"}),e.jsxs("select",{className:"input",name:"itemStatus",value:s.itemStatus,onChange:l,children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"}),e.jsx("option",{value:"Discontinued",children:"Discontinued"})]})]})]})}),e.jsxs(q,{sx:{pr:3,pb:2},children:[e.jsx(u,{onClick:m,sx:{outline:"2px solid #800000",color:"#800000"},children:"Cancel"}),e.jsx(u,{variant:"outlined",onClick:M,sx:{borderColor:"#7267ef",color:"#7267ef"},children:i?"Update":"Submit"})]})]}),e.jsxs(Q,{sx:{mt:4,p:2,border:"1px solid #ccc"},children:[e.jsxs(o,{container:!0,justifyContent:"space-between",alignItems:"center",children:[e.jsx(o,{item:!0,children:e.jsx(W,{variant:"h6",gutterBottom:!0,sx:{color:"#7267ef"},children:"Inventory Items Report"})}),e.jsx(o,{item:!0,children:e.jsx(u,{onClick:T,sx:{backgroundColor:"#7267ef",color:"#fff",mt:2,mb:2},children:"Export PDF"})})]}),e.jsx("input",{type:"text",placeholder:"Search Item Details Here....",value:f,onChange:t=>b(t.target.value),className:"input"}),e.jsxs(Y,{children:[e.jsx(K,{children:e.jsxs(C,{children:[e.jsx(n,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Item ID"})}),e.jsx(n,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Name"})}),e.jsx(n,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Category"})}),e.jsx(n,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Net Weight"})}),e.jsx(n,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Unit"})}),e.jsx(n,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Min"})}),e.jsx(n,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Max"})}),e.jsx(n,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Reorder"})}),e.jsx(n,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Location"})}),e.jsx(n,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Status"})}),e.jsx(n,{sx:{color:"#660000"},children:e.jsx("strong",{children:"Actions"})})]})}),e.jsx(V,{children:p.slice(g*d,g*d+d).map((t,r)=>e.jsxs(C,{children:[e.jsx(n,{children:t.item_id}),e.jsx(n,{children:t.item_name}),e.jsx(n,{children:t.category}),e.jsx(n,{children:t.net_weight}),e.jsx(n,{children:t.unit_of_measure}),e.jsx(n,{children:t.minimum_stock_level}),e.jsx(n,{children:t.maximum_stock_level}),e.jsx(n,{children:t.reorder_level}),e.jsx(n,{children:t.storage_location}),e.jsx(n,{children:t.item_status}),e.jsxs(n,{children:[e.jsx(v,{color:"warning",onClick:()=>_(t),children:e.jsx(z,{sx:{color:"orange"}})}),e.jsx(v,{color:"error",onClick:()=>P(t.item_id),children:e.jsx(X,{sx:{color:"red"}})})]})]},r))})]}),e.jsx(Z,{rowsPerPageOptions:[5,10,25],component:"div",count:p.length,rowsPerPage:d,page:g,onPageChange:E,onRowsPerPageChange:O})]})]})};export{he as default};
