import{r as c,j as e,S as k,I as x,K as w,J as U,T as B}from"./main-Skim5IJC.js";import{E as G,a as Y}from"./jspdf.plugin.autotable-Aj3tGQhx.js";import{D as J}from"./Download-C4sxsXoP.js";import{C as H}from"./Close-BKZ7QrSY.js";import{g as K,u as Q,c as V,d as q}from"./inventory-BCILrqmV.js";import{B as h,D as X,a as Z,b as ee,c as te}from"./DialogTitle-CvDFHAwp.js";import{M as se,a as re}from"./minimize-2-RCuvNn0X.js";import{G as o}from"./Grid-fY_ATwTx.js";import{T as ae,a as ne,b as N,c as a,d as oe}from"./TableRow-B6k_bSOs.js";import{E as le}from"./Edit-6vcT2Cu4.js";import{D as ie}from"./Delete-Be1vvbhC.js";import{T as ce}from"./TablePagination-_dHW1U1A.js";import"./index-Pp9EW3wT.js";import"./KeyboardArrowRight-BzCb_W4p.js";import"./Select-BThNtn2k.js";import"./useSlotProps-CCL6Y0ZK.js";import"./useFormControl-C6hS7-Rn.js";import"./useControlled-CHkDrNg3.js";import"./MenuItem-Cm5ZuES4.js";import"./Toolbar-Dufg8Txv.js";const Me=()=>{const d="inventory",[S,M]=c.useState(""),[D,y]=c.useState(!1),[l,P]=c.useState(null),[I,b]=c.useState([]),[g,E]=c.useState(!1),[r,p]=c.useState({itemName:"",category:"",netWeight:"",unitOfMeasure:"",minStockLevel:"",maxStockLevel:"",reorderLevel:"",storageLocation:"",itemStatus:"Active"}),O=()=>{E(!g)},j=async()=>{try{const t=await K();b(t)}catch(t){console.error("❌ Error fetching items:",t)}};c.useEffect(()=>{j()},[]);const[v,C]=c.useState(0),[m,R]=c.useState(5),L=(t=null)=>{P(t),y(!0),p(t?{itemId:t.item_id||"",itemName:t.item_name||"",category:t.category||"",netWeight:t.net_weight||"",unitOfMeasure:t.unit_of_measure||"",minStockLevel:t.minimum_stock_level||"",maxStockLevel:t.maximum_stock_level||"",reorderLevel:t.reorder_level||"",storageLocation:t.storage_location||"",itemStatus:t.item_status||""}:{itemId:"",itemName:"",category:"",netWeight:"",unitOfMeasure:"",minStockLevel:"",maxStockLevel:"",reorderLevel:"",storageLocation:"",itemStatus:""})},u=()=>y(!1),i=t=>{const{name:s,value:n}=t.target;p(_=>({..._,[s]:n}))},T=()=>{const t=new Date().getFullYear(),s=I.length+1;return`ITM-${t}-${String(s).padStart(4,"0")}`},W=async()=>{if(!(Number(r.minStockLevel)<Number(r.reorderLevel)&&Number(r.reorderLevel)<Number(r.maxStockLevel))){alert(`⚠️ Validation Error:
Ensure that: Minimum Stock Level < Reorder Level < Maximum Stock Level`);return}const t=new FormData;t.append("item_name",r.itemName),t.append("category",r.category),t.append("net_weight",r.netWeight||0),t.append("unit_of_measure",r.unitOfMeasure),t.append("minimum_stock_level",r.minStockLevel||0),t.append("maximum_stock_level",r.maxStockLevel||0),t.append("reorder_level",r.reorderLevel||0),t.append("storage_location",r.storageLocation),t.append("item_status",r.itemStatus);try{let s;l&&l.item_id?(s=await Q(l.item_id,t),alert(`✅ Item ${l.item_id} updated successfully!`),await j()):(s=await V(t),alert(`✅ Item Created Successfully!
Item ID: ${s.item_id||"N/A"}`),await j()),u()}catch(s){if(console.error("❌ Error:",s),s.response&&s.response.data){let n=typeof s.response.data=="string"?s.response.data:JSON.stringify(s.response.data);alert(`⚠️ Failed to save item:
${n}`)}else alert("⚠️ Failed to save item. Please try again.")}},A=async t=>{if(window.confirm(`Are you sure you want to delete item ${t}?`))try{const s=await q(t);alert(`✅ Item ${t} deleted successfully!`),b(n=>n.filter(_=>_.item_id!==t))}catch(s){console.error("❌ Error deleting item:",s),s.response&&s.response.data?alert(`⚠️ Failed to delete item:
${JSON.stringify(s.response.data)}`):alert("⚠️ Failed to delete item. Please try again.")}},f=I.filter(t=>Object.values(t).some(s=>s&&s.toString().toLowerCase().includes(S.toLowerCase()))),F=(t,s)=>{C(s)},z=t=>{R(parseInt(t.target.value,10)),C(0)},$=()=>{const t=new G("l","mm","a4");t.setFontSize(16),t.text("Inventory Items Report",14,15);const s=f.map(n=>[n.item_id,n.item_name,n.category,n.net_weight,n.unit_of_measure,n.minimum_stock_level,n.maximum_stock_level,n.reorder_level,n.storage_location,n.item_status]);Y(t,{head:[["Item ID","Name","Category","Net Weight","Unit","Min Stock","Max Stock","Reorder Level","Storage Location","Status"]],body:s,startY:25,styles:{fontSize:7,cellPadding:2,overflow:"linebreak"},headStyles:{fillColor:[114,103,239]},tableWidth:"auto"}),t.save("inventory_items_report.pdf")};return e.jsxs("div",{children:[e.jsx(k,{slug:d,action:"can_create",children:e.jsx(h,{variant:"contained",sx:{mt:4,mb:2,backgroundColor:"#7267ef"},onClick:()=>L(),children:"Add Item"})}),e.jsxs(X,{open:D,onClose:u,fullWidth:!0,maxWidth:"xl",PaperProps:{style:g?{width:"100%",height:"100vh",margin:0}:{width:"70%",height:"97vh"}},children:[e.jsxs(Z,{sx:{backgroundColor:"#f3f3f3",color:"#7267ef",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[l?"Edit Inventory Item":"Add Inventory Item",e.jsx(x,{onClick:u,sx:{color:"#7267ef"},children:e.jsx(H,{})})]}),e.jsxs(ee,{sx:{position:"relative",overflowY:"auto"},children:[e.jsx(x,{"aria-label":"toggle-size",onClick:O,sx:{position:"absolute",right:40,top:8,color:t=>t.palette.grey[600]},children:g?e.jsx(se,{}):e.jsx(re,{})}),e.jsxs(o,{container:!0,spacing:2,direction:"column",sx:{mt:1},children:[e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Item ID"}),e.jsx("input",{className:"input",disabled:!0,value:l?l.item_id:T()})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Item Name"}),e.jsx("input",{className:"input",name:"itemName",value:r.itemName,onChange:i,placeholder:"e.g., Steel Rods"})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Category"}),e.jsx("input",{className:"input",name:"category",value:r.category,onChange:i,placeholder:"e.g., Raw Materials"})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Net Weight"}),e.jsx("input",{className:"input",name:"netWeight",value:r.netWeight,onChange:i,placeholder:"e.g., 70"})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Unit of Measure"}),e.jsx("input",{className:"input",name:"unitOfMeasure",value:r.unitOfMeasure,onChange:i,placeholder:"e.g., KG"})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Minimum Stock Level"}),e.jsx("input",{className:"input",name:"minStockLevel",type:"number",value:r.minStockLevel,onChange:i})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Maximum Stock Level"}),e.jsx("input",{className:"input",name:"maxStockLevel",type:"number",value:r.maxStockLevel,onChange:i})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Reorder Level"}),e.jsx("input",{className:"input",name:"reorderLevel",type:"number",value:r.reorderLevel,onChange:i})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Storage Location"}),e.jsx("input",{className:"input",name:"storageLocation",value:r.storageLocation,onChange:i,placeholder:"e.g., Warehouse A"})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx("label",{children:"Item Status"}),e.jsxs("select",{className:"input",name:"itemStatus",value:r.itemStatus,onChange:i,children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"}),e.jsx("option",{value:"Discontinued",children:"Discontinued"})]})]})]})]}),e.jsxs(te,{sx:{pr:3,pb:2},children:[e.jsx(h,{onClick:u,sx:{outline:"2px solid #800000",color:"#800000"},children:"Cancel"}),e.jsx(w,{slug:d,action:l?"can_update":"can_create",children:e.jsx(h,{variant:"outlined",onClick:W,sx:{borderColor:"#7267ef",color:"#7267ef"},children:l?"Update":"Submit"})})]})]}),e.jsxs(U,{sx:{mt:4,p:2,border:"1px solid #ccc"},children:[e.jsxs(o,{container:!0,justifyContent:"space-between",alignItems:"center",children:[e.jsx(o,{item:!0,children:e.jsx(B,{variant:"h6",gutterBottom:!0,sx:{color:"#7267ef"},children:"Inventory Items Report"})}),e.jsx(o,{item:!0,children:e.jsx(h,{startIcon:e.jsx(J,{}),onClick:$,sx:{backgroundColor:"#7267ef",color:"#fff",mt:2,mb:2},children:"Download"})})]}),e.jsx("input",{type:"text",placeholder:"Search Item Details Here....",value:S,onChange:t=>M(t.target.value),className:"input"}),e.jsxs(ae,{children:[e.jsx(ne,{children:e.jsxs(N,{children:[e.jsx(a,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Item ID"})}),e.jsx(a,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Name"})}),e.jsx(a,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Category"})}),e.jsx(a,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Net Weight"})}),e.jsx(a,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Unit"})}),e.jsx(a,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Min"})}),e.jsx(a,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Max"})}),e.jsx(a,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Reorder"})}),e.jsx(a,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Location"})}),e.jsx(a,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Status"})}),e.jsx(a,{sx:{color:"#660000"},children:e.jsx("strong",{children:"Actions"})})]})}),e.jsx(oe,{children:f.slice(v*m,v*m+m).map((t,s)=>e.jsxs(N,{children:[e.jsx(a,{children:t.item_id}),e.jsx(a,{children:t.item_name}),e.jsx(a,{children:t.category}),e.jsx(a,{children:t.net_weight}),e.jsx(a,{children:t.unit_of_measure}),e.jsx(a,{children:t.minimum_stock_level}),e.jsx(a,{children:t.maximum_stock_level}),e.jsx(a,{children:t.reorder_level}),e.jsx(a,{children:t.storage_location}),e.jsx(a,{children:t.item_status}),e.jsxs(a,{children:[e.jsx(w,{slug:d,action:"can_update",children:e.jsx(x,{color:"warning",onClick:()=>L(t),children:e.jsx(le,{sx:{color:"orange"}})})}),e.jsx(k,{slug:d,action:"can_delete",children:e.jsx(x,{color:"error",onClick:()=>A(t.item_id),children:e.jsx(ie,{sx:{color:"red"}})})})]})]},s))})]}),e.jsx(ce,{rowsPerPageOptions:[5,10,25],component:"div",count:f.length,rowsPerPage:m,page:v,onPageChange:F,onRowsPerPageChange:z})]})]})};export{Me as default};
