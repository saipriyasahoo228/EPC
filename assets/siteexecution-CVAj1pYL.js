import{r as a,k as Be,i as De,m as fe,j as e,o as se,n as J,t as me,E as vt,q as K,v as ge,G as it,H as q,I as bt,w as yt,z as nt,x as ye,T as B,S as Me,J as Ct,D as ee}from"./main-BIxdd69i.js";import{C as kt}from"./Close-D340Gps3.js";import{g as _t}from"./engineering-4VzvUWDc.js";import{i as Ie,j as wt,k as St,l as It}from"./construction-TCh-rxln.js";import{u as $t}from"./index-BDsS-tJo.js";import{G as l}from"./Grid-BnZNKmae.js";import{a as at,i as lt,j as Rt,o as ct,k as Qe,r as Tt,c as $e,M as Pt,P as Pe,u as Bt,B as dt,I as Re,e as U,D as Oe,f as Ae,g as Fe,h as Ue}from"./DialogTitle-D59uELMl.js";import{C as ie,D as Xe}from"./Divider-B5eNhVMt.js";import{T as W}from"./TextField-BZ4knvb7.js";import{I as Je}from"./InputAdornment-BUocAI06.js";import{T as Ke,a as Ze,b as xe,c as x,d as et}from"./TableRow-D8X36zJO.js";import{T as te}from"./Tooltip-3Br47uNT.js";import{A as tt}from"./AddCircle-Bn9h5MaP.js";import{S as he,C as Dt,a as zt,F as Et}from"./Stack-Dyw0hk3Q.js";import{T as Wt}from"./TableContainer-1Xqyy-f8.js";import{E as Ne}from"./Edit-BJV-h6Li.js";import{D as Ge}from"./Delete-BHKbKfZ2.js";import{u as Lt}from"./index-E3WhgaTq.js";import{m as Mt,L as He,g as Ot,a as At}from"./Select-CcRDAcIa.js";import{d as Ft}from"./dividerClasses-BHbp2fTT.js";import{g as Ut,l as Ce,L as ne}from"./ListItemText-BdTZxcRl.js";function Nt(t){return a.Children.toArray(t).filter(r=>a.isValidElement(r))}function Gt(t){return Be("MuiCardActions",t)}De("MuiCardActions",["root","spacing"]);const Ht=t=>{const{classes:r,disableSpacing:o}=t;return me({root:["root",!o&&"spacing"]},Gt,r)},qt=se("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.root,!o.disableSpacing&&r.spacing]}})({display:"flex",alignItems:"center",padding:8,variants:[{props:{disableSpacing:!1},style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),Vt=a.forwardRef(function(r,o){const i=fe({props:r,name:"MuiCardActions"}),{disableSpacing:c=!1,className:g,...f}=i,h={...i,disableSpacing:c},j=Ht(h);return e.jsx(qt,{className:J(j.root,g),ownerState:h,ref:o,...f})});function Yt(t,r,o){const i=r.getBoundingClientRect(),c=o&&o.getBoundingClientRect(),g=ct(r);let f;if(r.fakeTransform)f=r.fakeTransform;else{const m=g.getComputedStyle(r);f=m.getPropertyValue("-webkit-transform")||m.getPropertyValue("transform")}let h=0,j=0;if(f&&f!=="none"&&typeof f=="string"){const m=f.split("(")[1].split(")")[0].split(",");h=parseInt(m[4],10),j=parseInt(m[5],10)}return t==="left"?c?`translateX(${c.right+h-i.left}px)`:`translateX(${g.innerWidth+h-i.left}px)`:t==="right"?c?`translateX(-${i.right-c.left-h}px)`:`translateX(-${i.left+i.width-h}px)`:t==="up"?c?`translateY(${c.bottom+j-i.top}px)`:`translateY(${g.innerHeight+j-i.top}px)`:c?`translateY(-${i.top-c.top+i.height-j}px)`:`translateY(-${i.top+i.height-j}px)`}function Qt(t){return typeof t=="function"?t():t}function Te(t,r,o){const i=Qt(o),c=Yt(t,r,i);c&&(r.style.webkitTransform=c,r.style.transform=c)}const Xt=a.forwardRef(function(r,o){const i=at(),c={enter:i.transitions.easing.easeOut,exit:i.transitions.easing.sharp},g={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{addEndListener:f,appear:h=!0,children:j,container:m,direction:b="down",easing:p=c,in:S,onEnter:$,onEntered:L,onEntering:M,onExit:T,onExited:_,onExiting:R,style:D,timeout:O=g,TransitionComponent:F=vt,...Y}=r,v=a.useRef(null),y=lt(Rt(j),v,o),E=d=>P=>{d&&(P===void 0?d(v.current):d(v.current,P))},G=E((d,P)=>{Te(b,d,m),Tt(d),$&&$(d,P)}),C=E((d,P)=>{const H=Qe({timeout:O,style:D,easing:p},{mode:"enter"});d.style.webkitTransition=i.transitions.create("-webkit-transform",{...H}),d.style.transition=i.transitions.create("transform",{...H}),d.style.webkitTransform="none",d.style.transform="none",M&&M(d,P)}),N=E(L),Q=E(R),A=E(d=>{const P=Qe({timeout:O,style:D,easing:p},{mode:"exit"});d.style.webkitTransition=i.transitions.create("-webkit-transform",P),d.style.transition=i.transitions.create("transform",P),Te(b,d,m),T&&T(d)}),re=E(d=>{d.style.webkitTransition="",d.style.transition="",_&&_(d)}),oe=d=>{f&&f(v.current,d)},de=a.useCallback(()=>{v.current&&Te(b,v.current,m)},[b,m]);return a.useEffect(()=>{if(S||b==="down"||b==="right")return;const d=Ft(()=>{v.current&&Te(b,v.current,m)}),P=ct(v.current);return P.addEventListener("resize",d),()=>{d.clear(),P.removeEventListener("resize",d)}},[b,S,m]),a.useEffect(()=>{S||de()},[S,de]),e.jsx(F,{nodeRef:v,onEnter:G,onEntered:N,onEntering:C,onExit:A,onExited:re,onExiting:Q,addEndListener:oe,appear:h,in:S,timeout:O,...Y,children:(d,{ownerState:P,...H})=>a.cloneElement(j,{ref:y,style:{visibility:d==="exited"&&!S?"hidden":void 0,...D,...j.props.style},...H})})});function Jt(t){return Be("MuiDrawer",t)}De("MuiDrawer",["root","docked","paper","anchorLeft","anchorRight","anchorTop","anchorBottom","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const ut=(t,r)=>{const{ownerState:o}=t;return[r.root,(o.variant==="permanent"||o.variant==="persistent")&&r.docked,r.modal]},Kt=t=>{const{classes:r,anchor:o,variant:i}=t,c={root:["root",`anchor${K(o)}`],docked:[(i==="permanent"||i==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${K(o)}`,i!=="temporary"&&`paperAnchorDocked${K(o)}`]};return me(c,Jt,r)},Zt=se(Pt,{name:"MuiDrawer",slot:"Root",overridesResolver:ut})(ge(({theme:t})=>({zIndex:(t.vars||t).zIndex.drawer}))),es=se("div",{shouldForwardProp:it,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:ut})({flex:"0 0 auto"}),ts=se(Pe,{name:"MuiDrawer",slot:"Paper",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.paper,r[`paperAnchor${K(o.anchor)}`],o.variant!=="temporary"&&r[`paperAnchorDocked${K(o.anchor)}`]]}})(ge(({theme:t})=>({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(t.vars||t).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0,variants:[{props:{anchor:"left"},style:{left:0}},{props:{anchor:"top"},style:{top:0,left:0,right:0,height:"auto",maxHeight:"100%"}},{props:{anchor:"right"},style:{right:0}},{props:{anchor:"bottom"},style:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"}},{props:({ownerState:r})=>r.anchor==="left"&&r.variant!=="temporary",style:{borderRight:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:r})=>r.anchor==="top"&&r.variant!=="temporary",style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:r})=>r.anchor==="right"&&r.variant!=="temporary",style:{borderLeft:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:r})=>r.anchor==="bottom"&&r.variant!=="temporary",style:{borderTop:`1px solid ${(t.vars||t).palette.divider}`}}]}))),pt={left:"right",right:"left",top:"down",bottom:"up"};function ss(t){return["left","right"].includes(t)}function rs({direction:t},r){return t==="rtl"&&ss(r)?pt[r]:r}const os=a.forwardRef(function(r,o){const i=fe({props:r,name:"MuiDrawer"}),c=at(),g=Lt(),f={enter:c.transitions.duration.enteringScreen,exit:c.transitions.duration.leavingScreen},{anchor:h="left",BackdropProps:j,children:m,className:b,elevation:p=16,hideBackdrop:S=!1,ModalProps:{BackdropProps:$,...L}={},onClose:M,open:T=!1,PaperProps:_={},SlideProps:R,TransitionComponent:D,transitionDuration:O=f,variant:F="temporary",slots:Y={},slotProps:v={},...y}=i,E=a.useRef(!1);a.useEffect(()=>{E.current=!0},[]);const G=rs({direction:g?"rtl":"ltr"},h),N={...i,anchor:h,elevation:p,open:T,variant:F,...y},Q=Kt(N),A={slots:{transition:D,...Y},slotProps:{paper:_,transition:R,...v,backdrop:Mt(v.backdrop||{...j,...$},{transitionDuration:O})}},[re,oe]=$e("root",{ref:o,elementType:Zt,className:J(Q.root,Q.modal,b),shouldForwardComponentProp:!0,ownerState:N,externalForwardedProps:{...A,...y,...L},additionalProps:{open:T,onClose:M,hideBackdrop:S,slots:{backdrop:A.slots.backdrop},slotProps:{backdrop:A.slotProps.backdrop}}}),[de,d]=$e("paper",{elementType:ts,shouldForwardComponentProp:!0,className:J(Q.paper,_.className),ownerState:N,externalForwardedProps:A,additionalProps:{elevation:F==="temporary"?p:0,square:!0}}),[P,H]=$e("docked",{elementType:es,ref:o,className:J(Q.root,Q.docked,b),ownerState:N,externalForwardedProps:A,additionalProps:y}),[je,ve]=$e("transition",{elementType:Xt,ownerState:N,externalForwardedProps:A,additionalProps:{in:T,direction:pt[G],timeout:O,appear:E.current}}),be=e.jsx(de,{...d,children:m});if(F==="permanent")return e.jsx(P,{...H,children:be});const ke=e.jsx(je,{...ve,children:be});return F==="persistent"?e.jsx(P,{...H,children:ke}):e.jsx(re,{...oe,children:ke})}),is=(t,r)=>{const{ownerState:o}=t;return[r.root,o.dense&&r.dense,o.alignItems==="flex-start"&&r.alignItemsFlexStart,o.divider&&r.divider,!o.disableGutters&&r.gutters]},ns=t=>{const{alignItems:r,classes:o,dense:i,disabled:c,disableGutters:g,divider:f,selected:h}=t,m=me({root:["root",i&&"dense",!g&&"gutters",f&&"divider",c&&"disabled",r==="flex-start"&&"alignItemsFlexStart",h&&"selected"]},Ut,o);return{...o,...m}},as=se(dt,{shouldForwardProp:t=>it(t)||t==="classes",name:"MuiListItemButton",slot:"Root",overridesResolver:is})(ge(({theme:t})=>({display:"flex",flexGrow:1,justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minWidth:0,boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Ce.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:q(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${Ce.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:q(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`&.${Ce.selected}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:q(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:q(t.palette.primary.main,t.palette.action.selectedOpacity)}},[`&.${Ce.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${Ce.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},variants:[{props:({ownerState:r})=>r.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:r})=>!r.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:r})=>r.dense,style:{paddingTop:4,paddingBottom:4}}]}))),ae=a.forwardRef(function(r,o){const i=fe({props:r,name:"MuiListItemButton"}),{alignItems:c="center",autoFocus:g=!1,component:f="div",children:h,dense:j=!1,disableGutters:m=!1,divider:b=!1,focusVisibleClassName:p,selected:S=!1,className:$,...L}=i,M=a.useContext(He),T=a.useMemo(()=>({dense:j||M.dense||!1,alignItems:c,disableGutters:m}),[c,M.dense,j,m]),_=a.useRef(null);Bt(()=>{g&&_.current&&_.current.focus()},[g]);const R={...i,alignItems:c,dense:T.dense,disableGutters:m,divider:b,selected:S},D=ns(R),O=lt(_,o);return e.jsx(He.Provider,{value:T,children:e.jsx(as,{ref:O,href:L.href||L.to,component:(L.href||L.to)&&f==="div"?"button":f,focusVisibleClassName:J(D.focusVisible,p),ownerState:R,className:J(D.root,$),...L,classes:D,children:h})})}),ls=t=>{const{alignItems:r,classes:o}=t;return me({root:["root",r==="flex-start"&&"alignItemsFlexStart"]},Ot,o)},cs=se("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.root,o.alignItems==="flex-start"&&r.alignItemsFlexStart]}})(ge(({theme:t})=>({minWidth:56,color:(t.vars||t).palette.action.active,flexShrink:0,display:"inline-flex",variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}))),le=a.forwardRef(function(r,o){const i=fe({props:r,name:"MuiListItemIcon"}),{className:c,...g}=i,f=a.useContext(He),h={...i,alignItems:f.alignItems},j=ls(h);return e.jsx(cs,{className:J(j.root,c),ownerState:h,ref:o,...g})});function ds(t){return Be("MuiToggleButton",t)}const ce=De("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge","fullWidth"]),xt=a.createContext({}),ht=a.createContext(void 0);function us(t,r){return r===void 0||t===void 0?!1:Array.isArray(r)?r.includes(t):t===r}const ps=t=>{const{classes:r,fullWidth:o,selected:i,disabled:c,size:g,color:f}=t,h={root:["root",i&&"selected",c&&"disabled",o&&"fullWidth",`size${K(g)}`,f]};return me(h,ds,r)},xs=se(dt,{name:"MuiToggleButton",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.root,r[`size${K(o.size)}`]]}})(ge(({theme:t})=>({...t.typography.button,borderRadius:(t.vars||t).shape.borderRadius,padding:11,border:`1px solid ${(t.vars||t).palette.divider}`,color:(t.vars||t).palette.action.active,[`&.${ce.disabled}`]:{color:(t.vars||t).palette.action.disabled,border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:q(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[{props:{color:"standard"},style:{[`&.${ce.selected}`]:{color:(t.vars||t).palette.text.primary,backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.selectedOpacity})`:q(t.palette.text.primary,t.palette.action.selectedOpacity),"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:q(t.palette.text.primary,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.selectedOpacity})`:q(t.palette.text.primary,t.palette.action.selectedOpacity)}}}}},...Object.entries(t.palette).filter(yt()).map(([r])=>({props:{color:r},style:{[`&.${ce.selected}`]:{color:(t.vars||t).palette[r].main,backgroundColor:t.vars?`rgba(${t.vars.palette[r].mainChannel} / ${t.vars.palette.action.selectedOpacity})`:q(t.palette[r].main,t.palette.action.selectedOpacity),"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette[r].mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:q(t.palette[r].main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette[r].mainChannel} / ${t.vars.palette.action.selectedOpacity})`:q(t.palette[r].main,t.palette.action.selectedOpacity)}}}}})),{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{padding:7,fontSize:t.typography.pxToRem(13)}},{props:{size:"large"},style:{padding:15,fontSize:t.typography.pxToRem(15)}}]}))),st=a.forwardRef(function(r,o){const{value:i,...c}=a.useContext(xt),g=a.useContext(ht),f=bt({...c,selected:us(r.value,i)},r),h=fe({props:f,name:"MuiToggleButton"}),{children:j,className:m,color:b="standard",disabled:p=!1,disableFocusRipple:S=!1,fullWidth:$=!1,onChange:L,onClick:M,selected:T,size:_="medium",value:R,...D}=h,O={...h,color:b,disabled:p,disableFocusRipple:S,fullWidth:$,size:_},F=ps(O),Y=y=>{M&&(M(y,R),y.defaultPrevented)||L&&L(y,R)},v=g||"";return e.jsx(xs,{className:J(c.className,F.root,m,v),disabled:p,focusRipple:!S,ref:o,onClick:Y,onChange:L,value:R,ownerState:O,"aria-pressed":T,...D,children:j})});function hs(t){return Be("MuiToggleButtonGroup",t)}const k=De("MuiToggleButtonGroup",["root","selected","horizontal","vertical","disabled","grouped","groupedHorizontal","groupedVertical","fullWidth","firstButton","lastButton","middleButton"]),fs=t=>{const{classes:r,orientation:o,fullWidth:i,disabled:c}=t,g={root:["root",o,i&&"fullWidth"],grouped:["grouped",`grouped${K(o)}`,c&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return me(g,hs,r)},ms=se("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[{[`& .${k.grouped}`]:r.grouped},{[`& .${k.grouped}`]:r[`grouped${K(o.orientation)}`]},{[`& .${k.firstButton}`]:r.firstButton},{[`& .${k.lastButton}`]:r.lastButton},{[`& .${k.middleButton}`]:r.middleButton},r.root,o.orientation==="vertical"&&r.vertical,o.fullWidth&&r.fullWidth]}})(ge(({theme:t})=>({display:"inline-flex",borderRadius:(t.vars||t).shape.borderRadius,variants:[{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${k.grouped}`]:{[`&.${k.selected} + .${k.grouped}.${k.selected}`]:{borderTop:0,marginTop:0}},[`& .${k.firstButton},& .${k.middleButton}`]:{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`& .${k.lastButton},& .${k.middleButton}`]:{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},[`& .${k.lastButton}.${ce.disabled},& .${k.middleButton}.${ce.disabled}`]:{borderTop:"1px solid transparent"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"horizontal"},style:{[`& .${k.grouped}`]:{[`&.${k.selected} + .${k.grouped}.${k.selected}`]:{borderLeft:0,marginLeft:0}},[`& .${k.firstButton},& .${k.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${k.lastButton},& .${k.middleButton}`]:{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},[`& .${k.lastButton}.${ce.disabled},& .${k.middleButton}.${ce.disabled}`]:{borderLeft:"1px solid transparent"}}}]}))),gs=a.forwardRef(function(r,o){const i=fe({props:r,name:"MuiToggleButtonGroup"}),{children:c,className:g,color:f="standard",disabled:h=!1,exclusive:j=!1,fullWidth:m=!1,onChange:b,orientation:p="horizontal",size:S="medium",value:$,...L}=i,M={...i,disabled:h,fullWidth:m,orientation:p,size:S},T=fs(M),_=a.useCallback((v,y)=>{if(!b)return;const E=$&&$.indexOf(y);let G;$&&E>=0?(G=$.slice(),G.splice(E,1)):G=$?$.concat(y):[y],b(v,G)},[b,$]),R=a.useCallback((v,y)=>{b&&b(v,$===y?null:y)},[b,$]),D=a.useMemo(()=>({className:T.grouped,onChange:j?R:_,value:$,size:S,fullWidth:m,color:f,disabled:h}),[T.grouped,j,R,_,$,S,m,f,h]),O=Nt(c),F=O.length,Y=v=>{const y=v===0,E=v===F-1;return y&&E?"":y?T.firstButton:E?T.lastButton:T.middleButton};return e.jsx(ms,{role:"group",className:J(T.root,g),ref:o,ownerState:M,...L,children:e.jsx(xt.Provider,{value:D,children:O.map((v,y)=>e.jsx(ht.Provider,{value:Y(y),children:v},y))})})}),rt=nt(e.jsx("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"})),ot=nt(e.jsx("path",{d:"M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2M1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2"})),Os=()=>{const t="construction",[r,o]=a.useState(1),[i,c]=a.useState(""),[g,f]=a.useState(""),[h,j]=a.useState(!1),[m,b]=a.useState(""),[p,S]=a.useState({}),[$,L]=a.useState([]),[M,T]=a.useState([]),[_,R]=a.useState([]),[D,O]=a.useState("all"),[F,Y]=a.useState("cards"),[v,y]=a.useState(!1),[E,G]=a.useState(null),[C,N]=a.useState(null),[Q,A]=a.useState(!1),[re,oe]=a.useState(""),[de,d]=a.useState(!1),[P,H]=a.useState(""),[je,ve]=a.useState(""),be=$t("(max-width:600px)"),[ke,X]=a.useState(!1),[w,ft]=a.useState(null),mt=s=>{ft(s),X(!0)};a.useEffect(()=>{(async()=>{try{const n=await _t();T(n??[])}catch(n){console.error("Error fetching projects:",n)}})()},[]);const ze=async()=>{try{y(!0);const s=await wt();R(Array.isArray(s)?s:[])}catch(s){console.error("âŒ Failed to fetch site executions:",s)}finally{y(!1)}};a.useEffect(()=>{ze()},[]);const qe=s=>{b(s);const n=new Date().getFullYear(),z=_.filter(Le=>{var pe;return(pe=Le.site_id)==null?void 0:pe.startsWith(`SIT-${n}-`)});let I=0;z.length>0&&z.forEach(Le=>{var Ve;const pe=(Ve=Le.site_id)==null?void 0:Ve.split("-");if(pe&&pe.length===3){const Ye=parseInt(pe[2]);Ye>I&&(I=Ye)}});const u=I+1,jt=String(u).padStart(4,"0");S({siteId:`SIT-${n}-${jt}`,project:s}),j(!0)},_e=()=>j(!1),V=s=>{const{name:n,value:z}=s.target;S(I=>({...I,[n]:z}))},gt=async()=>{try{const s={project:m,site_supervisor_id:p.siteSupervisorID,daily_progress_report_id:p.dailyProgressReportID,work_completed:p.workCompleted,manpower_utilized:p.manpowerUtilize,equipment_used:p.equipmentUsed,weather_conditions:p.wetherCondition,safety_compliance_report:p.safetyCompliance,material_consumption:p.materialConsumption,site_issues:p.siteIssues,site_execution_status:p.siteStatus||"on track"};if(E)await Ie(E,s),alert("âœ… Site Execution updated successfully!");else{const n=await It(s);alert(`âœ… Site Execution saved!
Site ID: ${n.site_id}`)}S({}),G(null),_e(),ze()}catch(s){if(console.error("âŒ Failed to save site execution:",s),s.response&&s.response.data){const n=s.response.data.detail||JSON.stringify(s.response.data);alert(`âŒ Error: ${n}`)}else alert("âŒ An unexpected error occurred. Please try again.")}},Ee=async s=>{if(window.confirm(`Are you sure you want to delete this site execution with siteId: ${s}?`))try{await St(s),alert(`âœ… Site execution with siteID: ${s} deleted successfully!`),ze()}catch(n){console.error("âŒ Failed to delete site execution:",n),alert("âŒ Failed to delete site execution. Please try again.")}},We=s=>{S({siteId:s.site_id,siteSupervisorID:s.site_supervisor_id,dailyProgressReportID:s.daily_progress_report_id,workCompleted:s.work_completed,manpowerUtilize:s.manpower_utilized,equipmentUsed:s.equipment_used,wetherCondition:s.weather_conditions,safetyCompliance:s.safety_compliance_report,materialConsumption:s.material_consumption,siteIssues:s.site_issues,siteStatus:s.site_execution_status}),b(s.project),G(s.site_id),j(!0)},ue=async(s,n)=>{const z=[..._];R(I=>I.map(u=>u.site_id===s.site_id?{...u,site_execution_status:n}:u));try{await Ie(s.site_id,{site_execution_status:n})}catch(I){console.error("Failed to update status",I),R(z),alert("Failed to update status. Please try again.")}},we=a.useMemo(()=>(M||[]).filter(s=>Object.values(s).some(n=>n&&n.toString().toLowerCase().includes(i.toLowerCase()))),[M,i]),Z=a.useMemo(()=>{const s=_.length,n=_.reduce((z,I)=>{const u=(I.site_execution_status||"").toLowerCase();return z[u]=(z[u]||0)+1,z},{});return{total:s,onTrack:n["on track"]||0,delayed:n.delayed||0,halted:n.halted||0}},[_]),Se=a.useMemo(()=>{const s=g.trim().toLowerCase();return(_||[]).filter(n=>D==="all"?!0:(n.site_execution_status||"").toLowerCase()===D).filter(n=>s?[n.project,n.site_id,n.site_supervisor_id,n.daily_progress_report_id,n.work_completed,n.manpower_utilized,n.equipment_used,n.weather_conditions,n.safety_compliance_report,n.material_consumption,n.site_issues,n.site_execution_status].filter(Boolean).join(" ").toLowerCase().includes(s):!0)},[_,D,g]);return e.jsxs(e.Fragment,{children:[e.jsxs(ye,{sx:{mt:2,mb:2,px:2,py:2,borderRadius:2,background:"linear-gradient(135deg, rgba(114,103,239,0.12) 0%, rgba(114,103,239,0.04) 100%)",border:"1px solid",borderColor:"divider"},children:[e.jsx(B,{variant:"h5",sx:{color:"#2f2a8d",fontWeight:700},children:"Site Execution"}),e.jsx(B,{variant:"body2",color:"text.secondary",children:"Track progress, log issues, and request materials in one tap."})]}),e.jsx(l,{container:!0,spacing:2,sx:{mb:2},children:[{label:"Total",value:Z.total,color:"#7267ef"},{label:"On Track",value:Z.onTrack,color:"#2e7d32"},{label:"Delayed",value:Z.delayed,color:"#ed6c02"},{label:"Halted",value:Z.halted,color:"#d32f2f"}].map(s=>e.jsx(l,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(Pe,{elevation:0,sx:{p:2,borderRadius:2,border:"1px solid",borderColor:"divider",backgroundColor:"background.paper"},children:[e.jsx(B,{variant:"overline",sx:{color:"text.secondary"},children:s.label}),e.jsx(B,{variant:"h5",sx:{color:s.color,fontWeight:700},children:s.value})]})},s.label))}),e.jsx(l,{container:!0,spacing:2,direction:"column",sx:{mb:2},children:e.jsx(l,{item:!0,xs:12,children:e.jsxs(Pe,{elevation:0,sx:{p:2,borderRadius:2,border:"1px solid",borderColor:"divider",backgroundColor:"background.paper"},children:[e.jsxs(l,{container:!0,alignItems:"center",justifyContent:"space-between",sx:{mb:1},children:[e.jsx(l,{item:!0,children:e.jsx(B,{variant:"h6",sx:{color:"#7267ef"},children:"Project Records"})}),e.jsx(l,{item:!0,children:e.jsx(ie,{label:`${we.length} projects`,size:"small"})})]}),e.jsx(W,{fullWidth:!0,size:"small",placeholder:"Search project by any field (e.g., ID)",value:i,onChange:s=>c(s.target.value),InputProps:{startAdornment:e.jsx(Je,{position:"start",children:"ðŸ”Ž"})},sx:{mb:2}}),e.jsxs(Ke,{size:"small",children:[e.jsx(Ze,{children:e.jsxs(xe,{children:[e.jsx(x,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project ID"})}),e.jsx(x,{align:"right",sx:{color:"#660000"},children:e.jsx("strong",{children:"Action"})})]})}),e.jsxs(et,{children:[we.map((s,n)=>e.jsxs(xe,{hover:!0,children:[e.jsx(x,{children:s.project_id}),e.jsx(x,{align:"right",children:e.jsx(Me,{slug:t,action:"can_create",children:e.jsx(te,{title:"Create site execution for this project",children:e.jsx(Re,{onClick:()=>qe(s.project_id),color:"primary",children:e.jsx(tt,{sx:{color:"#7267ef"}})})})})})]},n)),we.length===0&&e.jsx(xe,{children:e.jsx(x,{colSpan:2,children:e.jsx(B,{variant:"body2",color:"text.secondary",children:"No projects found"})})})]})]})]})})}),e.jsx(l,{container:!0,spacing:2,children:e.jsx(l,{item:!0,xs:12,children:e.jsxs(Pe,{sx:{p:2,backgroundColor:"#fff",border:"1px solid #eee"},children:[e.jsxs(l,{container:!0,spacing:2,alignItems:"center",sx:{mb:1},children:[e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(B,{variant:"h6",sx:{color:"#7267ef"},children:"Site Executions"})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsxs(l,{container:!0,spacing:1,justifyContent:{xs:"flex-start",md:"flex-end"},children:[e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(W,{fullWidth:!0,size:"small",placeholder:"Search sites",value:g,onChange:s=>f(s.target.value),InputProps:{startAdornment:e.jsx(Je,{position:"start",children:"ðŸ”Ž"})}})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(he,{direction:"row",spacing:1,justifyContent:{xs:"flex-start",md:"flex-end"},sx:{flexWrap:"wrap",rowGap:1,columnGap:1},children:[{key:"all",label:`All (${Z.total})`},{key:"on track",label:`On Track (${Z.onTrack})`},{key:"delayed",label:`Delayed (${Z.delayed})`},{key:"halted",label:`Halted (${Z.halted})`}].map(s=>e.jsx(ie,{label:s.label,color:D===s.key?"primary":"default",variant:D===s.key?"filled":"outlined",onClick:()=>O(s.key),size:"small",sx:{borderRadius:999,px:1,mr:0,mb:0}},s.key))})}),e.jsx(l,{item:!0,xs:12,md:"auto",children:e.jsxs(gs,{size:"small",value:F,exclusive:!0,onChange:(s,n)=>n&&Y(n),"aria-label":"view mode",children:[e.jsx(st,{value:"cards","aria-label":"cards view",children:"Cards"}),e.jsx(st,{value:"table","aria-label":"table view",children:"Table"})]})})]})})]}),v?e.jsx(ye,{display:"flex",alignItems:"center",justifyContent:"center",sx:{minHeight:200},children:e.jsx(Ct,{})}):F==="table"?e.jsx(Wt,{sx:{maxHeight:420,overflow:"auto",border:"1px solid",borderColor:"divider",borderRadius:2},children:e.jsxs(Ke,{stickyHeader:!0,size:"small",children:[e.jsx(Ze,{children:e.jsxs(xe,{children:[e.jsx(x,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Project"})}),e.jsx(x,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Site ID"})}),e.jsx(x,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Supervisor"})}),e.jsx(x,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"DPR ID"})}),e.jsx(x,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Work Completed"})}),e.jsx(x,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Manpower"})}),e.jsx(x,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Equipment"})}),e.jsx(x,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Weather"})}),e.jsx(x,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Safety"})}),e.jsx(x,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Materials"})}),e.jsx(x,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Issues"})}),e.jsx(x,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Status"})}),e.jsx(x,{sx:{color:"#660000"},align:"right",children:e.jsx("strong",{children:"Actions"})})]})}),e.jsxs(et,{children:[Se.map((s,n)=>e.jsxs(xe,{hover:!0,children:[e.jsx(x,{children:s.project}),e.jsx(x,{children:s.site_id}),e.jsx(x,{children:s.site_supervisor_id}),e.jsx(x,{children:s.daily_progress_report_id}),e.jsx(x,{children:e.jsx(te,{title:s.work_completed||"",children:e.jsxs("span",{children:[(s.work_completed||"").slice(0,24),(s.work_completed||"").length>24?"â€¦":""]})})}),e.jsx(x,{children:s.manpower_utilized}),e.jsx(x,{children:e.jsx(te,{title:s.equipment_used||"",children:e.jsxs("span",{children:[(s.equipment_used||"").slice(0,16),(s.equipment_used||"").length>16?"â€¦":""]})})}),e.jsx(x,{children:s.weather_conditions}),e.jsx(x,{children:e.jsx(te,{title:s.safety_compliance_report||"",children:e.jsxs("span",{children:[(s.safety_compliance_report||"").slice(0,16),(s.safety_compliance_report||"").length>16?"â€¦":""]})})}),e.jsx(x,{children:e.jsx(te,{title:s.material_consumption||"",children:e.jsxs("span",{children:[(s.material_consumption||"").slice(0,16),(s.material_consumption||"").length>16?"â€¦":""]})})}),e.jsx(x,{children:e.jsx(te,{title:s.site_issues||"",children:e.jsxs("span",{children:[(s.site_issues||"").slice(0,20),(s.site_issues||"").length>20?"â€¦":""]})})}),e.jsx(x,{children:(()=>{const z=(s.site_execution_status||"").toLowerCase(),u={"on track":{color:"success",label:"On Track"},delayed:{color:"warning",label:"Delayed"},halted:{color:"error",label:"Halted"}}[z]||{color:"default",label:s.site_execution_status||"-"};return e.jsx(ie,{label:u.label,color:u.color,size:"small",variant:u.color==="default"?"outlined":"filled"})})()}),e.jsxs(x,{align:"right",children:[e.jsx(ee,{slug:t,action:"can_update",children:e.jsx(te,{title:"Edit",children:e.jsx(Re,{color:"warning",onClick:()=>We(s),children:e.jsx(Ne,{sx:{color:"orange"}})})})}),e.jsx(Me,{slug:t,action:"can_delete",children:e.jsx(te,{title:"Delete",children:e.jsx(Re,{color:"error",onClick:()=>Ee(s.site_id),children:e.jsx(Ge,{sx:{color:"red"}})})})})]})]},`${s.site_id}-${n}`)),Se.length===0&&e.jsx(xe,{children:e.jsx(x,{colSpan:13,children:e.jsx(B,{variant:"body2",color:"text.secondary",children:"No site executions found"})})})]})]})}):e.jsx(e.Fragment,{children:Se.length===0?e.jsx(ye,{sx:{p:3},children:e.jsx(B,{variant:"body2",color:"text.secondary",children:"No site executions found"})}):e.jsx(l,{container:!0,spacing:2,children:Se.map((s,n)=>{const z=(s.site_execution_status||"").toLowerCase(),I={"on track":{color:"success",label:"On Track"},delayed:{color:"warning",label:"Delayed"},halted:{color:"error",label:"Halted"}}[z]||{color:"default",label:s.site_execution_status||"-"};return e.jsx(l,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsxs(Dt,{onClick:()=>{be&&mt(s)},sx:{height:"100%",display:"flex",flexDirection:"column",border:"1px solid",borderColor:"divider",borderRadius:2,transition:"box-shadow 0.2s ease","&:hover":{boxShadow:3},cursor:be?"pointer":"default"},children:[e.jsxs(zt,{sx:{pb:1},children:[e.jsxs(he,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:1},children:[e.jsx(B,{variant:"subtitle2",color:"text.secondary",children:s.project}),e.jsx(ie,{label:I.label,color:I.color,size:"small",variant:I.color==="default"?"outlined":"filled"})]}),e.jsx(B,{variant:"h6",sx:{color:"#2f2a8d",mb:.5},children:s.site_id}),e.jsxs(B,{variant:"body2",color:"text.secondary",children:["Supervisor: ",s.site_supervisor_id||"-"]}),e.jsxs(B,{variant:"body2",color:"text.secondary",children:["DPR: ",s.daily_progress_report_id||"-"]}),!!s.work_completed&&e.jsxs(B,{variant:"body2",sx:{mt:1},children:[e.jsx("strong",{children:"Work:"})," ",(s.work_completed||"").slice(0,90),(s.work_completed||"").length>90?"â€¦":""]}),!!s.site_issues&&e.jsxs(B,{variant:"body2",color:"error",sx:{mt:.5},children:[e.jsx("strong",{children:"Issue:"})," ",(s.site_issues||"").slice(0,90),(s.site_issues||"").length>90?"â€¦":""]})]}),e.jsx(Vt,{sx:{mt:"auto",p:1.5,pt:0},children:e.jsxs(he,{direction:"column",spacing:1,sx:{width:"100%"},children:[e.jsxs(he,{direction:"row",spacing:1,children:[e.jsx(ee,{slug:t,action:"can_update",children:e.jsx(U,{fullWidth:!0,variant:"contained",color:"success",size:"small",onClick:u=>{u.stopPropagation(),ue(s,"on track")},children:"On Track"})}),e.jsx(ee,{slug:t,action:"can_update",children:e.jsx(U,{fullWidth:!0,variant:"contained",color:"warning",size:"small",onClick:u=>{u.stopPropagation(),ue(s,"delayed")},children:"Delay"})}),e.jsx(ee,{slug:t,action:"can_update",children:e.jsx(U,{fullWidth:!0,variant:"contained",color:"error",size:"small",onClick:u=>{u.stopPropagation(),ue(s,"halted")},children:"Halt"})})]}),e.jsxs(he,{direction:"row",spacing:1,children:[e.jsx(ee,{slug:t,action:"can_update",children:e.jsx(U,{fullWidth:!0,variant:"outlined",color:"warning",size:"small",startIcon:e.jsx(rt,{}),onClick:u=>{u.stopPropagation(),N(s),oe(""),A(!0)},children:"Log Issue"})}),e.jsx(ee,{slug:t,action:"can_update",children:e.jsx(U,{fullWidth:!0,variant:"outlined",color:"info",size:"small",startIcon:e.jsx(ot,{}),onClick:u=>{u.stopPropagation(),N(s),H(""),ve(""),d(!0)},children:"Request Materials"})})]}),e.jsxs(he,{direction:"row",spacing:1,children:[e.jsx(ee,{slug:t,action:"can_update",children:e.jsx(U,{fullWidth:!0,variant:"outlined",size:"small",startIcon:e.jsx(Ne,{}),onClick:u=>{u.stopPropagation(),We(s)},children:"Update"})}),e.jsx(Me,{slug:t,action:"can_delete",children:e.jsx(U,{fullWidth:!0,variant:"outlined",color:"error",size:"small",startIcon:e.jsx(Ge,{}),onClick:u=>{u.stopPropagation(),Ee(s.site_id)},children:"Delete"})})]})]})})]})},`${s.site_id}-${n}`)})})})]})})}),e.jsxs(Oe,{open:h,onClose:_e,fullWidth:!0,maxWidth:"md",children:[e.jsx(Ae,{sx:{backgroundColor:"#f7f7fb",color:"#2f2a8d"},children:"Enter Site Execution Details"}),e.jsxs(Fe,{sx:{position:"relative"},children:[e.jsx(Re,{"aria-label":"close",onClick:_e,sx:{position:"absolute",right:8,top:8,color:s=>s.palette.grey[500]},children:e.jsx(kt,{})}),e.jsx(ye,{component:"form",sx:{mt:2},children:e.jsxs(l,{container:!0,spacing:3,direction:"column",children:[e.jsxs(l,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Project Information"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{item:!0,xs:6,children:e.jsx(W,{fullWidth:!0,size:"small",label:"Project ID",id:"projectId",value:m,disabled:!0})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(W,{fullWidth:!0,size:"small",label:"Site ID",id:"siteId",value:p.siteId||"",disabled:!0})})]})]}),e.jsxs(l,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Site Information"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{item:!0,xs:6,children:e.jsx(W,{fullWidth:!0,size:"small",label:"Site Supervisor ID",id:"siteSupervisorID",name:"siteSupervisorID",value:p.siteSupervisorID||"",onChange:V})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(W,{fullWidth:!0,size:"small",label:"Daily Progress Report ID",id:"dailyProgressReportID",name:"dailyProgressReportID",value:p.dailyProgressReportID||"",onChange:V})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(W,{fullWidth:!0,size:"small",label:"Work Completed",id:"workCompleted",name:"workCompleted",value:p.workCompleted||"",onChange:V})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(W,{fullWidth:!0,size:"small",type:"number",label:"Manpower Utilized",id:"manpowerUtilize",name:"manpowerUtilize",value:p.manpowerUtilize||"",onChange:V})})]})]}),e.jsxs(l,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Weather & Materials"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{item:!0,xs:6,children:e.jsx(W,{fullWidth:!0,size:"small",label:"Equipment Used",id:"equipmentUsed",name:"equipmentUsed",value:p.equipmentUsed||"",onChange:V})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(W,{fullWidth:!0,size:"small",label:"Weather Condition",id:"wetherCondition",name:"wetherCondition",value:p.wetherCondition||"",onChange:V})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(W,{fullWidth:!0,size:"small",label:"Safety Compliance Report",id:"safetyCompliance",name:"safetyCompliance",value:p.safetyCompliance||"",onChange:V})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(W,{fullWidth:!0,size:"small",label:"Material Consumption",id:"materialConsumption",name:"materialConsumption",value:p.materialConsumption||"",onChange:V})})]})]}),e.jsxs(l,{item:!0,xs:12,children:[e.jsx("h3",{style:{color:"#7267ef"},children:"Site Issues & Status"}),e.jsx("hr",{style:{borderTop:"2px solid #7267ef",width:"80%"}}),e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{item:!0,xs:6,children:e.jsx(W,{fullWidth:!0,size:"small",label:"Site Issues",id:"siteIssues",name:"siteIssues",multiline:!0,minRows:3,value:p.siteIssues||"",onChange:V})}),e.jsx(l,{item:!0,xs:6,children:e.jsxs(W,{select:!0,fullWidth:!0,size:"small",id:"siteStatus",name:"siteStatus",label:"Site Execution Status",SelectProps:{native:!0},value:p.siteStatus||"on track",onChange:V,children:[e.jsx("option",{value:"on track",children:"On Track"}),e.jsx("option",{value:"delayed",children:"Delayed"}),e.jsx("option",{value:"halted",children:"Halted"})]})})]})]})]})})]}),e.jsxs(Ue,{children:[e.jsx(U,{onClick:_e,sx:{outline:"2px solid #800000",color:"#800000","&:hover":{outline:"2px solid #b30000",color:"#b30000"}},children:"Cancel"}),e.jsx(ee,{slug:t,action:"can_create",children:e.jsx(U,{variant:"outlined",onClick:gt,sx:{borderColor:"#7267ef",color:"#7267ef","&:hover":{borderColor:"#9e8df2",color:"#9e8df2"}},children:"Submit"})})]})]}),e.jsxs(Oe,{open:Q,onClose:()=>A(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(Ae,{sx:{backgroundColor:"#f7f7fb",color:"#2f2a8d"},children:"Log Issue"}),e.jsxs(Fe,{children:[e.jsxs(B,{variant:"body2",color:"text.secondary",sx:{mb:1},children:["Site: ",(C==null?void 0:C.site_id)||"-"," | Project: ",(C==null?void 0:C.project)||"-"]}),e.jsx(W,{fullWidth:!0,multiline:!0,minRows:3,label:"Describe the issue",value:re,onChange:s=>oe(s.target.value)})]}),e.jsxs(Ue,{children:[e.jsx(U,{onClick:()=>A(!1),color:"inherit",children:"Cancel"}),e.jsx(U,{variant:"contained",sx:{backgroundColor:"#7267ef"},onClick:async()=>{if(!C||!re.trim()){A(!1);return}const n=`[${new Date().toLocaleString()}] ISSUE: ${re.trim()}`,z=[..._];R(I=>I.map(u=>u.site_id===C.site_id?{...u,site_issues:(u.site_issues||"")+(u.site_issues?`
`:"")+n}:u));try{await Ie(C.site_id,{site_issues:(C.site_issues||"")+(C.site_issues?`
`:"")+n})}catch{R(z),alert("Failed to log issue")}finally{A(!1)}},children:"Save"})]})]}),e.jsxs(Oe,{open:de,onClose:()=>d(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(Ae,{sx:{backgroundColor:"#f7f7fb",color:"#2f2a8d"},children:"Request Materials"}),e.jsxs(Fe,{children:[e.jsxs(B,{variant:"body2",color:"text.secondary",sx:{mb:1},children:["Site: ",(C==null?void 0:C.site_id)||"-"," | Project: ",(C==null?void 0:C.project)||"-"]}),e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{item:!0,xs:12,sm:8,children:e.jsx(W,{fullWidth:!0,size:"small",label:"Material Item",value:P,onChange:s=>H(s.target.value)})}),e.jsx(l,{item:!0,xs:12,sm:4,children:e.jsx(W,{fullWidth:!0,size:"small",type:"number",label:"Qty",value:je,onChange:s=>ve(s.target.value)})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(B,{variant:"caption",color:"text.secondary",children:"A simple note will be appended to Site Issues to notify procurement."})})]})]}),e.jsxs(Ue,{children:[e.jsx(U,{onClick:()=>d(!1),color:"inherit",children:"Cancel"}),e.jsx(U,{variant:"contained",sx:{backgroundColor:"#7267ef"},onClick:async()=>{if(!C||!P.trim()||!je){d(!1);return}const n=`[${new Date().toLocaleString()}] MATERIAL REQUEST: ${P.trim()} x ${je}`,z=[..._];R(I=>I.map(u=>u.site_id===C.site_id?{...u,site_issues:(u.site_issues||"")+(u.site_issues?`
`:"")+n}:u));try{await Ie(C.site_id,{site_issues:(C.site_issues||"")+(C.site_issues?`
`:"")+n})}catch{R(z),alert("Failed to request materials")}finally{d(!1)}},children:"Send"})]})]}),e.jsx(Et,{color:"primary",sx:{position:"fixed",right:24,bottom:24,backgroundColor:"#7267ef",boxShadow:6},onClick:()=>{const s=we[0];s!=null&&s.project_id&&qe(s.project_id)},"aria-label":"quick add",children:e.jsx(tt,{})}),e.jsxs(os,{anchor:"bottom",open:ke,onClose:()=>X(!1),PaperProps:{sx:{borderTopLeftRadius:12,borderTopRightRadius:12}},children:[e.jsxs(ye,{sx:{p:2,pb:0},children:[e.jsx(B,{variant:"subtitle1",sx:{fontWeight:700},children:(w==null?void 0:w.site_id)||"Site"}),e.jsxs(B,{variant:"caption",color:"text.secondary",children:["Supervisor: ",(w==null?void 0:w.site_supervisor_id)||"-"," Â· Project: ",(w==null?void 0:w.project)||"-"]})]}),e.jsxs(At,{children:[e.jsxs(ae,{onClick:()=>{w&&ue(w,"on track"),X(!1)},children:[e.jsx(le,{children:e.jsx(ie,{size:"small",color:"success",label:"On"})}),e.jsx(ne,{primary:"Mark On Track"})]}),e.jsxs(ae,{onClick:()=>{w&&ue(w,"delayed"),X(!1)},children:[e.jsx(le,{children:e.jsx(ie,{size:"small",color:"warning",label:"Delay"})}),e.jsx(ne,{primary:"Mark Delayed"})]}),e.jsxs(ae,{onClick:()=>{w&&ue(w,"halted"),X(!1)},children:[e.jsx(le,{children:e.jsx(ie,{size:"small",color:"error",label:"Halt"})}),e.jsx(ne,{primary:"Mark Halted"})]}),e.jsx(Xe,{}),e.jsxs(ae,{onClick:()=>{w&&(N(w),oe(""),A(!0)),X(!1)},children:[e.jsx(le,{children:e.jsx(rt,{color:"warning"})}),e.jsx(ne,{primary:"Log Issue",secondary:"Add a quick issue note"})]}),e.jsxs(ae,{onClick:()=>{w&&(N(w),H(""),ve(""),d(!0)),X(!1)},children:[e.jsx(le,{children:e.jsx(ot,{color:"info"})}),e.jsx(ne,{primary:"Request Materials",secondary:"Send a simple request"})]}),e.jsx(Xe,{}),e.jsxs(ae,{onClick:()=>{w&&We(w),X(!1)},children:[e.jsx(le,{children:e.jsx(Ne,{})}),e.jsx(ne,{primary:"Update Details"})]}),e.jsxs(ae,{onClick:()=>{w&&Ee(w.site_id),X(!1)},children:[e.jsx(le,{children:e.jsx(Ge,{color:"error"})}),e.jsx(ne,{primary:"Delete"})]})]})]})]})};export{Os as default};
