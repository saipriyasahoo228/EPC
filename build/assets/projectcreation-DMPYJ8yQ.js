import{m as it,n as lt,o as At,q as Et,t as Mt,v as Nt,w as kt,x as Lt,y as _t,z as $t,A as Ut,r as s,j as e}from"./main-DTv03d8r.js";import{C as He}from"./Close-BAEP8ymL.js";import{C as Ge}from"./CheckCircle-BHtT40I4.js";import{a as ct,g as pt,p as Ke,P as Ft,b as ke,j as Je,f as dt,u as ut,s as we,k as Bt,A as ge,C as Vt,l as qe,E as Wt,d as Xe,n as je,F as zt,e as ht,m as _e,h as ft,G as Ye,c as $e,T as C,q as te,H as De,v as Ie,w as Oe,x as q,y as l,z as Ae,D as Qe,r as Ze,I as et,t as tt}from"./TableRow-DyRCyY9b.js";import{g as Ht,a as Ee,b as Gt,e as Kt,f as Jt}from"./tenderAllocation-BDWIXX9t.js";import{B as ye}from"./Box-CyTnG5kx.js";import{u as qt,a as mt}from"./KeyboardArrowRight-CpSviFou.js";import{u as Xt,G as Yt,T as Qt}from"./TablePagination-C-yj9544.js";import{T as Me}from"./TableContainer-DOhr4ZW5.js";import{G as z}from"./Grid-C5mdLuvI.js";import"./Transition-ChWAEdMD.js";import"./api-Dv6wi5j0.js";import"./auth-4s9nFscl.js";function Zt(o){var t=o.state;Object.keys(t.elements).forEach(function(r){var a=t.styles[r]||{},c=t.attributes[r]||{},u=t.elements[r];!it(u)||!lt(u)||(Object.assign(u.style,a),Object.keys(c).forEach(function(j){var d=c[j];d===!1?u.removeAttribute(j):u.setAttribute(j,d===!0?"":d)}))})}function eo(o){var t=o.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow),function(){Object.keys(t.elements).forEach(function(a){var c=t.elements[a],u=t.attributes[a]||{},j=Object.keys(t.styles.hasOwnProperty(a)?t.styles[a]:r[a]),d=j.reduce(function(x,R){return x[R]="",x},{});!it(c)||!lt(c)||(Object.assign(c.style,d),Object.keys(u).forEach(function(x){c.removeAttribute(x)}))})}}const to={name:"applyStyles",enabled:!0,phase:"write",fn:Zt,effect:eo,requires:["computeStyles"]};var oo=[Et,Mt,Nt,to,kt,Lt,_t,$t,Ut],ro=At({defaultModifiers:oo});function no(o){return ct("MuiPopper",o)}pt("MuiPopper",["root"]);function so(o,t){if(t==="ltr")return o;switch(o){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return o}}function Le(o){return typeof o=="function"?o():o}function ao(o){return o.nodeType!==void 0}const io=o=>{const{classes:t}=o;return dt({root:["root"]},no,t)},lo={},co=s.forwardRef(function(t,r){const{anchorEl:a,children:c,direction:u,disablePortal:j,modifiers:d,open:x,placement:R,popperOptions:g,popperRef:k,slotProps:H={},slots:B={},TransitionProps:S,ownerState:A,...L}=t,D=s.useRef(null),T=ke(D,r),w=s.useRef(null),f=ke(w,k),I=s.useRef(f);Je(()=>{I.current=f},[f]),s.useImperativeHandle(k,()=>w.current,[]);const E=so(R,u),[V,G]=s.useState(E),[W,y]=s.useState(Le(a));s.useEffect(()=>{w.current&&w.current.forceUpdate()}),s.useEffect(()=>{a&&y(Le(a))},[a]),Je(()=>{if(!W||!x)return;const re=N=>{G(N.placement)};let M=[{name:"preventOverflow",options:{altBoundary:j}},{name:"flip",options:{altBoundary:j}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:N})=>{re(N)}}];d!=null&&(M=M.concat(d)),g&&g.modifiers!=null&&(M=M.concat(g.modifiers));const P=ro(W,D.current,{placement:E,...g,modifiers:M});return I.current(P),()=>{P.destroy(),I.current(null)}},[W,j,d,x,g,E]);const O={placement:V};S!==null&&(O.TransitionProps=S);const oe=io(t),_=B.root??"div",Z=qt({elementType:_,externalSlotProps:H.root,externalForwardedProps:L,additionalProps:{role:"tooltip",ref:T},ownerState:t,className:oe.root});return e.jsx(_,{...Z,children:typeof c=="function"?c(O):c})}),po=s.forwardRef(function(t,r){const{anchorEl:a,children:c,container:u,direction:j="ltr",disablePortal:d=!1,keepMounted:x=!1,modifiers:R,open:g,placement:k="bottom",popperOptions:H=lo,popperRef:B,style:S,transition:A=!1,slotProps:L={},slots:D={},...T}=t,[w,f]=s.useState(!0),I=()=>{f(!1)},E=()=>{f(!0)};if(!x&&!g&&(!A||w))return null;let V;if(u)V=u;else if(a){const y=Le(a);V=y&&ao(y)?Ke(y).body:Ke(null).body}const G=!g&&x&&(!A||w)?"none":void 0,W=A?{in:g,onEnter:I,onExited:E}:void 0;return e.jsx(Ft,{disablePortal:d,container:V,children:e.jsx(co,{anchorEl:a,direction:j,disablePortal:d,modifiers:R,ref:r,open:A?!w:g,placement:k,popperOptions:H,popperRef:B,slotProps:L,slots:D,...T,style:{position:"fixed",top:0,left:0,display:G,...S},TransitionProps:W,children:c})})}),uo=we(po,{name:"MuiPopper",slot:"Root",overridesResolver:(o,t)=>t.root})({}),xt=s.forwardRef(function(t,r){const a=mt(),c=ut({props:t,name:"MuiPopper"}),{anchorEl:u,component:j,components:d,componentsProps:x,container:R,disablePortal:g,keepMounted:k,modifiers:H,open:B,placement:S,popperOptions:A,popperRef:L,transition:D,slots:T,slotProps:w,...f}=c,I=(T==null?void 0:T.root)??(d==null?void 0:d.Root),E={anchorEl:u,container:R,disablePortal:g,keepMounted:k,modifiers:H,open:B,placement:S,popperOptions:A,popperRef:L,transition:D,...f};return e.jsx(uo,{as:j,direction:a?"rtl":"ltr",slots:{root:I},slotProps:w??x,...E,ref:r})});function ho(o){return ct("MuiTooltip",o)}const m=pt("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function fo(o){return Math.round(o*1e5)/1e5}const mo=o=>{const{classes:t,disableInteractive:r,arrow:a,touch:c,placement:u}=o,j={popper:["popper",!r&&"popperInteractive",a&&"popperArrow"],tooltip:["tooltip",a&&"tooltipArrow",c&&"touch",`tooltipPlacement${ht(u.split("-")[0])}`],arrow:["arrow"]};return dt(j,ho,t)},xo=we(xt,{name:"MuiTooltip",slot:"Popper",overridesResolver:(o,t)=>{const{ownerState:r}=o;return[t.popper,!r.disableInteractive&&t.popperInteractive,r.arrow&&t.popperArrow,!r.open&&t.popperClose]}})(_e(({theme:o})=>({zIndex:(o.vars||o).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:t})=>!t.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:t})=>!t,style:{pointerEvents:"none"}},{props:({ownerState:t})=>t.arrow,style:{[`&[data-popper-placement*="bottom"] .${m.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${m.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${m.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${m.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:t})=>t.arrow&&!t.isRtl,style:{[`&[data-popper-placement*="right"] .${m.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:t})=>t.arrow&&!!t.isRtl,style:{[`&[data-popper-placement*="right"] .${m.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:t})=>t.arrow&&!t.isRtl,style:{[`&[data-popper-placement*="left"] .${m.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:t})=>t.arrow&&!!t.isRtl,style:{[`&[data-popper-placement*="left"] .${m.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),go=we("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(o,t)=>{const{ownerState:r}=o;return[t.tooltip,r.touch&&t.touch,r.arrow&&t.tooltipArrow,t[`tooltipPlacement${ht(r.placement.split("-")[0])}`]]}})(_e(({theme:o})=>({backgroundColor:o.vars?o.vars.palette.Tooltip.bg:ft(o.palette.grey[700],.92),borderRadius:(o.vars||o).shape.borderRadius,color:(o.vars||o).palette.common.white,fontFamily:o.typography.fontFamily,padding:"4px 8px",fontSize:o.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:o.typography.fontWeightMedium,[`.${m.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${m.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${m.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${m.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:t})=>t.arrow,style:{position:"relative",margin:0}},{props:({ownerState:t})=>t.touch,style:{padding:"8px 16px",fontSize:o.typography.pxToRem(14),lineHeight:`${fo(16/14)}em`,fontWeight:o.typography.fontWeightRegular}},{props:({ownerState:t})=>!t.isRtl,style:{[`.${m.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${m.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:t})=>!t.isRtl&&t.touch,style:{[`.${m.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${m.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:t})=>!!t.isRtl,style:{[`.${m.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${m.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:t})=>!!t.isRtl&&t.touch,style:{[`.${m.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${m.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:t})=>t.touch,style:{[`.${m.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:t})=>t.touch,style:{[`.${m.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),jo=we("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(o,t)=>t.arrow})(_e(({theme:o})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:o.vars?o.vars.palette.Tooltip.bg:ft(o.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let be=!1;const ot=new zt;let pe={x:0,y:0};function ve(o,t){return(r,...a)=>{t&&t(r,...a),o(r,...a)}}const yo=s.forwardRef(function(t,r){const a=ut({props:t,name:"MuiTooltip"}),{arrow:c=!1,children:u,classes:j,components:d={},componentsProps:x={},describeChild:R=!1,disableFocusListener:g=!1,disableHoverListener:k=!1,disableInteractive:H=!1,disableTouchListener:B=!1,enterDelay:S=100,enterNextDelay:A=0,enterTouchDelay:L=700,followCursor:D=!1,id:T,leaveDelay:w=0,leaveTouchDelay:f=1500,onClose:I,onOpen:E,open:V,placement:G="bottom",PopperComponent:W,PopperProps:y={},slotProps:O={},slots:oe={},title:_,TransitionComponent:Z,TransitionProps:re,...M}=a,P=s.isValidElement(u)?u:e.jsx("span",{children:u}),N=Bt(),ne=mt(),[X,de]=s.useState(),[se,ue]=s.useState(null),Y=s.useRef(!1),ee=H||D,ae=ge(),n=ge(),p=ge(),h=ge(),[K,v]=Xt({controlled:V,default:!1,name:"Tooltip",state:"open"});let J=K;const Pe=Vt(T),ie=s.useRef(),he=qe(()=>{ie.current!==void 0&&(document.body.style.WebkitUserSelect=ie.current,ie.current=void 0),h.clear()});s.useEffect(()=>he,[he]);const Ue=i=>{ot.clear(),be=!0,v(!0),E&&!J&&E(i)},fe=qe(i=>{ot.start(800+w,()=>{be=!1}),v(!1),I&&J&&I(i),ae.start(N.transitions.duration.shortest,()=>{Y.current=!1})}),me=i=>{Y.current&&i.type!=="touchstart"||(X&&X.removeAttribute("title"),n.clear(),p.clear(),S||be&&A?n.start(be?A:S,()=>{Ue(i)}):Ue(i))},Ce=i=>{n.clear(),p.start(w,()=>{fe(i)})},[,Fe]=s.useState(!1),Be=i=>{Ye(i.target)||(Fe(!1),Ce(i))},Ve=i=>{X||de(i.currentTarget),Ye(i.target)&&(Fe(!0),me(i))},We=i=>{Y.current=!0;const F=P.props;F.onTouchStart&&F.onTouchStart(i)},gt=i=>{We(i),p.clear(),ae.clear(),he(),ie.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",h.start(L,()=>{document.body.style.WebkitUserSelect=ie.current,me(i)})},jt=i=>{P.props.onTouchEnd&&P.props.onTouchEnd(i),he(),p.start(f,()=>{fe(i)})};s.useEffect(()=>{if(!J)return;function i(F){F.key==="Escape"&&fe(F)}return document.addEventListener("keydown",i),()=>{document.removeEventListener("keydown",i)}},[fe,J]);const yt=ke(Wt(P),de,r);!_&&_!==0&&(J=!1);const Te=s.useRef(),bt=i=>{const F=P.props;F.onMouseMove&&F.onMouseMove(i),pe={x:i.clientX,y:i.clientY},Te.current&&Te.current.update()},le={},Re=typeof _=="string";R?(le.title=!J&&Re&&!k?_:null,le["aria-describedby"]=J?Pe:null):(le["aria-label"]=Re?_:null,le["aria-labelledby"]=J&&!Re?Pe:null);const $={...le,...M,...P.props,className:Xe(M.className,P.props.className),onTouchStart:We,ref:yt,...D?{onMouseMove:bt}:{}},ce={};B||($.onTouchStart=gt,$.onTouchEnd=jt),k||($.onMouseOver=ve(me,$.onMouseOver),$.onMouseLeave=ve(Ce,$.onMouseLeave),ee||(ce.onMouseOver=me,ce.onMouseLeave=Ce)),g||($.onFocus=ve(Ve,$.onFocus),$.onBlur=ve(Be,$.onBlur),ee||(ce.onFocus=Ve,ce.onBlur=Be));const Q={...a,isRtl:ne,arrow:c,disableInteractive:ee,placement:G,PopperComponentProp:W,touch:Y.current},U=typeof O.popper=="function"?O.popper(Q):O.popper,vt=s.useMemo(()=>{var F,ze;let i=[{name:"arrow",enabled:!!se,options:{element:se,padding:4}}];return(F=y.popperOptions)!=null&&F.modifiers&&(i=i.concat(y.popperOptions.modifiers)),(ze=U==null?void 0:U.popperOptions)!=null&&ze.modifiers&&(i=i.concat(U.popperOptions.modifiers)),{...y.popperOptions,...U==null?void 0:U.popperOptions,modifiers:i}},[se,y.popperOptions,U==null?void 0:U.popperOptions]),Se=mo(Q),wt=typeof O.transition=="function"?O.transition(Q):O.transition,xe={slots:{popper:d.Popper,transition:d.Transition??Z,tooltip:d.Tooltip,arrow:d.Arrow,...oe},slotProps:{arrow:O.arrow??x.arrow,popper:{...y,...U??x.popper},tooltip:O.tooltip??x.tooltip,transition:{...re,...wt??x.transition}}},[Pt,Ct]=je("popper",{elementType:xo,externalForwardedProps:xe,ownerState:Q,className:Xe(Se.popper,y==null?void 0:y.className)}),[Tt,Rt]=je("transition",{elementType:Yt,externalForwardedProps:xe,ownerState:Q}),[St,Dt]=je("tooltip",{elementType:go,className:Se.tooltip,externalForwardedProps:xe,ownerState:Q}),[It,Ot]=je("arrow",{elementType:jo,className:Se.arrow,externalForwardedProps:xe,ownerState:Q,ref:ue});return e.jsxs(s.Fragment,{children:[s.cloneElement(P,$),e.jsx(Pt,{as:W??xt,placement:G,anchorEl:D?{getBoundingClientRect:()=>({top:pe.y,left:pe.x,right:pe.x,bottom:pe.y,width:0,height:0})}:X,popperRef:Te,open:X?J:!1,id:Pe,transition:!0,...ce,...Ct,popperOptions:vt,children:({TransitionProps:i})=>e.jsx(Tt,{timeout:N.transitions.duration.shorter,...i,...Rt,children:e.jsxs(St,{...Dt,children:[_,c?e.jsx(It,{...Ot}):null]})})})]})}),rt=$e(e.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"})),nt=$e(e.jsx("path",{d:"M6 2v6h.01L6 8.01 10 12l-4 4 .01.01H6V22h12v-5.99h-.01L18 16l-4-4 4-3.99-.01-.01H18V2zm10 14.5V20H8v-3.5l4-4zm-4-5-4-4V4h8v3.5z"})),bo=$e(e.jsx("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"})),b=[];for(let o=0;o<256;++o)b.push((o+256).toString(16).slice(1));function vo(o,t=0){return(b[o[t+0]]+b[o[t+1]]+b[o[t+2]]+b[o[t+3]]+"-"+b[o[t+4]]+b[o[t+5]]+"-"+b[o[t+6]]+b[o[t+7]]+"-"+b[o[t+8]]+b[o[t+9]]+"-"+b[o[t+10]]+b[o[t+11]]+b[o[t+12]]+b[o[t+13]]+b[o[t+14]]+b[o[t+15]]).toLowerCase()}let Ne;const wo=new Uint8Array(16);function Po(){if(!Ne){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Ne=crypto.getRandomValues.bind(crypto)}return Ne(wo)}const Co=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),st={randomUUID:Co};function at(o,t,r){var c;if(st.randomUUID&&!o)return st.randomUUID();o=o||{};const a=o.random??((c=o.rng)==null?void 0:c.call(o))??Po();if(a.length<16)throw new Error("Random bytes length must be >= 16");return a[6]=a[6]&15|64,a[8]=a[8]&63|128,vo(a)}const $o=()=>{var Y,ee,ae;new Date().toISOString().split("T")[0];const[o,t]=s.useState([]),[r,a]=s.useState(null),[c,u]=s.useState(null),[j,d]=s.useState(!1),[x,R]=s.useState([]),[g,k]=s.useState([]),[H,B]=s.useState(!1),[S,A]=s.useState(""),[L,D]=s.useState(0),[T,w]=s.useState(5),[f,I]=s.useState({jobAllocationDate:"",govtProjectId:"",projectId:at(),allocationStatus:"Allocated",refundDate:"",cancellationNote:""}),E=s.useRef(),V=s.useRef(),G=s.useRef(),W=s.useRef(),y=s.useRef(),O=o.filter(n=>n.tenderId.toLowerCase().includes(S.toLowerCase())||n.title.toLowerCase().includes(S.toLowerCase())),oe=(n,p)=>{D(p)},_=n=>{w(parseInt(n.target.value,10)),D(0)},Z=x.slice(L*T,L*T+T);s.useEffect(()=>{const n=async()=>{try{const K=(await Ht()).map(v=>({tenderId:v.tender_id,title:v.tender_ref_no||"Untitled Tender",status:v.status||""}));t(K)}catch(h){console.error("Error fetching tenders:",h)}},p=async()=>{try{const h=await Ee();R(h)}catch(h){console.error("Error fetching projects:",h)}};n(),p()},[]);const re=(n,p,h={})=>{const K={id:at(),timestamp:new Date().toISOString(),action:n,tenderId:p,user:"currentUser",details:h};k(v=>[...v,K])},M=async(n,p)=>{if(u(n),d(!0),n==="accept"&&a(p),n==="view")try{const h=await Gt(p.tenderId);a(h),re("Viewed tender details",p.tenderId)}catch(h){console.error("Error fetching tender by ID:",h),alert("Failed to fetch tender details.")}n==="cancel"&&a(p)},P=()=>{d(!1),u(null),a(null)},N=n=>p=>{I({...f,[n]:p.target.value})},ne=(n,p)=>{var h;n.key==="Enter"&&(n.preventDefault(),(h=p==null?void 0:p.current)==null||h.focus())},X=async()=>{try{if(!r)return;if(c==="accept"){const n={status:"Accept",job_allocation_date:f.jobAllocationDate,govt_project_id:f.govtProjectId,allocation_state:f.allocationStatus},p=await Kt(r.tenderId,n);console.log("Project created successfully:",p),alert(`Project ${p.project_id} created successfully!`),t(K=>K.map(v=>v.tenderId===r.tenderId?{...v,status:"Accept"}:v));const h=await Ee();R(h)}if(c==="cancel"){const n={status:"Cancel",security_money_refund_date:f.refundDate,description:f.cancellationNote},p=await Jt(r.tenderId,n);console.log("Tender cancelled successfully:",p),alert("Tender cancelled successfully!"),t(K=>K.map(v=>v.tenderId===r.tenderId?{...v,status:"Cancel"}:v));const h=await Ee();R(h)}I({jobAllocationDate:"",govtProjectId:"",projectId:"",allocationStatus:"Allocated",refundDate:"",cancellationNote:""}),d(!1),a(null),u(null)}catch(n){console.error("Error submitting:",n),alert("Submission failed. Please check data and try again.")}},de=n=>{switch(n){case"accepted":return e.jsx(Ge,{color:"success"});case"cancelled":return e.jsx(rt,{color:"error"});default:return e.jsx(nt,{color:"disabled"})}},se=()=>{B(!0)},ue=()=>{B(!1)};return e.jsxs("div",{style:{padding:"1rem",position:"relative"},children:[e.jsxs(ye,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2,mb:2},children:[e.jsx(C,{variant:"h6",sx:{color:"#7267ef"},children:"TENDER STATUS FOR PROJECT CREATION"}),e.jsx(yo,{title:"View Audit Trail",children:e.jsxs(te,{variant:"outlined",startIcon:e.jsx(bo,{}),onClick:se,disabled:g.length===0,sx:{borderColor:"#7267ef",color:"#7267ef","&:hover":{borderColor:"#5a55d7",backgroundColor:"#e0e0f7"}},children:["Audit Trail (",g.length,")"]})})]}),e.jsxs(Me,{component:De,sx:{border:"1px solid #7267ef"},children:[e.jsx(ye,{mx:2,my:1,children:e.jsx("input",{type:"text",placeholder:"Search Tenders",value:S,onChange:n=>A(n.target.value),className:"input"})}),e.jsxs(Ie,{children:[e.jsx(Oe,{children:e.jsxs(q,{children:[e.jsx(l,{sx:{color:"#7267ef"},children:"Status"}),e.jsx(l,{sx:{color:"#7267ef"},children:"Tender ID"}),e.jsx(l,{sx:{color:"#7267ef"},children:"Tender Ref.No"}),e.jsx(l,{align:"center",sx:{paddingLeft:"160px",color:"#800000"},children:"Actions"})]})}),e.jsx(Ae,{children:O.map(n=>e.jsxs(q,{children:[e.jsx(l,{children:de(n.status)}),e.jsx(l,{children:n.tenderId}),e.jsx(l,{children:n.title}),e.jsx(l,{align:"right",children:e.jsxs(ye,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[e.jsx(te,{variant:"outlined",onClick:()=>M("view",n),sx:{borderColor:"#7267ef",color:"#7267ef","&:hover":{borderColor:"#5a55d7",backgroundColor:"#e0e0f7"}},children:"View"}),e.jsx(te,{variant:"contained",color:"success",onClick:()=>M("accept",n),children:"Accept"}),e.jsx(te,{variant:"contained",color:"error",onClick:()=>M("cancel",n),children:"Cancel"})]})})]},n.tenderId))})]})]}),e.jsxs(ye,{mt:4,children:[e.jsx(C,{variant:"h6",sx:{color:"#7267ef",mb:1},children:"PROJECT ALLOCATION REPORT"}),e.jsxs(Me,{component:De,sx:{border:"1px solid #7267ef"},children:[e.jsxs(Ie,{children:[e.jsx(Oe,{children:e.jsxs(q,{children:[e.jsx(l,{sx:{color:"#7267ef"},children:"Tender ID"}),e.jsx(l,{sx:{color:"#7267ef"},children:"Project ID"}),e.jsx(l,{sx:{color:"#7267ef"},children:"Govt Project ID"}),e.jsx(l,{sx:{color:"#7267ef"},children:"Job Allocation Date"}),e.jsx(l,{sx:{color:"#7267ef"},children:"Allocation State"}),e.jsx(l,{sx:{color:"#7267ef"},children:"Refund Date"}),e.jsx(l,{sx:{color:"#7267ef"},children:"Cancellation Note"}),e.jsx(l,{sx:{color:"#7267ef"},children:"Status"})]})}),e.jsx(Ae,{children:Z.length>0?Z.map(n=>e.jsxs(q,{children:[e.jsx(l,{children:n.tender}),e.jsx(l,{children:n.project_id||"-"}),e.jsx(l,{children:n.govt_project_id||"-"}),e.jsx(l,{children:n.job_allocation_date||"-"}),e.jsx(l,{children:n.allocation_state||"-"}),e.jsx(l,{children:n.security_money_refund_date||"-"}),e.jsx(l,{children:n.description||"-"}),e.jsx(l,{children:n.status==="Accept"?e.jsx(Ge,{color:"success"}):n.status==="Cancel"?e.jsx(rt,{color:"error"}):e.jsx(nt,{color:"disabled"})})]},n.id)):e.jsx(q,{children:e.jsx(l,{colSpan:8,align:"center",children:"No project records found."})})})]}),e.jsx(Qt,{rowsPerPageOptions:[5,10,25],component:"div",count:x.length,rowsPerPage:T,page:L,onPageChange:oe,onRowsPerPageChange:_})]})]}),e.jsxs(Qe,{open:j,onClose:P,maxWidth:"sm",fullWidth:!0,children:[e.jsxs(Ze,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c==="accept"?"Project Allocation Details":c==="cancel"?"Cancellation Details":"Tender Details",e.jsx(et,{onClick:P,children:e.jsx(He,{})})]}),e.jsxs(tt,{children:[c==="view"?e.jsxs(e.Fragment,{children:[e.jsxs(C,{children:[e.jsx("strong",{children:"Tender ID:"})," ",r==null?void 0:r.tender_id]}),e.jsxs(C,{children:[e.jsx("strong",{children:"Reference No:"})," ",r==null?void 0:r.tender_ref_no]}),e.jsxs(C,{children:[e.jsx("strong",{children:"Location:"})," ",r==null?void 0:r.location]}),e.jsxs(C,{children:[e.jsx("strong",{children:"Release Date:"})," ",r==null?void 0:r.release_date]}),e.jsxs(C,{children:[e.jsx("strong",{children:"Tender Value:"})," ₹",r==null?void 0:r.tender_value]}),e.jsx(C,{children:e.jsx("strong",{children:"EMD Details:"})}),e.jsxs("ul",{style:{margin:0,paddingLeft:"1.2rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Amount:"})," ₹",(Y=r==null?void 0:r.emd_details)==null?void 0:Y.amount]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Validity:"})," ",(ee=r==null?void 0:r.emd_details)==null?void 0:ee.validity]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Conditions:"})," ",(ae=r==null?void 0:r.emd_details)==null?void 0:ae.conditions]})]}),e.jsxs(C,{children:[e.jsx("strong",{children:"Authority:"})," ",r==null?void 0:r.authority]}),e.jsxs(C,{children:[e.jsx("strong",{children:"Contact:"})," ",r==null?void 0:r.contact]}),e.jsxs(C,{children:[e.jsx("strong",{children:"Authorized Personnel:"})," ",r==null?void 0:r.authorized_personnel]}),e.jsxs(C,{children:[e.jsx("strong",{children:"Start Date:"})," ",r==null?void 0:r.start_date]}),e.jsxs(C,{children:[e.jsx("strong",{children:"End Date:"})," ",r==null?void 0:r.end_date]}),e.jsxs(C,{children:[e.jsx("strong",{children:"Description:"})," ",r==null?void 0:r.tender_description]}),e.jsxs(C,{children:[e.jsx("strong",{children:"Status:"})," ",r==null?void 0:r.status]})]}):c==="accept"?e.jsx(e.Fragment,{children:e.jsxs(z,{container:!0,spacing:2,sx:{mt:1},children:[e.jsxs(z,{item:!0,xs:12,children:[e.jsx("label",{htmlFor:"jobAllocationDate",children:"Job Allocation Date"}),e.jsx("input",{type:"date",id:"jobAllocationDate",value:f.jobAllocationDate,onChange:N("jobAllocationDate"),onKeyDown:n=>ne(n,V),ref:E,className:"input"})]}),e.jsxs(z,{item:!0,xs:12,children:[e.jsx("label",{htmlFor:"govtProjectId",children:"Govt. Project ID"}),e.jsx("input",{type:"text",id:"govtProjectId",value:f.govtProjectId,onChange:N("govtProjectId"),onKeyDown:n=>ne(n,G),ref:V,className:"input"})]}),e.jsxs(z,{item:!0,xs:12,children:[e.jsx("label",{htmlFor:"allocationStatus",children:"Status"}),e.jsxs("select",{id:"allocationStatus",value:f.allocationStatus,onChange:N("allocationStatus"),ref:G,className:"input",children:[e.jsx("option",{value:"Allocated",children:"Allocated"}),e.jsx("option",{value:"Not Allocated",children:"Not Allocated"})]})]})]})}):e.jsxs(z,{container:!0,spacing:2,sx:{mt:1},children:[e.jsxs(z,{item:!0,xs:12,children:[e.jsx("label",{htmlFor:"refundDate",children:"Security Money Refund Date"}),e.jsx("input",{type:"date",id:"refundDate",value:f.refundDate,onChange:N("refundDate"),onKeyDown:n=>ne(n,y),ref:W,className:"input"})]}),e.jsxs(z,{item:!0,xs:12,children:[e.jsx("label",{htmlFor:"cancellationNote",children:"Cancellation Notes"}),e.jsx("textarea",{id:"cancellationNote",rows:3,value:f.cancellationNote,onChange:N("cancellationNote"),ref:y,className:"input"})]})]}),c!=="view"&&e.jsxs(z,{container:!0,justifyContent:"flex-end",spacing:2,sx:{mt:2},children:[e.jsx(z,{item:!0,children:e.jsx(te,{onClick:P,variant:"outlined",sx:{borderColor:"darkred",color:"darkred","&:hover":{borderColor:"darkred",backgroundColor:"rgba(139, 0, 0, 0.1)"}},children:"Close"})}),e.jsx(z,{item:!0,children:e.jsx(te,{onClick:X,variant:"outlined",sx:{borderColor:"#7267ef",color:"#7267ef","&:hover":{color:"#7267ef"}},children:"Submit"})})]})]})]}),e.jsxs(Qe,{open:H,onClose:ue,maxWidth:"md",fullWidth:!0,children:[e.jsxs(Ze,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:["System Audit Trail",e.jsx(et,{onClick:ue,children:e.jsx(He,{})})]}),e.jsx(tt,{children:e.jsx(Me,{component:De,sx:{mt:2},children:e.jsxs(Ie,{children:[e.jsx(Oe,{children:e.jsxs(q,{children:[e.jsx(l,{children:"Timestamp"}),e.jsx(l,{children:"Tender ID"}),e.jsx(l,{children:"Action"}),e.jsx(l,{children:"Details"}),e.jsx(l,{children:"User"})]})}),e.jsx(Ae,{children:g.length>0?[...g].reverse().map(n=>e.jsxs(q,{children:[e.jsx(l,{children:new Date(n.timestamp).toLocaleString()}),e.jsx(l,{children:n.tenderId}),e.jsx(l,{children:n.action}),e.jsx(l,{children:n.details&&Object.keys(n.details).length>0?e.jsx("ul",{style:{margin:0,paddingLeft:"20px"},children:Object.entries(n.details).map(([p,h])=>e.jsxs("li",{children:[e.jsxs("strong",{children:[p,":"]})," ",h]},p))}):"-"}),e.jsx(l,{children:n.user})]},n.id)):e.jsx(q,{children:e.jsx(l,{colSpan:5,align:"center",children:"No audit records found"})})})]})})})]})]})};export{$o as default};
