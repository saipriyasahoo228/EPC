import{r as u,j as e}from"./main-DTv03d8r.js";import{E as R}from"./jspdf.plugin.autotable-BtY0fsPl.js";import{C as A}from"./Close-BAEP8ymL.js";import{a as j}from"./api-Dv6wi5j0.js";import{q as g,D as $,r as F,I as L,t as B,H as U,T as G,v as H,w as J,x as w,y as n,z as Q}from"./TableRow-DyRCyY9b.js";import{G as l}from"./Grid-C5mdLuvI.js";import{D as Y}from"./DialogActions-CMm5oWDU.js";import{E as q,D as z}from"./Edit-DGVU-IuU.js";import{T as K}from"./TablePagination-C-yj9544.js";import"./auth-4s9nFscl.js";import"./Transition-ChWAEdMD.js";import"./KeyboardArrowRight-CpSviFou.js";const V=async c=>{var o;try{return(await j.post("/inventory/items/create/",c,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(i){throw console.error("❌ Error creating inventory item:",((o=i.response)==null?void 0:o.data)||i.message),i}},X=async()=>{var c;try{return(await j.get("/inventory/items/")).data}catch(o){throw console.error("❌ Error fetching inventory items:",((c=o.response)==null?void 0:c.data)||o.message),o}},Z=async(c,o)=>{var i;try{return(await j.patch(`/inventory/items/${c}/`,o,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(x){throw console.error("❌ Error updating inventory item:",((i=x.response)==null?void 0:i.data)||x.message),x}},ee=async c=>{var o;try{return(await j.delete(`/inventory/items/${c}/`)).data}catch(i){throw console.error("❌ Error deleting inventory item:",((o=i.response)==null?void 0:o.data)||i.message),i}},xe=()=>{const[c,o]=u.useState(""),[i,x]=u.useState(!1),[m,N]=u.useState(null),[C,_]=u.useState([]),[s,v]=u.useState({itemName:"",category:"",netWeight:"",unitOfMeasure:"",minStockLevel:"",maxStockLevel:"",reorderLevel:"",storageLocation:"",itemStatus:"Active"}),f=async()=>{try{const t=await X();_(t)}catch(t){console.error("❌ Error fetching items:",t)}};u.useEffect(()=>{f()},[]);const[y,b]=u.useState(0),[h,D]=u.useState(5),k=(t=null)=>{N(t),x(!0),v(t?{itemId:t.item_id||"",itemName:t.item_name||"",category:t.category||"",netWeight:t.net_weight||"",unitOfMeasure:t.unit_of_measure||"",minStockLevel:t.minimum_stock_level||"",maxStockLevel:t.maximum_stock_level||"",reorderLevel:t.reorder_level||"",storageLocation:t.storage_location||"",itemStatus:t.item_status||""}:{itemId:"",itemName:"",category:"",netWeight:"",unitOfMeasure:"",minStockLevel:"",maxStockLevel:"",reorderLevel:"",storageLocation:"",itemStatus:""})},p=()=>x(!1),d=t=>{const{name:r,value:a}=t.target;v(I=>({...I,[r]:a}))},M=()=>{const t=new Date().getFullYear(),r=C.length+1;return`ITM-${t}-${String(r).padStart(3,"0")}`},E=async()=>{if(!(Number(s.minStockLevel)<Number(s.reorderLevel)&&Number(s.reorderLevel)<Number(s.maxStockLevel))){alert(`⚠️ Validation Error:
Ensure that: Minimum Stock Level < Reorder Level < Maximum Stock Level`);return}const t=new FormData;t.append("item_name",s.itemName),t.append("category",s.category),t.append("net_weight",s.netWeight||0),t.append("unit_of_measure",s.unitOfMeasure),t.append("minimum_stock_level",s.minStockLevel||0),t.append("maximum_stock_level",s.maxStockLevel||0),t.append("reorder_level",s.reorderLevel||0),t.append("storage_location",s.storageLocation),t.append("item_status",s.itemStatus);try{let r;m&&m.item_id?(r=await Z(m.item_id,t),alert(`✅ Item ${m.item_id} updated successfully!`),await f()):(r=await V(t),alert(`✅ Item Created Successfully!
Item ID: ${r.item_id||"N/A"}`),await f()),p()}catch(r){if(console.error("❌ Error:",r),r.response&&r.response.data){let a=typeof r.response.data=="string"?r.response.data:JSON.stringify(r.response.data);alert(`⚠️ Failed to save item:
${a}`)}else alert("⚠️ Failed to save item. Please try again.")}},P=async t=>{if(window.confirm(`Are you sure you want to delete item ${t}?`))try{const r=await ee(t);alert(`✅ Item ${t} deleted successfully!`),_(a=>a.filter(I=>I.item_id!==t))}catch(r){console.error("❌ Error deleting item:",r),r.response&&r.response.data?alert(`⚠️ Failed to delete item:
${JSON.stringify(r.response.data)}`):alert("⚠️ Failed to delete item. Please try again.")}},S=C.filter(t=>Object.values(t).some(r=>r&&r.toString().toLowerCase().includes(c.toLowerCase()))),T=(t,r)=>{b(r)},O=t=>{D(parseInt(t.target.value,10)),b(0)},W=()=>{const t=new R,r=S.map(a=>[a.itemId,a.itemName,a.category,a.netWeight,a.unitOfMeasure,a.minStockLevel,a.maxStockLevel,a.reorderLevel,a.storageLocation,a.itemStatus]);t.autoTable({head:[["Item ID","Name","Category","Net Weight","Unit","Min Stock","Max Stock","Reorder Level","Storage Location","Status"]],body:r}),t.save("inventory_report.pdf")};return e.jsxs("div",{children:[e.jsx(g,{variant:"contained",sx:{mt:4,mb:2,backgroundColor:"#7267ef"},onClick:()=>k(),children:"Add Item"}),e.jsxs($,{open:i,onClose:p,maxWidth:"sm",fullWidth:!0,children:[e.jsxs(F,{sx:{backgroundColor:"#f3f3f3",color:"#7267ef",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[m?"Edit Inventory Item":"Add Inventory Item",e.jsx(L,{onClick:p,sx:{color:"#7267ef"},children:e.jsx(A,{})})]}),e.jsx(B,{children:e.jsxs(l,{container:!0,spacing:2,direction:"column",sx:{mt:1},children:[e.jsxs(l,{item:!0,xs:12,children:[e.jsx("label",{children:"Item ID"}),e.jsx("input",{className:"input",disabled:!0,value:m?m.item_id:M()})]}),e.jsxs(l,{item:!0,xs:12,children:[e.jsx("label",{children:"Item Name"}),e.jsx("input",{className:"input",name:"itemName",value:s.itemName,onChange:d,placeholder:"e.g., Steel Rods"})]}),e.jsxs(l,{item:!0,xs:12,children:[e.jsx("label",{children:"Category"}),e.jsx("input",{className:"input",name:"category",value:s.category,onChange:d,placeholder:"e.g., Raw Materials"})]}),e.jsxs(l,{item:!0,xs:12,children:[e.jsx("label",{children:"Net Weight"}),e.jsx("input",{className:"input",name:"netWeight",value:s.netWeight,onChange:d,placeholder:"e.g., 70"})]}),e.jsxs(l,{item:!0,xs:12,children:[e.jsx("label",{children:"Unit of Measure"}),e.jsx("input",{className:"input",name:"unitOfMeasure",value:s.unitOfMeasure,onChange:d,placeholder:"e.g., KG"})]}),e.jsxs(l,{item:!0,xs:12,children:[e.jsx("label",{children:"Minimum Stock Level"}),e.jsx("input",{className:"input",name:"minStockLevel",type:"number",value:s.minStockLevel,onChange:d})]}),e.jsxs(l,{item:!0,xs:12,children:[e.jsx("label",{children:"Maximum Stock Level"}),e.jsx("input",{className:"input",name:"maxStockLevel",type:"number",value:s.maxStockLevel,onChange:d})]}),e.jsxs(l,{item:!0,xs:12,children:[e.jsx("label",{children:"Reorder Level"}),e.jsx("input",{className:"input",name:"reorderLevel",type:"number",value:s.reorderLevel,onChange:d})]}),e.jsxs(l,{item:!0,xs:12,children:[e.jsx("label",{children:"Storage Location"}),e.jsx("input",{className:"input",name:"storageLocation",value:s.storageLocation,onChange:d,placeholder:"e.g., Warehouse A"})]}),e.jsxs(l,{item:!0,xs:12,children:[e.jsx("label",{children:"Item Status"}),e.jsxs("select",{className:"input",name:"itemStatus",value:s.itemStatus,onChange:d,children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"}),e.jsx("option",{value:"Discontinued",children:"Discontinued"})]})]})]})}),e.jsxs(Y,{sx:{pr:3,pb:2},children:[e.jsx(g,{onClick:p,sx:{outline:"2px solid #800000",color:"#800000"},children:"Cancel"}),e.jsx(g,{variant:"outlined",onClick:E,sx:{borderColor:"#7267ef",color:"#7267ef"},children:m?"Update":"Submit"})]})]}),e.jsxs(U,{sx:{mt:4,p:2,border:"1px solid #ccc"},children:[e.jsxs(l,{container:!0,justifyContent:"space-between",alignItems:"center",children:[e.jsx(l,{item:!0,children:e.jsx(G,{variant:"h6",gutterBottom:!0,sx:{color:"#7267ef"},children:"Inventory Items Report"})}),e.jsx(l,{item:!0,children:e.jsx(g,{onClick:W,sx:{backgroundColor:"#7267ef",color:"#fff",mt:2,mb:2},children:"Export PDF"})})]}),e.jsx("input",{type:"text",placeholder:"Search Item Details Here....",value:c,onChange:t=>o(t.target.value),className:"input"}),e.jsxs(H,{children:[e.jsx(J,{children:e.jsxs(w,{children:[e.jsx(n,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Item ID"})}),e.jsx(n,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Name"})}),e.jsx(n,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Category"})}),e.jsx(n,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Net Weight"})}),e.jsx(n,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Unit"})}),e.jsx(n,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Min"})}),e.jsx(n,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Max"})}),e.jsx(n,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Reorder"})}),e.jsx(n,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Location"})}),e.jsx(n,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Status"})}),e.jsx(n,{sx:{color:"#660000"},children:e.jsx("strong",{children:"Actions"})})]})}),e.jsx(Q,{children:S.slice(y*h,y*h+h).map((t,r)=>e.jsxs(w,{children:[e.jsx(n,{children:t.item_id}),e.jsx(n,{children:t.item_name}),e.jsx(n,{children:t.category}),e.jsx(n,{children:t.net_weight}),e.jsx(n,{children:t.unit_of_measure}),e.jsx(n,{children:t.minimum_stock_level}),e.jsx(n,{children:t.maximum_stock_level}),e.jsx(n,{children:t.reorder_level}),e.jsx(n,{children:t.storage_location}),e.jsx(n,{children:t.item_status}),e.jsxs(n,{children:[e.jsx(L,{color:"warning",onClick:()=>k(t),children:e.jsx(q,{sx:{color:"orange"}})}),e.jsx(L,{color:"error",onClick:()=>P(t.item_id),children:e.jsx(z,{sx:{color:"red"}})})]})]},r))})]}),e.jsx(K,{rowsPerPageOptions:[5,10,25],component:"div",count:S.length,rowsPerPage:h,page:y,onPageChange:T,onRowsPerPageChange:O})]})]})};export{xe as default};
