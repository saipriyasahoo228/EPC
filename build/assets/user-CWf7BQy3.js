import{r as l,j as e}from"./main-DTv03d8r.js";import{C as O}from"./Close-BAEP8ymL.js";import{C as y}from"./CheckCircle-BHtT40I4.js";import{E as Y}from"./jspdf.plugin.autotable-BtY0fsPl.js";import{q as p,D as M,r as G,I as w,t as H,H as L,T as Q,v as W,w as $,x as R,y as o,z as q}from"./TableRow-DyRCyY9b.js";import{G as t}from"./Grid-C5mdLuvI.js";import{D as z}from"./DialogActions-CMm5oWDU.js";import{E as _,D as J}from"./Edit-DGVU-IuU.js";import{T as K}from"./TablePagination-C-yj9544.js";import"./Transition-ChWAEdMD.js";import"./KeyboardArrowRight-CpSviFou.js";const ie=()=>{const[S,C]=l.useState(!1),[i,b]=l.useState(null),[c,u]=l.useState([]),[P,E]=l.useState(""),[n,x]=l.useState({name:"",username:"",password:"",confirmPassword:"",role:""}),[j,v]=l.useState(0),[m,k]=l.useState(5),I=(s=null)=>{b(s),C(!0),x(s?{name:s.name,username:s.username,password:s.password,confirmPassword:s.password,role:s.role}:{name:"",username:"",password:"",confirmPassword:"",role:""})},h=()=>C(!1),d=s=>{const{name:r,value:a}=s.target;x(f=>({...f,[r]:a}))},U=()=>{const s=new Date().getFullYear(),r=c.length+1;return`USR-${s}-${String(r).padStart(3,"0")}`},T=()=>{if(n.password!==n.confirmPassword){alert("Passwords do not match!");return}if(i){const s=c.map(r=>r.userId===i.userId?{...r,...n}:r);u(s)}else{const s={userId:U(),...n};u([...c,s])}x({name:"",username:"",password:"",confirmPassword:"",role:""}),b(null),h()},N=s=>{if(window.confirm("Are you sure you want to delete this user?")){const a=c.filter(f=>f.userId!==s);u(a)}},g=c.filter(s=>Object.values(s).some(r=>r&&r.toString().toLowerCase().includes(P.toLowerCase()))),A=(s,r)=>{v(r)},B=s=>{k(parseInt(s.target.value,10)),v(0)},F=()=>{const s=new Y,r=g.map(a=>[a.userId,a.name,a.username,a.role]);s.autoTable({head:[["User ID","Name","Username","Role"]],body:r}),s.save("user_roles.pdf")},D=n.password&&n.confirmPassword&&n.password===n.confirmPassword;return e.jsxs("div",{children:[e.jsx(p,{variant:"contained",sx:{mt:4,mb:2,backgroundColor:"#7267ef"},onClick:()=>I(),children:"Add User Role"}),e.jsxs(M,{open:S,onClose:h,maxWidth:"sm",fullWidth:!0,children:[e.jsxs(G,{sx:{backgroundColor:"#f3f3f3",color:"#7267ef",display:"flex",justifyContent:"space-between"},children:[i?"Edit User Role":"Add User Role",e.jsx(w,{onClick:h,sx:{color:"#7267ef"},children:e.jsx(O,{})})]}),e.jsx(H,{children:e.jsxs(t,{container:!0,spacing:2,direction:"column",sx:{mt:1},children:[e.jsxs(t,{item:!0,xs:12,children:[e.jsx("label",{children:"User ID (Auto)"}),e.jsx("input",{className:"input",disabled:!0,value:i?i.userId:U()})]}),e.jsxs(t,{item:!0,xs:12,children:[e.jsx("label",{children:"Name"}),e.jsx("input",{className:"input",name:"name",value:n.name,onChange:d})]}),e.jsxs(t,{item:!0,xs:12,children:[e.jsx("label",{children:"Username"}),e.jsx("input",{className:"input",name:"username",value:n.username,onChange:d})]}),e.jsxs(t,{item:!0,xs:12,children:[e.jsx("label",{children:"Password"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{className:"input",type:"password",name:"password",value:n.password,onChange:d,placeholder:"Enter password",style:{paddingRight:"30px"}}),D&&e.jsx(y,{sx:{color:"green",position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",pointerEvents:"none"}})]})]}),e.jsxs(t,{item:!0,xs:12,children:[e.jsx("label",{children:"Confirm Password"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{className:"input",type:"password",name:"confirmPassword",value:n.confirmPassword,onChange:d,placeholder:"Re-enter password",style:{paddingRight:"30px"}}),D&&e.jsx(y,{sx:{color:"green",position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",pointerEvents:"none"}})]})]}),e.jsxs(t,{item:!0,xs:12,children:[e.jsx("label",{children:"Role"}),e.jsxs("select",{className:"input",name:"role",value:n.role,onChange:d,children:[e.jsx("option",{value:"",children:"Select Role"}),e.jsx("option",{value:"Admin",children:"Admin"}),e.jsx("option",{value:"User",children:"User"}),e.jsx("option",{value:"Manager",children:"Manager"})]})]})]})}),e.jsxs(z,{sx:{pr:3,pb:2},children:[e.jsx(p,{onClick:h,sx:{outline:"2px solid #800000",color:"#800000"},children:"Cancel"}),e.jsx(p,{variant:"outlined",onClick:T,sx:{borderColor:"#7267ef",color:"#7267ef"},children:"Submit"})]})]}),e.jsxs(L,{sx:{mt:4,p:2,border:"1px solid #ccc"},children:[e.jsxs(t,{container:!0,justifyContent:"space-between",alignItems:"center",children:[e.jsx(t,{item:!0,children:e.jsx(Q,{variant:"h6",gutterBottom:!0,sx:{color:"#7267ef"},children:"User Roles Report"})}),e.jsx(t,{item:!0,children:e.jsx(p,{onClick:F,sx:{backgroundColor:"#7267ef",color:"#fff",mt:2,mb:2},children:"Export PDF"})})]}),e.jsx("input",{type:"text",placeholder:"Search Users...",value:P,onChange:s=>E(s.target.value),className:"input"}),e.jsxs(W,{children:[e.jsx($,{children:e.jsxs(R,{children:[e.jsx(o,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"User ID"})}),e.jsx(o,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Name"})}),e.jsx(o,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Username"})}),e.jsx(o,{sx:{color:"#7267ef"},children:e.jsx("strong",{children:"Role"})}),e.jsx(o,{sx:{color:"#660000"},children:e.jsx("strong",{children:"Actions"})})]})}),e.jsx(q,{children:g.slice(j*m,j*m+m).map((s,r)=>e.jsxs(R,{children:[e.jsx(o,{children:s.userId}),e.jsx(o,{children:s.name}),e.jsx(o,{children:s.username}),e.jsx(o,{children:s.role}),e.jsxs(o,{children:[e.jsx(w,{color:"warning",onClick:()=>I(s),children:e.jsx(_,{sx:{color:"orange"}})}),e.jsx(w,{color:"error",onClick:()=>N(s.userId),children:e.jsx(J,{sx:{color:"red"}})})]})]},r))})]}),e.jsx(K,{rowsPerPageOptions:[5,10,25],component:"div",count:g.length,rowsPerPage:m,page:j,onPageChange:A,onRowsPerPageChange:B})]})]})};export{ie as default};
